/*
nvcc -arch=sm_61 -rdc=true -cudart static --machine 64 -use_fast_math -O1 KNTT.cu -o kntt -lcudadevrt -std=c++11
nvprof ./kntt
*/

#include <stdio.h>
#include <stdlib.h>
#include<stdint.h>
#include <time.h>

#define K 10000


// KNTTiy利用以下函数得出
/*
	uint64_t root[N / 2];
	for (int i = 0; i < N /2; i++)
		root[i] = 0;
	root[1] = 1;
	poly_ntt(root, N / 2);
	for (int i = 0; i < N / 2; i++)
		printf("%d, ", root[i]);
	printf("#############\n");

	uint64_t root1[N / 4];
	for (int i = 0; i < N / 4; i++)
		root1[i] = 0;
	root1[1] = 1;
	poly_ntt(root1, N / 4);
	for (int i = 0; i < N / 4; i++)
		printf("%d, ", root1[i]);
	for (int i = 0; i < N / 4; i++)
		printf("%d, ", root1[i]);
	printf("#############\n");

	uint64_t root2[N / 8];
	for (int i = 0; i < N / 8; i++)
		root2[i] = 0;
	root2[1] = 1;
	poly_ntt(root2, N / 8);
	for (int i = 0; i < N / 8; i++)
		printf("%d, ", root2[i]);
	printf("#############\n");
*/



//  以下是N=1024的参数，测试 NTT 1KNTT 2KNTT 3KNTT 的运行时间，可以使用Hpol_naivemul进行比对，测试正确性。
#define N 1024
#define Q 12289
#define INV_N0  12277// 1024的逆
#define INV_N1  12265// 512的逆
#define INV_N2  12241// 256的逆
#define INV_N3  12193// 128的逆
#define N1 N/2
#define N2 N/4
#define N3 N/8

// 2n次本原根为7
// 7 ^（2 * N） = 1 mod Q
// phi[i] = 7 ^(bitrev[i]) mod Q
__device__ const uint64_t Dphi[N] = { 1,10810,7143,4043,10984,722,5736,8155,3542,8785,9744,3621,10643,1212,3195,5860,7468,2639,9664,11340,11726,9314,9283,9545,5728,7698,5023,5828,8961,6512,7311,1351,2319,11119,11334,11499,9088,3014,5086,10963,4846,9542,9154,3712,4805,8736,11227,9995,3091,12208,7969,11289,9326,7393,9238,2366,11112,8034,10654,9521,12149,10436,7678,11563,1260,4388,4632,6534,2426,334,1428,1696,2013,9000,729,3241,2881,3284,7197,10200,8595,7110,10530,8582,3382,11934,9741,8058,3637,3459,145,6747,9558,8357,7399,6378,9447,480,1022,9,9821,339,5791,544,10616,4278,6958,7300,8112,8705,1381,9764,11336,8541,827,5767,2476,118,2197,7222,3949,8993,4452,2396,7935,130,2837,6915,2401,442,7188,11222,390,773,8456,3778,354,4861,9377,5698,5012,9808,2859,11244,1017,7404,1632,7205,27,9223,8526,10849,1537,242,4714,8146,9611,3704,5019,11744,1002,5011,5088,8005,7313,10682,8509,11414,9852,3646,6022,2987,9723,10102,6250,9867,11224,2143,11885,7644,1168,5277,11082,3248,493,8193,6845,2381,7952,11854,1378,1912,2166,3915,12176,7370,12129,3149,12286,4437,3636,4938,5291,2704,10863,7635,1663,10512,3364,1689,4057,9018,9442,7875,2174,4372,7247,9984,4053,2645,5195,9509,7394,1484,9042,9603,8311,9320,9919,2865,5332,3510,1630,10163,5407,3186,11136,9405,10040,8241,9890,8889,7098,9153,9289,671,3016,243,6730,420,10111,1544,3985,4905,3531,476,49,1263,5915,1483,9789,10800,10706,6347,1512,350,10474,5383,5369,10232,9087,4493,9551,6421,6554,2655,9280,1693,174,723,10314,8532,347,2925,8974,11863,1858,4754,3030,4115,2361,10446,2908,218,3434,8760,3963,576,6142,9842,1954,10238,9407,10484,3991,8320,9522,156,2281,5876,10258,5333,3772,418,5908,11836,5429,7515,7552,1293,295,6099,5766,652,8273,4077,8527,9370,325,10885,11143,11341,5990,1159,8561,8240,3329,4298,12121,2692,5961,7183,10327,1594,6167,9734,7105,11089,1360,3956,6170,5297,8210,11231,922,441,1958,4322,1112,2078,4046,709,9139,1319,4240,8719,6224,11454,2459,683,3656,12225,10723,5782,9341,9786,9166,10542,9235,6803,7856,6370,3834,7032,7048,9369,8120,9162,6821,1010,8807,787,5057,4698,4780,8844,12097,1321,4912,10240,677,6415,6234,8953,1323,9523,12237,3174,1579,11858,9784,5906,3957,9450,151,10162,12231,12048,3532,11286,1956,7280,11404,6281,3477,6608,142,11184,9445,3438,11314,4212,9260,6695,4782,5886,8076,504,2302,11684,11868,8209,3602,6068,8689,3263,6077,7665,7822,7500,6752,4749,4449,6833,12142,8500,6118,8471,1190,9606,3860,5445,7753,11239,5079,9027,2169,11767,7965,4916,8214,5315,11011,9945,1973,6715,8775,11248,5925,11271,654,3565,1702,1987,6760,5206,3199,12233,6136,6427,6874,8646,4948,6152,400,10561,5339,5446,3710,6093,468,8301,316,11907,10256,8291,3879,1922,10930,6854,973,11035,7,1936,845,3723,3154,5054,3285,7929,216,50,6763,769,767,8484,10076,4153,3120,6184,6203,5646,8348,3753,3536,5370,3229,4730,10583,3929,1282,8717,2021,9457,3944,4099,5604,6759,2171,8809,11024,3007,9344,5349,2633,1406,9057,11996,4855,8520,9348,11722,6627,5289,3837,2595,3221,4273,4050,7082,844,5202,11309,11607,4590,7207,8820,6138,7846,8871,4693,2338,9996,11872,1802,1555,5103,10398,7878,10699,1223,9955,11009,614,12265,10918,11385,9804,6742,7250,881,11924,1015,10362,5461,9343,2637,7779,4684,3360,7154,63,7302,2373,3670,3808,578,5368,11839,1944,7628,11779,9667,6903,5618,10631,5789,3502,5043,826,3090,1398,3065,1506,6586,4483,6389,910,7570,11538,4518,3094,1160,4820,2730,5411,10036,1868,2478,9449,4194,3019,10506,7211,7724,4974,7119,2672,11424,1279,189,3116,10526,2209,10759,1694,8420,7866,5832,1350,10555,8474,7014,10499,11038,6879,2035,1040,10407,6164,7519,944,5287,8620,6616,9269,6883,7624,4834,2712,9461,4352,8176,72,3840,10447,3451,8195,11048,4378,6508,9244,9646,1095,2873,2827,11498,2434,11169,9754,12268,6481,874,9988,170,6639,2307,4289,11641,12139,11259,11823,3821,1681,4649,5969,2929,6026,1573,8443,3793,6226,11787,5118,2602,10388,1849,5776,9021,3795,7988,7766,457,12281,11410,9696,982,10013,4218,4390,8835,8531,7785,778,530,2626,3578,4697,8823,1701,10243,2940,9332,10808,3317,9757,139,3332,343,8841,4538,10381,7078,1866,1208,7562,10584,2450,11873,814,716,10179,2164,6873,5412,8080,9011,6296,3515,11851,1218,5061,10753,10568,2429,8186,1373,9307,717,8700,8921,4227,4238,11677,8067,1526,11749,12164,3163,4032,6127,7449,1389,10221,4404,11943,3359,9084,5209,1092,3678,4265,10361,464,1826,2926,4489,9118,1136,3449,3708,9051,2065,5826,3495,4564,8755,3961,10533,4145,2275,2461,4267,5653,5063,8113,10771,8524,11014,5508,11113,6555,4860,1125,10844,11158,6302,6693,579,3889,9520,3114,6323,212,8314,4883,6454,3087,1417,5676,7784,2257,3744,4963,2528,9233,5102,11877,6701,6444,4924,4781,1014,11841,1327,3607,3942,7057,2717,60,3200,10754,5836,7723,2260,68,180,4138,7684,2689,10880,7070,204,5509,10821,8308,8882,463,10945,9247,9806,10235,4739,8038,6771,1226,9261,5216,11925,9929,11053,9272,7043,4475,3121,4705,1057,9689,11883,10602,146,5268,1403,1804,6094,7100,12050,9389,994,4554,4670,11777,5464,4906,3375,9998,8896,4335,7376,3528,3825,8054,9342,8307,636,5609,11667,10552,5672,4499,5598,3344,10397,8665,6565,10964,11260,10344,5959,10141,8330,5797,2442,1248,5115,4939,10975,1744,2894,8635,6599,9834,8342,338,3343,8170,1522,10138,12269,5002,4608,5163,4578,377,11914,1620,10453,11864,10104,11897,6085,8122,11251,11366,10058,6197,2800,193,506,1255,1392,5784,3276,8951,2212,9615,10347,8881,2575,1165,2776,11111,6811,3511};

// 7^(-1) = 8778 invphi[i]=8778^(bitrev[i]) mod Q
__device__ const uint64_t Dinvphi[N] = {1,1479,8246,5146,4134,6553,11567,1305,6429,9094,11077,1646,8668,2545,3504,8747,10938,4978,5777,3328,6461,7266,4591,6561,2744,3006,2975,563,949,2625,9650,4821,726,4611,1853,140,2768,1635,4255,1177,9923,3051,4896,2963,1000,4320,81,9198,2294,1062,3553,7484,8577,3135,2747,7443,1326,7203,9275,3201,790,955,1170,9970,5374,9452,12159,4354,9893,7837,3296,8340,5067,10092,12171,9813,6522,11462,3748,953,2525,10908,3584,4177,4989,5331,8011,1673,11745,6498,11950,2468,12280,11267,11809,2842,5911,4890,3932,2731,5542,12144,8830,8652,4231,2548,355,8907,3707,1759,5179,3694,2089,5092,9005,9408,9048,11560,3289,10276,10593,10861,11955,9863,5755,7657,7901,11029,11813,8758,7384,8304,10745,2178,11869,5559,12046,9273,11618,3000,3136,5191,3400,2399,4048,2249,2884,1153,9103,6882,2126,10659,8779,6957,9424,2370,2969,3978,2686,3247,10805,4895,2780,7094,9644,8236,2305,5042,7917,10115,4414,2847,3271,8232,10600,8925,1777,10626,4654,1426,9585,6998,7351,8653,7852,3,9140,160,4919,113,8374,10123,10377,10911,435,4337,9908,5444,4096,11796,9041,1207,7012,11121,4645,404,10146,1065,2422,6039,2187,2566,9302,6267,8643,2437,875,3780,1607,4976,4284,7201,7278,11287,545,7270,8585,2678,4143,7575,12047,10752,1440,3763,3066,12262,5084,10657,4885,11272,1045,9430,2481,7277,6591,2912,7428,11935,8511,3833,11516,11899,1067,5101,11847,9888,1254,11316,5435,1359,10367,8410,3998,2033,382,11973,3988,11821,6196,8579,6843,6950,1728,11889,6137,7341,3643,5415,5862,6153,56,9090,7083,5529,10302,10587,8724,11635,1018,6364,1041,3514,5574,10316,2344,1278,6974,4075,7373,4324,522,10120,3262,7210,1050,4536,6844,8429,2683,11099,3818,6171,3789,147,5456,7840,7540,5537,4789,4467,4624,6212,9026,3600,6221,8687,4080,421,605,9987,11785,4213,6403,7507,5594,3029,8077,975,8851,2844,1105,12147,5681,8812,6008,885,5009,10333,1003,8757,241,58,2127,12138,2839,8332,6383,2505,431,10710,9115,52,2766,10966,3336,6055,5874,11612,2049,7377,10968,192,3445,7509,7591,7232,11502,3482,11279,5468,3127,4169,2920,5241,5257,8455,5919,4433,5486,3054,1747,3123,2503,2948,6507,1566,64,8633,11606,9830,835,6065,3570,8049,10970,3150,11580,8243,10211,11177,7967,10331,11848,11367,1058,4079,6992,6119,8333,10929,1200,5184,2555,6122,10695,1962,5106,6328,9597,168,7991,8960,4049,3728,11130,6299,948,1146,1404,11964,2919,3762,8212,4016,11637,6523,6190,11994,10996,4737,4774,6860,453,6381,11871,8517,6956,2031,6413,10008,12133,2767,3969,8298,1805,2882,2051,10335,2447,6147,11713,8326,3529,8855,12071,9381,1843,9928,8174,9259,7535,10431,426,3315,9364,11942,3757,1975,11566,12115,10596,3009,9634,5735,5868,2738,7796,3202,2057,6920,6906,1815,11939,10777,5942,1583,1489,2500,10806,6374,11026,12240,8778,5478,1178,9513,11124,9714,3408,1942,2674,10077,3338,9013,6505,10897,11034,11783,12096,9489,6092,2231,923,1038,4167,6204,392,2185,425,1836,10669,375,11912,7711,7126,7681,7287,20,2151,10767,4119,8946,11951,3947,2455,5690,3654,9395,10545,1314,7350,7174,11041,9847,6492,3959,2148,6330,1945,1029,1325,5724,3624,1892,8945,6691,7790,6617,1737,622,6680,11653,3982,2947,4235,8464,8761,4913,7954,3393,2291,8914,7383,6825,512,7619,7735,11295,2900,239,5189,6195,10485,10886,7021,12143,1687,406,2600,11232,7584,9168,7814,5246,3017,1236,2360,364,7073,3028,11063,5518,4251,7550,2054,2483,3042,1344,11826,3407,3981,1468,6780,12085,5219,1409,9600,4605,8151,12109,12221,10029,4566,6453,1535,9089,12229,9572,5232,8347,8682,10962,448,11275,7508,7365,5845,5588,412,7187,3056,9761,7326,8545,10032,4505,6613,10872,9202,5835,7406,3975,12077,5966,9175,2769,8400,11710,5596,5987,1131,1445,11164,7429,5734,1176,6781,1275,3765,1518,4176,7226,6636,8022,9828,10014,8144,1756,8328,3534,7725,8794,6463,10224,3238,8581,8840,11153,3171,7800,9363,10463,11825,1928,8024,8611,11197,7080,3205,8930,346,7885,2068,10900,4840,6162,8257,9126,125,540,10763,4222,612,8051,8062,3368,3589,11572,2982,10916,4103,9860,1721,1536,7228,11071,438,8774,5993,3278,4209,6877,5416,10125,2110,11573,11475,416,9839,1705,4727,11081,10423,5211,1908,7751,3448,11946,8957,12150,2532,8972,1481,2957,9349,2046,10588,3466,7592,8711,9663,11759,11511,4504,3758,3454,7899,8071,2276,11307,2593,879,8,11832,4523,4301,8494,3268,6513,10440,1901,9687,7171,502,6063,8496,3846,10716,6263,9360,6320,7640,10608,8468,466,1030,150,648,8000,9982,5650,12119,2301,11415,5808,21,2535,1120,9855,791,9462,9416,11194,2643,3045,5781,7911,1241,4094,8838,1842,8449,12217,4113,7937,2828,9577,7455,4665,5406,3020,5673,3669,7002,11345,4770,6125,1882,11249,10254,5410,1251,1790,5275,3815,1734,10939,6457,4423,3869,10595,1530,10080,1763,9173,12100,11010,865,9617,5170,7315,4565,5078,1783,9270,8095,2840,9811,10421,2253,6878,9559,7469,11129,9195,7771,751,4719,11379,5900,7806,5703,10783,9224,10891,9199,11463,7246,8787,6500,1658,6671,5386,2622,510,4661,10345,450,6921,11711,8481,8619,9916,4987,12226,5135,8929,7605,4510,9652,2946,6828,1927,11274,365,11408,5039,5547,2485,904,1371,24,11675,1280,2334,11066,1590,4411,1891,7186,10734,10487,417,2293,9951,7596,3418,4443,6151,3469,5082,7699,682,980,7087,11445,5207,8239,8016,9068,9694,8452,7000,5662,567,2941,3769,7434,293,3232,10883,9656,6940,2945,9282,1265,3480,10118,5530,6685,8190,8345,2832,10268,3572,11007,8360,1706,7559,9060,6919,8753,8536,3941,6643,6086,6105,9169,8136,2213,3805,11522,11520,5526,12239,12073,4360,9004,7235,9135,8566,11444,10353,12282};

__device__ const  uint64_t KNTT1y[N/2] = {49, 12240, 1263, 11026, 5915, 6374, 1483, 10806, 9789, 2500, 10800, 1489, 10706, 1583, 6347, 5942, 1512, 10777, 350, 11939, 10474, 1815, 5383, 6906, 5369, 6920, 10232, 2057, 9087, 3202, 4493, 7796, 9551, 2738, 6421, 5868, 6554, 5735, 2655, 9634, 9280, 3009, 1693, 10596, 174, 12115, 723, 11566, 10314, 1975, 8532, 3757, 347, 11942, 2925, 9364, 8974, 3315, 11863, 426, 1858, 10431, 4754, 7535, 3030, 9259, 4115, 8174, 2361, 9928, 10446, 1843, 2908, 9381, 218, 12071, 3434, 8855, 8760, 3529, 3963, 8326, 576, 11713, 6142, 6147, 9842, 2447, 1954, 10335, 10238, 2051, 9407, 2882, 10484, 1805, 3991, 8298, 8320, 3969, 9522, 2767, 156, 12133, 2281, 10008, 5876, 6413, 10258, 2031, 5333, 6956, 3772, 8517, 418, 11871, 5908, 6381, 11836, 453, 5429, 6860, 7515, 4774, 7552, 4737, 1293, 10996, 295, 11994, 6099, 6190, 5766, 6523, 652, 11637, 8273, 4016, 4077, 8212, 8527, 3762, 9370, 2919, 325, 11964, 10885, 1404, 11143, 1146, 11341, 948, 5990, 6299, 1159, 11130, 8561, 3728, 8240, 4049, 3329, 8960, 4298, 7991, 12121, 168, 2692, 9597, 5961, 6328, 7183, 5106, 10327, 1962, 1594, 10695, 6167, 6122, 9734, 2555, 7105, 5184, 11089, 1200, 1360, 10929, 3956, 8333, 6170, 6119, 5297, 6992, 8210, 4079, 11231, 1058, 922, 11367, 441, 11848, 1958, 10331, 4322, 7967, 1112, 11177, 2078, 10211, 4046, 8243, 709, 11580, 9139, 3150, 1319, 10970, 4240, 8049, 8719, 3570, 6224, 6065, 11454, 835, 2459, 9830, 683, 11606, 3656, 8633, 12225, 64, 10723, 1566, 5782, 6507, 9341, 2948, 9786, 2503, 9166, 3123, 10542, 1747, 9235, 3054, 6803, 5486, 7856, 4433, 6370, 5919, 3834, 8455, 7032, 5257, 7048, 5241, 9369, 2920, 8120, 4169, 9162, 3127, 6821, 5468, 1010, 11279, 8807, 3482, 787, 11502, 5057, 7232, 4698, 7591, 4780, 7509, 8844, 3445, 12097, 192, 1321, 10968, 4912, 7377, 10240, 2049, 677, 11612, 6415, 5874, 6234, 6055, 8953, 3336, 1323, 10966, 9523, 2766, 12237, 52, 3174, 9115, 1579, 10710, 11858, 431, 9784, 2505, 5906, 6383, 3957, 8332, 9450, 2839, 151, 12138, 10162, 2127, 12231, 58, 12048, 241, 3532, 8757, 11286, 1003, 1956, 10333, 7280, 5009, 11404, 885, 6281, 6008, 3477, 8812, 6608, 5681, 142, 12147, 11184, 1105, 9445, 2844, 3438, 8851, 11314, 975, 4212, 8077, 9260, 3029, 6695, 5594, 4782, 7507, 5886, 6403, 8076, 4213, 504, 11785, 2302, 9987, 11684, 605, 11868, 421, 8209, 4080, 3602, 8687, 6068, 6221, 8689, 3600, 3263, 9026, 6077, 6212, 7665, 4624, 7822, 4467, 7500, 4789, 6752, 5537, 4749, 7540, 4449, 7840, 6833, 5456, 12142, 147, 8500, 3789, 6118, 6171, 8471, 3818, 1190, 11099, 9606, 2683, 3860, 8429, 5445, 6844, 7753, 4536, 11239, 1050, 5079, 7210, 9027, 3262, 2169, 10120, 11767, 522, 7965, 4324, 4916, 7373, 8214, 4075, 5315, 6974, 11011, 1278, 9945, 2344, 1973, 10316, 6715, 5574, 8775, 3514, 11248, 1041, 5925, 6364, 11271, 1018, 654, 11635, 3565, 8724, 1702, 10587, 1987, 10302, 6760, 5529, 5206, 7083, 3199, 9090, 12233, 56, 6136, 6153, 6427, 5862, 6874, 5415, 8646, 3643, 4948, 7341, 6152, 6137, 400, 11889, 10561, 1728, 5339, 6950, 5446, 6843, 3710, 8579, 6093, 6196, 468, 11821, 8301, 3988, 316, 11973, 11907, 382, 10256, 2033, 8291, 3998, 3879, 8410, 1922, 10367, 10930, 1359, 6854, 5435, 973, 11316, 11035, 1254};

__device__ const  uint64_t KNTT2y[N/2] = {2401, 9888, 442, 11847, 7188, 5101, 11222, 1067, 390, 11899, 773, 11516, 8456, 3833, 3778, 8511, 354, 11935, 4861, 7428, 9377, 2912, 5698, 6591, 5012, 7277, 9808, 2481, 2859, 9430, 11244, 1045, 1017, 11272, 7404, 4885, 1632, 10657, 7205, 5084, 27, 12262, 9223, 3066, 8526, 3763, 10849, 1440, 1537, 10752, 242, 12047, 4714, 7575, 8146, 4143, 9611, 2678, 3704, 8585, 5019, 7270, 11744, 545, 1002, 11287, 5011, 7278, 5088, 7201, 8005, 4284, 7313, 4976, 10682, 1607, 8509, 3780, 11414, 875, 9852, 2437, 3646, 8643, 6022, 6267, 2987, 9302, 9723, 2566, 10102, 2187, 6250, 6039, 9867, 2422, 11224, 1065, 2143, 10146, 11885, 404, 7644, 4645, 1168, 11121, 5277, 7012, 11082, 1207, 3248, 9041, 493, 11796, 8193, 4096, 6845, 5444, 2381, 9908, 7952, 4337, 11854, 435, 1378, 10911, 1912, 10377, 2166, 10123, 3915, 8374, 12176, 113, 7370, 4919, 12129, 160, 3149, 9140, 12286, 3, 4437, 7852, 3636, 8653, 4938, 7351, 5291, 6998, 2704, 9585, 10863, 1426, 7635, 4654, 1663, 10626, 10512, 1777, 3364, 8925, 1689, 10600, 4057, 8232, 9018, 3271, 9442, 2847, 7875, 4414, 2174, 10115, 4372, 7917, 7247, 5042, 9984, 2305, 4053, 8236, 2645, 9644, 5195, 7094, 9509, 2780, 7394, 4895, 1484, 10805, 9042, 3247, 9603, 2686, 8311, 3978, 9320, 2969, 9919, 2370, 2865, 9424, 5332, 6957, 3510, 8779, 1630, 10659, 10163, 2126, 5407, 6882, 3186, 9103, 11136, 1153, 9405, 2884, 10040, 2249, 8241, 4048, 9890, 2399, 8889, 3400, 7098, 5191, 9153, 3136, 9289, 3000, 671, 11618, 3016, 9273, 243, 12046, 6730, 5559, 420, 11869, 10111, 2178, 1544, 10745, 3985, 8304, 4905, 7384, 3531, 8758, 476, 11813, 2401, 9888, 442, 11847, 7188, 5101, 11222, 1067, 390, 11899, 773, 11516, 8456, 3833, 3778, 8511, 354, 11935, 4861, 7428, 9377, 2912, 5698, 6591, 5012, 7277, 9808, 2481, 2859, 9430, 11244, 1045, 1017, 11272, 7404, 4885, 1632, 10657, 7205, 5084, 27, 12262, 9223, 3066, 8526, 3763, 10849, 1440, 1537, 10752, 242, 12047, 4714, 7575, 8146, 4143, 9611, 2678, 3704, 8585, 5019, 7270, 11744, 545, 1002, 11287, 5011, 7278, 5088, 7201, 8005, 4284, 7313, 4976, 10682, 1607, 8509, 3780, 11414, 875, 9852, 2437, 3646, 8643, 6022, 6267, 2987, 9302, 9723, 2566, 10102, 2187, 6250, 6039, 9867, 2422, 11224, 1065, 2143, 10146, 11885, 404, 7644, 4645, 1168, 11121, 5277, 7012, 11082, 1207, 3248, 9041, 493, 11796, 8193, 4096, 6845, 5444, 2381, 9908, 7952, 4337, 11854, 435, 1378, 10911, 1912, 10377, 2166, 10123, 3915, 8374, 12176, 113, 7370, 4919, 12129, 160, 3149, 9140, 12286, 3, 4437, 7852, 3636, 8653, 4938, 7351, 5291, 6998, 2704, 9585, 10863, 1426, 7635, 4654, 1663, 10626, 10512, 1777, 3364, 8925, 1689, 10600, 4057, 8232, 9018, 3271, 9442, 2847, 7875, 4414, 2174, 10115, 4372, 7917, 7247, 5042, 9984, 2305, 4053, 8236, 2645, 9644, 5195, 7094, 9509, 2780, 7394, 4895, 1484, 10805, 9042, 3247, 9603, 2686, 8311, 3978, 9320, 2969, 9919, 2370, 2865, 9424, 5332, 6957, 3510, 8779, 1630, 10659, 10163, 2126, 5407, 6882, 3186, 9103, 11136, 1153, 9405, 2884, 10040, 2249, 8241, 4048, 9890, 2399, 8889, 3400, 7098, 5191, 9153, 3136, 9289, 3000, 671, 11618, 3016, 9273, 243, 12046, 6730, 5559, 420, 11869, 10111, 2178, 1544, 10745, 3985, 8304, 4905, 7384, 3531, 8758, 476, 11813};

__device__ const  uint64_t KNTT3y[N/8] = {1260, 11029, 4388, 7901, 4632, 7657, 6534, 5755, 2426, 9863, 334, 11955, 1428, 10861, 1696, 10593, 2013, 10276, 9000, 3289, 729, 11560, 3241, 9048, 2881, 9408, 3284, 9005, 7197, 5092, 10200, 2089, 8595, 3694, 7110, 5179, 10530, 1759, 8582, 3707, 3382, 8907, 11934, 355, 9741, 2548, 8058, 4231, 3637, 8652, 3459, 8830, 145, 12144, 6747, 5542, 9558, 2731, 8357, 3932, 7399, 4890, 6378, 5911, 9447, 2842, 480, 11809, 1022, 11267, 9, 12280, 9821, 2468, 339, 11950, 5791, 6498, 544, 11745, 10616, 1673, 4278, 8011, 6958, 5331, 7300, 4989, 8112, 4177, 8705, 3584, 1381, 10908, 9764, 2525, 11336, 953, 8541, 3748, 827, 11462, 5767, 6522, 2476, 9813, 118, 12171, 2197, 10092, 7222, 5067, 3949, 8340, 8993, 3296, 4452, 7837, 2396, 9893, 7935, 4354, 130, 12159, 2837, 9452, 6915, 5374};


//  以下是N=2048的参数，测试 NTT 1KNTT 2KNTT 3KNTT 的运行时间，可以使用Hpol_naivemul进行比对，测试正确性。
/*
#define N 2048
#define Q 12289
#define INV_N0  12283 // 2048的逆
#define INV_N1  12277 // 1024的逆
#define INV_N2  12265 // 512的逆
#define INV_N3  12241 // 256的逆
#define N1 N/2
#define N2 N/4
#define N3 N/8

// 2n次本原根为41
// 41 ^（2 * N） = 1 mod Q
// phi[i] = 41 ^(bitrev[i]) mod Q
__device__ const uint64_t Dphi[N] = {1,10810,5146,8246,11567,10984,8155,6553,3621,2545,3542,8785,3195,5860,11077,10643,3006,2744,9314,563,4821,9650,9664,11340,8961,6512,4978,10938,6461,5023,6561,4591,8736,7484,2294,11227,9154,3712,2747,4846,1170,2319,11499,955,3201,9275,5086,10963,11112,8034,1635,2768,1853,12149,11563,4611,2366,3051,9326,7393,12208,9198,1000,7969,145,6747,8830,3637,5911,7399,2731,3932,8907,355,9741,8058,8582,1759,8595,7110,5755,4632,11029,7901,10861,10593,334,9863,9000,10276,9048,729,2881,3284,5092,2089,953,3748,827,5767,118,9813,5067,2197,9893,4452,8340,3296,9452,5374,130,4354,1381,9764,3584,8112,10616,4278,5331,4989,11267,12280,480,2842,544,6498,9821,339,11121,7012,11082,3248,7644,404,11224,2143,10377,1378,4337,435,4096,493,2381,5444,3646,2437,9302,6022,9723,10102,6039,2422,3780,875,10682,4976,11287,7278,5088,8005,8511,8456,11899,11516,11847,2401,11222,5101,9808,7277,1045,2859,9377,5698,7428,354,10657,5084,7404,11272,10849,3763,27,9223,1537,242,7575,4143,8585,9611,11744,7270,2686,9042,9320,3978,2370,9424,5332,3510,5407,3186,2126,1630,4048,10040,1153,2884,243,9273,9289,671,8889,2399,3136,7098,7384,3985,476,8758,2178,10745,420,5559,5195,9509,4895,10805,9644,4053,5042,2305,8925,10600,4057,9018,7875,2847,7917,2174,9140,12129,4437,3,113,4919,3915,10123,1663,10512,4654,10863,3636,4938,6998,9585,11580,4046,1319,3150,8049,3570,6224,11454,1112,2078,7967,1958,8210,11231,11367,11848,7032,8455,7856,6370,10542,3123,5486,9235,64,3656,9830,11606,2948,2503,5782,1566,12121,2692,7991,3329,10695,10327,6328,5106,6122,2555,7105,11089,3956,10929,6992,6170,11130,5990,8240,3728,1146,948,10885,11964,6099,11994,11637,5766,8273,4077,3762,2919,7796,9087,6920,2057,11939,1512,5383,1815,1483,6374,49,1263,10706,6347,1489,9789,11942,9364,8532,1975,4754,10431,8974,11863,9280,1693,12115,11566,9634,6554,2738,5868,218,9381,3529,3434,2361,10446,8174,3030,2882,1805,10238,10335,8326,11713,6142,9842,3991,8320,2767,12133,6413,2281,5333,2031,11836,6381,3772,418,7552,1293,4774,5429,4749,5537,7822,7500,12142,8500,5456,4449,3818,6118,9606,11099,8429,6844,7753,11239,7965,4916,4075,6974,522,2169,7210,3262,11271,6364,8775,11248,9945,1278,5574,1973,11889,1728,6152,7341,6153,5862,6874,8646,1702,1987,8724,654,56,3199,5529,7083,1922,8410,10256,8291,973,11035,5435,10930,3988,468,11907,11973,8579,6196,5446,6950,421,4080,3602,6068,3263,3600,4624,6077,605,2302,4213,11785,5594,9260,5886,7507,12048,58,1003,3532,1956,7280,885,6008,12147,1105,6608,8812,4212,975,9445,3438,3445,4780,7232,7591,7377,2049,1321,192,1010,5468,11502,8807,8120,9162,2920,7048,8332,2839,151,10162,5906,2505,1579,11858,677,6415,6055,3336,2766,1323,3174,52,1681,8468,11259,11823,2929,6026,6320,4649,3846,1573,6226,8496,502,7171,2602,10388,2307,4289,648,150,5650,170,11415,2301,9416,9462,11498,2434,9754,1120,5808,12268,12150,8957,9757,8972,2046,9349,9332,10808,530,2626,11511,7785,10588,8823,8711,7592,12281,11832,7988,7766,5776,10440,8494,9021,7899,4218,8531,3454,11307,2276,9696,879,10254,11249,10407,6164,6879,1251,7014,10499,4665,6883,5673,3020,11345,7519,8620,7002,2712,7455,7937,9461,8176,72,8449,1842,1241,7911,8195,8838,1095,2643,6508,9244,4423,8420,1530,10595,1734,3815,1350,6457,3116,12100,10080,10526,11424,1279,9617,7119,11129,7469,3094,7771,1868,2253,2730,5411,2478,9449,8095,9270,5078,10506,4974,4565,2832,2021,11007,3572,7559,3229,3929,1706,5646,6086,3120,6184,3536,5370,8536,8348,9004,4360,5054,9135,12282,10353,845,3723,767,8484,2213,8136,11520,6763,12073,12239,2595,8452,8016,3221,6627,5289,567,9348,7699,5082,11607,980,8239,5207,844,5202,9344,5349,9656,10883,293,9057,8520,7434,3007,1265,2171,8809,4099,8345,5530,5604,5103,10398,10734,1802,2334,1223,4411,1590,7596,9951,9996,11872,8871,4443,8820,6138,2946,5461,7779,9652,11274,1927,11924,11408,614,1280,1371,12265,11385,9804,5547,5039,7605,8929,7154,63,2373,4987,8481,3670,10345,11839,11711,6921,2622,5386,11779,4661,3090,1398,11463,5043,5618,10631,6500,8787,5900,11379,7570,11538,4483,5703,3065,1506,204,5509,5219,10880,180,4138,4605,9600,1344,3042,9806,10235,463,3407,10821,8308,11063,6771,7550,4251,364,2360,5216,3028,9272,1236,7814,7043,3121,4705,11232,2600,239,2900,994,4554,11777,7619,7383,5464,5189,6094,10886,10485,1687,11883,5268,12143,5672,4499,1737,11667,9342,8307,11653,6680,3393,7954,9998,8914,8054,8464,7376,3528,5002,20,7126,4608,1522,10138,4119,3343,10545,10975,8635,9395,5690,2455,8342,338,6565,10964,1029,1945,3624,10397,6691,8945,4939,7174,2442,1248,10141,6330,6492,8330,10077,2674,8951,9013,11783,11034,1392,5784,2776,11111,5478,8778,11124,2575,1942,3408,11366,1038,6085,8122,2800,193,6092,10058,425,10453,11897,2185,375,10669,377,7711,7508,4924,11841,11275,10962,8682,3942,7057,3200,10754,12229,2717,12221,2260,6453,4566,6444,5588,5102,11877,4963,8545,3056,2528,9202,6454,3975,7406,4505,10032,5676,10872,3495,4564,6463,2065,8144,10533,3534,8328,10014,9828,4267,5653,8113,7226,3765,10771,11164,4860,11158,1445,1176,5734,5508,1275,6323,212,9175,9520,6302,6693,11710,8400,7228,1218,8774,438,4209,5412,6296,3278,9307,10916,3589,717,2429,8186,1721,10753,416,11475,2450,1705,6873,10125,716,10179,7078,1866,11081,4727,1908,4538,11946,3448,2926,10463,3171,4489,1136,3449,8581,3238,1928,11825,4265,8611,8930,3205,5209,1092,8921,4227,8051,612,10763,8067,12164,540,7449,6162,3163,4032,4404,11943,2068,1389,41,806,2073,6283,7265,7940,2552,10604,993,6033,10043,3804,8105,6769,11753,6248,356,1903,915,10794,1037,2402,2976,10247,11020,8923,7474,6054,6832,9319,10932,3896,1795,11908,8031,5614,6644,4724,2026,2062,11103,9056,4477,2288,8351,11605,11902,7079,899,9880,5590,2887,2239,6549,7101,4716,10983,2201,1407,8177,8968,8448,4133,7215,5945,6269,5649,1649,8860,8423,1370,1455,8806,2266,6133,10864,7770,10674,8303,8863,2464,5577,9785,4427,2897,4198,1405,11135,330,3490,2298,5311,7520,11754,12148,11915,2206,6200,9329,2956,4838,9085,11123,4054,76,10486,10137,12246,6573,11421,5330,6468,7465,7076,11765,789,5141,3352,9658,7925,7254,11920,7391,5921,10015,8349,9413,1610,1268,4845,11958,10278,6179,4275,5491,1840,7631,7342,5771,5546,8179,7924,11598,2002,2018,1605,423,1122,5395,8645,1819,990,7512,11297,7847,7392,8074,3462,11984,8691,4859,2604,8588,5174,6456,129,5409,228,8880,3421,5978,6618,3498,127,9612,2225,6822,11820,8628,7459,2405,6815,1107,9473,1572,9922,3350,10106,7893,803,2233,3134,11814,2052,1161,3341,11147,5425,9699,8731,485,7736,1143,5385,6211,6103,10406,7643,9963,11523,12179,2933,8068,47,5686,8371,7808,3628,7227,2697,3275,10430,4931,6717,4082,8910,4071,601,2156,6416,10098,8482,9544,4485,6580,1068,3361,6126,5083,3111,6070,5729,9871,123,4633,5055,758,9506,6738,877,6479,2979,1608,5834,4271,12026,7798,6129,4923,6260,10495,11191,9404,2632,8725,11464,7133,6544,4807,5778,11354,6497,5665,2563,2582,3101,2107,5153,3724,9965,2624,2428,9782,8864,10267,4311,3571,2761,5401,12060,8117,1310,8380,5581,1379,433,5222,6443,8658,12245,2439,5685,4025,7190,1637,12099,6037,5380,10119,2001,3881,11253,4279,194,10135,2915,7390,7400,6774,9078,122,3897,1073,10603,10228,547,11790,681,11647,3265,2009,2627,8831,2158,11893,8101,10351,2965,5720,7241,10579,9845,11553,7112,11810,7968,5155,7224,1746,10645,1657,7097,8938,3662,9510,5615,10778,10460,3331,1340,7561,271,1932,5909,9563,962,6042,10274,3874,9317,2846,5893,4864,7498,9740,9537,6005,3552,7184,4849,2407,3857,11399,1387,10374,5815,1188,275,6262,4408,2494,10363,9070,5058,598,366,1497,10246,10648,6106,7051,4932,7318,3287,9113,2906,674,10852,7418,2855,3394,6475,2208,3242,7332,7159,8178,9403,6452,6045,6493,6851,11476,10394,8337,7733,1303,2236,2296,8269,5487,7756,5068,718,2670,8128,3026,10031,1633,5726,3751,6899,8916,11622,7647,8256,2084,2303,4972,7523,214,3008,10893,132,5249,3377,227,8359,687,3914,8152,10990,7835,562,2408,2378,4256,9633,6462,3544,11707,548,6467,8438,570,4911,646,3108,6286,5779,6066,11645,1576,4006,7521,10275,5005,7872,4543,2986,4600,4706,1117,6972,9119,6321,9809,5798,6191,11105,8655,4393,3294,6907,3179,4946,2475,1597,2805,5087,7244,2132,7476,3096,6926,5472,9488,1286,1051,6274,10218,3048,9486,4244,8293,11364,8370,8082,8564,3803,1990,6150,10448,6970,1033,8318,5097,6983,4436,1482,6666,9053,4637,11428,6590,10856,6789,11471,10152,2350,1653,724,9441,9354,4969,11960,3993,5362,770,4047,11961,5841,7994,11181,3325,10214,4162,1191,4345,892,5679,6435,8894,7293,4288,11461,2588,6516,8861,6944,11681,2135,4927,344,6930,11845,11391,930,10452,1054,9328,4435,591,10719,5903,6942,3413,2952,2317,1788,1725,4837,4192,5977,8028,10051,8759,10334,9297,1128,1285,4280,9649,8947,6194,6668,4866,4540,7743,1451,1402,3283,1049,9232,1596,11293,3964,11386,2854,6350,1329,649,3286,6450,92,11400,11574,631,7310,2830,5511,9127,8883,11273,2694,9499,1332,8501,10284,3746,5030,7764,9797,11257,5884,10465,494,6714,10590,5865,12002,6647,10067,5175,6869,3752,4710,1773,5338,6925,3433,10239,8083,2440,9142,9171,1349,7936,10958,2309,8434,11738,8905,3313,5996,4574,10026,4369,2145,10396,2648,3799,12013,2667,5228,9858,397,2709,2988,4788,8302,10342,5528,8562,310,8492,9979,148,9671,987,8805,3745,4211,2454,4299,7481,7330,10117,5239,5878,10185,2699,11714,2484,7541,5273,9613,746,596,3324,7055,11305,12092,8716,6225,9975,4580,9708,10667,2583,11270,7843,3629,3002,6319,6128,880,1114,9190,11913,3668,6766,3800,8162,3001,10139,9136,5756,8431,3886,8409,11846,3145,6076,11757,332,2775,301,8364,4667,5066,3676,7380,9901,4470,352,5948,1832,8798,1809,6694,4508,1257,8825,11179,7253,2325,2245,2635,10737,4943,1258,11482,1520,860,6116,5071,8570,5819,8288,9799,8299,3887,2379,3586,5154,7767,2822,3836,4074,3922,12059,7722,7932,7075,6303,11350,124,9772,11365,2063,8784,10791,3522,3934,6600,4381,9093,10700,2932,7480,9469,8458,820,9519,4593,957,10121,9122,1884,2230,7571,9943,4236,12088,2343,10219,1569,11096,7120,5322,6011,1116,8451,3973,10364,5875,11487,1810,2012,10244,1461,8103,9727,7620,11322,10610,863,3832,9990,7916,3653,3215,858,3396,3517,1391,7263,5888,4549,11313,5691,3705,1199,4199,7913,3992,6841,5136,10747,8506,3562,3086,7314,3168,8926,603,5260,6210,7582,7038,11870,1865,6690,8310,10799,9829,796,9501,6637,6504,2871,6135,7906,269,7686,6859,6253,2406,5336,8612,6545,3218,8710,370,5775,11514,3348,8116,2789,6914,10931,2101,1738,9715,9645,5037,9700,2901,10571,830,1330,6897,11496,3031,2636,2785,10089,11349,1603,4626,3119,1174,8692,7505,9361,313,4055,839,308,1412,782,3353,5669,523,690,67,11508,628,5152,11970,4819,1277,3823,9116,10758,4767,3493,2138,8460,11435,9588,4778,11802,7551,2772,11917,9472,4494,1723,10515,6189,9365,11157,7121,12003,9709,6230,7729,9868,5314,5554,2819,8959,9749,8515,4656,7905,9380,1261,10577,514,11168,11233,7164,9851,10473,6862,6793,5555,8518,10392,11054,7793 };
// 49^(-1) = 4496 invphi[i]=4496^(bitrev[i]) mod Q
__device__ const uint64_t Dinvphi[N] = {1,1479,4043,7143,5736,4134,1305,722,1646,1212,6429,9094,3504,8747,9744,8668,7698,5728,7266,5828,1351,7311,5777,3328,949,2625,2639,7468,11726,2975,9545,9283,4320,11289,3091,81,4896,2963,9238,9923,7678,726,140,10436,9521,10654,4255,1177,1326,7203,3014,9088,11334,790,9970,11119,7443,9542,8577,3135,1062,9995,4805,3553,11950,2468,5791,11745,9447,11809,9,1022,7300,6958,8011,1673,4177,8705,2525,10908,7935,12159,6915,2837,8993,3949,7837,2396,10092,7222,2476,12171,6522,11462,8541,11336,10200,7197,9005,9408,11560,3241,2013,3289,2426,11955,1696,1428,4388,1260,7657,6534,5179,3694,10530,3707,4231,2548,11934,3382,8357,9558,4890,6378,8652,3459,5542,12144,2704,5291,7351,8653,1426,7635,1777,10626,2166,8374,7370,12176,12286,7852,160,3149,10115,4372,9442,4414,3271,8232,1689,3364,9984,7247,8236,2645,1484,7394,2780,7094,6730,11869,1544,10111,3531,11813,8304,4905,5191,9153,9890,3400,11618,3000,3016,12046,9405,11136,2249,8241,10659,10163,9103,6882,8779,6957,2865,9919,8311,2969,3247,9603,5019,545,2678,3704,8146,4714,12047,10752,3066,12262,8526,1440,1017,4885,7205,1632,11935,4861,6591,2912,9430,11244,5012,2481,7188,1067,9888,442,773,390,3833,3778,4284,7201,5011,1002,7313,1607,11414,8509,9867,6250,2187,2566,6267,2987,9852,8643,6845,9908,11796,8193,11854,7952,10911,1912,10146,1065,11885,4645,9041,1207,5277,1168,12237,9115,10966,9523,8953,6234,5874,11612,431,10710,9784,6383,2127,12138,9450,3957,5241,9369,3127,4169,3482,787,6821,11279,12097,10968,10240,4912,4698,5057,7509,8844,8851,2844,11314,8077,3477,5681,11184,142,6281,11404,5009,10333,8757,11286,12231,241,4782,6403,3029,6695,504,8076,9987,11684,6212,7665,8689,9026,6221,8687,8209,11868,5339,6843,6093,3710,316,382,11821,8301,1359,6854,1254,11316,3998,2033,3879,10367,5206,6760,9090,12233,11635,3565,10302,10587,3643,5415,6427,6136,4948,6137,10561,400,10316,6715,11011,2344,1041,3514,5925,1018,9027,5079,10120,11767,5315,8214,7373,4324,1050,4536,5445,3860,1190,2683,6171,8471,7840,6833,3789,147,4789,4467,6752,7540,6860,7515,10996,4737,11871,8517,5908,453,10258,6956,10008,5876,156,9522,3969,8298,2447,6147,576,3963,1954,2051,10484,9407,9259,4115,1843,9928,8855,8760,2908,12071,6421,9551,5735,2655,723,174,10596,3009,426,3315,1858,7535,10314,3757,2925,347,2500,10800,5942,1583,11026,12240,5915,10806,10474,6906,10777,350,10232,5369,3202,4493,9370,8527,8212,4016,6523,652,295,6190,325,1404,11341,11143,8561,4049,6299,1159,6119,5297,1360,8333,1200,5184,9734,6167,7183,5961,1962,1594,8960,4298,9597,168,10723,6507,9786,9341,683,2459,8633,12225,3054,6803,9166,1747,5919,4433,3834,5257,441,922,1058,4079,10331,4322,10211,11177,835,6065,8719,4240,9139,10970,8243,709,10900,10221,346,7885,8257,9126,6127,4840,11749,125,4222,1526,11677,4238,8062,3368,11197,7080,9084,3359,3678,8024,464,10361,9051,3708,8840,11153,7800,9118,1826,9363,8841,343,7751,10381,7562,1208,10423,5211,2110,11573,2164,5416,10584,9839,814,11873,1536,10568,4103,9860,11572,8700,1373,2982,9011,5993,6877,8080,11851,3515,11071,5061,3889,579,5596,5987,2769,3114,12077,5966,11014,6781,6555,11113,10844,1131,7429,1125,1518,8524,5063,4176,6636,8022,2461,2275,3961,8755,1756,4145,10224,5826,7725,8794,1417,6613,2257,7784,4883,8314,5835,3087,9761,9233,3744,7326,412,7187,6701,5845,7723,5836,10029,68,9572,60,1535,9089,5232,8347,3607,1327,1014,448,7365,4781,4578,11912,1620,11914,10104,392,1836,11864,2231,6197,12096,9489,4167,6204,11251,923,8881,10347,9714,1165,3511,6811,1178,9513,6505,10897,1255,506,3276,3338,9615,2212,3959,5797,5959,2148,11041,9847,5115,7350,3344,5598,1892,8665,10344,11260,1325,5724,11951,3947,9834,6599,2894,3654,1314,1744,8946,8170,2151,10767,7681,5163,12269,7287,8761,4913,3825,4235,3375,2291,4335,8896,5609,636,3982,2947,622,10552,7790,6617,146,7021,406,10602,1804,1403,6195,7100,6825,4906,4670,512,7735,11295,9389,12050,9689,1057,7584,9168,5246,4475,11053,3017,9261,7073,9929,11925,8038,4739,5518,1226,3981,1468,8882,11826,2054,2483,9247,10945,2689,7684,8151,12109,1409,7070,6780,12085,10783,9224,6586,7806,751,4719,910,6389,3502,5789,1658,6671,7246,826,10891,9199,7628,510,6903,9667,5368,578,450,1944,8619,3808,7302,9916,12226,5135,3360,4684,7250,6742,2485,904,24,10918,11009,11675,881,365,10362,1015,2637,4510,6828,9343,6151,3469,7846,3418,417,2293,2338,4693,10699,7878,11066,9955,10487,1555,1891,7186,6685,6759,3944,8190,3480,10118,11024,9282,4855,3769,3232,11996,1406,2633,6940,2945,7087,11445,7082,4050,11309,682,7207,4590,2941,11722,7000,5662,9068,4273,3837,9694,50,216,5526,769,4153,10076,3805,11522,8566,11444,1936,7,3154,7235,7929,3285,3941,3753,6919,8753,6105,9169,6203,6643,10583,8360,9060,4730,8717,1282,10268,9457,7724,7315,1783,7211,3019,4194,2840,9811,6878,9559,10036,10421,4518,9195,4820,1160,5170,2672,11010,865,1763,2209,189,9173,5832,10939,8474,10555,1694,10759,3869,7866,3045,5781,9646,11194,3451,4094,4378,11048,10447,3840,12217,4113,2828,4352,4834,9577,5287,3669,4770,944,9269,6616,5406,7624,1790,5275,11038,5410,6125,1882,1040,2035,11410,2593,10013,982,8835,3758,8071,4390,3268,3795,1849,6513,4523,4301,457,8,4697,3578,3466,1701,4504,778,9663,11759,1481,2957,2940,10243,3317,2532,3332,139,21,6481,11169,2535,9855,791,2827,2873,9988,874,12119,6639,12139,11641,8000,9982,1901,9687,5118,11787,3793,6063,10716,8443,7640,5969,6263,9360,466,1030,3821,10608,4496,1235,1897,3771,6734,5496,5427,1816,2438,5125,1056,1121,11775,1712,11028,2909,4384,7633,3774,2540,3330,9470,6735,6975,2421,4560,6059,2580,286,5168,1132,2924,6100,1774,10566,7795,2817,372,9517,4738,487,7511,2701,854,3829,10151,8796,7522,1531,3173,8466,11012,7470,319,7137,11661,781,12222,11599,11766,6620,8936,11507,10877,11981,11450,8234,11976,2928,4784,3597,11115,9170,7663,10686,940,2200,9504,9653,9258,793,5392,10959,11459,1718,9388,2589,7252,2644,2574,10551,10188,1358,5375,9500,4173,8941,775,6514,11919,3579,9071,5744,3677,6953,9883,6036,5430,4603,12020,4383,6154,9418,5785,5652,2788,11493,2460,1490,3979,5599,10424,419,5251,4707,6079,7029,11686,3363,9121,4975,9203,8727,3783,1542,7153,5448,8297,4376,8090,11090,8584,6598,976,7740,6401,5026,10898,8772,8893,11431,9074,8636,4373,2299,8457,11426,1679,967,4669,2562,4186,10828,2045,10277,10479,802,6414,1925,8316,3838,11173,6278,6967,5169,1193,10720,2070,9946,201,8053,2346,4718,10059,10405,3167,2168,11332,7696,2770,11469,3831,2820,4809,9357,1589,3196,7908,5689,8355,8767,1498,3505,10226,924,2517,12165,939,5986,5214,4357,4567,230,8367,8215,8453,9467,4522,7135,8703,9910,8402,3990,2490,4001,6470,3719,7218,6173,11429,10769,807,11031,7346,1552,9654,10044,9964,5036,1110,3464,11032,7781,5595,10480,3491,10457,6341,11937,7819,2388,4909,8613,7223,7622,3925,11988,9514,11957,532,6213,9144,443,3880,8403,3858,6533,3153,2150,9288,4127,8489,5523,8621,376,3099,11175,11409,6161,5970,9287,8660,4446,1019,9706,1622,2581,7709,2314,6064,3573,197,984,5234,8965,11693,11543,2676,7016,4748,9805,575,9590,2104,6411,7050,2172,4959,4808,7990,9835,8078,8544,3484,11302,2618,12141,2310,3797,11979,3727,6761,1947,3987,7501,9301,9580,11892,2431,7061,9622,276,8490,9641,1893,10144,7920,2263,7715,6293,8976,3384,551,3855,9980,1331,4353,10940,3118,3147,9849,4206,2050,8856,5364,6951,10516,7579,8537,5420,7114,2222,5642,287,6424,1699,5575,11795,1824,6405,1032,2492,4525,7259,8543,2005,3788,10957,2790,9595,1016,3406,3162,6778,9459,4979,11658,715,889,12197,5839,9003,11640,10960,5939,9435,903,8325,996,10693,3057,11240,9006,10887,10838,4546,7749,7423,5621,6095,3342,2640,8009,11004,11161,2992,1955,3530,2238,4261,6312,8097,7452,10564,10501,9972,9337,8876,5347,6386,1570,11698,7854,2961,11235,1837,11359,898,444,5359,11945,7362,10154,608,5345,3428,5773,9701,828,8001,4996,3395,5854,6610,11397,7944,11098,8127,2075,8964,1108,4295,6448,328,8242,11519,6927,8296,329,7320,2935,2848,11565,10636,9939,2137,818,5500,1433,5699,861,7652,3236,5623,10807,7853,5306,7192,3971,11256,5319,1841,6139,10299,8486,3725,4207,3919,925,3996,8045,2803,9241,2071,6015,11238,11003,2801,6817,5363,9193,4813,10157,5045,7202,9484,10692,9814,7343,9110,5382,8995,7896,3634,1184,6098,6491,2480,5968,3170,5317,11172,7583,7689,9303,7746,4417,7284,2014,4768,8283,10713,644,6223,6510,6003,9181,11643,7378,11719,3851,5822,11741,582,8745,5827,2656,8033,9911,9881,11727,4454,1299,4137,8375,11602,3930,12062,8912,7040,12157,1396,9281,12075,4766,7317,9986,10205,4033,4642,667,3373,5390,8538,6563,10656,2258,9263,4161,9619,11571,7221,4533,6802,4020,9993,10053,10986,4556,3952,1895,813,5438,5796,6244,5837,2886,4111,5130,4957,9047,10081,5814,8895,9434,4871,1437,11615,9383,3176,9002,4971,7357,5238,6183,1641,2043,10792,11923,11691,7231,3219,1926,9795,7881,6027,12014,11101,6474,1915,10902,890,8432,9882,7440,5105,8737,6284,2752,2549,4791,7425,6396,9443,2972,8415,2015,6247,11327,2726,6380,10357,12018,4728,10949,8958,1829,1511,6674,2779,8627,3351,5192,10632,1644,10543,5065,7134,4321,479,5177,736,2444,1710,5048,6569,9324,1938,4188,396,10131,3458,9662,10280,9024,642,11608,499,11742,2061,1686,11216,8392,12167,3211,5515,4889,4899,9374,2154,12095,8010,1036,8408,10288,2170,6909,6252,190,10652,5099,8264,6604,9850,44,3631,5846,7067,11856,10910,6708,3909,10979,4172,229,6888,9528,8718,7978,2022,3425,2507,9861,9665,2324,8565,7136,10182,9188,9707,9726,6624,5792,935,6511,7482,5745,5156,825,3564,9657,2885,1098,1794,6029,7366,6160,4491,263,8018,6455,10681,9310,5810,11412,5551,2783,11531,7234,7656,12166,2418,6560,6219,9178,7206,6163,8928,11221,5709,7804,2745,3807,2191,5873,10133,11688,8218,3379,8207,5572,7358,1859,9014,9592,5062,8661,4481,3918,6603,12242,4221,9356,110,766,2326,4646,1883,6186,6078,6904,11146,4553,11804,3558,2590,6864,1142,8948,11128,10237,475,9155,10056,11486,4396,2183,8939,2367,10717,2816,11182,5474,9884,4830,3661,469,5467,10064,2677,12162,8791,5671,6311,8868,3409,12061,6880,12160,5833,7115,3701,9685,7430,3598,305,8827,4215,4897,4442,992,4777,11299,10470,3644,6894,11167,11866,10684,10271,10287,691,4365,4110,6743,6518,4947,4658,10449,6798,8014,6110,2011,331,7444,11021,10679,2876,3940,2274,6368,4898,369,5035,4364,2631,8937,7148,11500,524,5213,4824,5821,6959,868,5716,43,2152,1803,12213,8235,1166,3204,7451,9333,2960,6089,10083,374,141,535,4769,6978,9991,8799,11959,1154,10884,8091,9392,7862,2504,6712,9825,3426,3986,1615,4519,1425,6156,10023,3483,10834,10919,3866,3429,10640,6640,6020,6344,5074,8156,3841,3321,4112,10882,10088,1306,7573,5188,5740,10050,9402,6699,2409,11390,5210,387,684,3938,10001,7812,3233,1186,10227,10263,7565,5645,6675,4258,381,10494,8393,1357,2970,5457,6235,4815,3366,1269,2042,9313,9887,11252,1495,11374,10386,11933,6041,536,5520,4184,8485,2246,6256,11296,1685,9737,4349,5024,6006,10216,11483,12248};

__device__ const  uint64_t KNTT1y[N/2] = {1681, 10608, 8468, 3821, 11259, 1030, 11823, 466, 2929, 9360, 6026, 6263, 6320, 5969, 4649, 7640, 3846, 8443, 1573, 10716, 6226, 6063, 8496, 3793, 502, 11787, 7171, 5118, 2602, 9687, 10388, 1901, 2307, 9982, 4289, 8000, 648, 11641, 150, 12139, 5650, 6639, 170, 12119, 11415, 874, 2301, 9988, 9416, 2873, 9462, 2827, 11498, 791, 2434, 9855, 9754, 2535, 1120, 11169, 5808, 6481, 12268, 21, 12150, 139, 8957, 3332, 9757, 2532, 8972, 3317, 2046, 10243, 9349, 2940, 9332, 2957, 10808, 1481, 530, 11759, 2626, 9663, 11511, 778, 7785, 4504, 10588, 1701, 8823, 3466, 8711, 3578, 7592, 4697, 12281, 8, 11832, 457, 7988, 4301, 7766, 4523, 5776, 6513, 10440, 1849, 8494, 3795, 9021, 3268, 7899, 4390, 4218, 8071, 8531, 3758, 3454, 8835, 11307, 982, 2276, 10013, 9696, 2593, 879, 11410, 10254, 2035, 11249, 1040, 10407, 1882, 6164, 6125, 6879, 5410, 1251, 11038, 7014, 5275, 10499, 1790, 4665, 7624, 6883, 5406, 5673, 6616, 3020, 9269, 11345, 944, 7519, 4770, 8620, 3669, 7002, 5287, 2712, 9577, 7455, 4834, 7937, 4352, 9461, 2828, 8176, 4113, 72, 12217, 8449, 3840, 1842, 10447, 1241, 11048, 7911, 4378, 8195, 4094, 8838, 3451, 1095, 11194, 2643, 9646, 6508, 5781, 9244, 3045, 4423, 7866, 8420, 3869, 1530, 10759, 10595, 1694, 1734, 10555, 3815, 8474, 1350, 10939, 6457, 5832, 3116, 9173, 12100, 189, 10080, 2209, 10526, 1763, 11424, 865, 1279, 11010, 9617, 2672, 7119, 5170, 11129, 1160, 7469, 4820, 3094, 9195, 7771, 4518, 1868, 10421, 2253, 10036, 2730, 9559, 5411, 6878, 2478, 9811, 9449, 2840, 8095, 4194, 9270, 3019, 5078, 7211, 10506, 1783, 4974, 7315, 4565, 7724, 2832, 9457, 2021, 10268, 11007, 1282, 3572, 8717, 7559, 4730, 3229, 9060, 3929, 8360, 1706, 10583, 5646, 6643, 6086, 6203, 3120, 9169, 6184, 6105, 3536, 8753, 5370, 6919, 8536, 3753, 8348, 3941, 9004, 3285, 4360, 7929, 5054, 7235, 9135, 3154, 12282, 7, 10353, 1936, 845, 11444, 3723, 8566, 767, 11522, 8484, 3805, 2213, 10076, 8136, 4153, 11520, 769, 6763, 5526, 12073, 216, 12239, 50, 2595, 9694, 8452, 3837, 8016, 4273, 3221, 9068, 6627, 5662, 5289, 7000, 567, 11722, 9348, 2941, 7699, 4590, 5082, 7207, 11607, 682, 980, 11309, 8239, 4050, 5207, 7082, 844, 11445, 5202, 7087, 9344, 2945, 5349, 6940, 9656, 2633, 10883, 1406, 293, 11996, 9057, 3232, 8520, 3769, 7434, 4855, 3007, 9282, 1265, 11024, 2171, 10118, 8809, 3480, 4099, 8190, 8345, 3944, 5530, 6759, 5604, 6685, 5103, 7186, 10398, 1891, 10734, 1555, 1802, 10487, 2334, 9955, 1223, 11066, 4411, 7878, 1590, 10699, 7596, 4693, 9951, 2338, 9996, 2293, 11872, 417, 8871, 3418, 4443, 7846, 8820, 3469, 6138, 6151, 2946, 9343, 5461, 6828, 7779, 4510, 9652, 2637, 11274, 1015, 1927, 10362, 11924, 365, 11408, 881, 614, 11675, 1280, 11009, 1371, 10918, 12265, 24, 11385, 904, 9804, 2485, 5547, 6742, 5039, 7250, 7605, 4684, 8929, 3360, 7154, 5135, 63, 12226, 2373, 9916, 4987, 7302, 8481, 3808, 3670, 8619, 10345, 1944, 11839, 450, 11711, 578, 6921, 5368, 2622, 9667, 5386, 6903, 11779, 510, 4661, 7628, 3090, 9199, 1398, 10891, 11463, 826, 5043, 7246, 5618, 6671, 10631, 1658, 6500, 5789, 8787, 3502, 5900, 6389, 11379, 910, 7570, 4719, 11538, 751, 4483, 7806, 5703, 6586, 3065, 9224, 1506, 10783, 204, 12085, 5509, 6780, 5219, 7070, 10880, 1409, 180, 12109, 4138, 8151, 4605, 7684, 9600, 2689, 1344, 10945, 3042, 9247, 9806, 2483, 10235, 2054, 463, 11826, 3407, 8882, 10821, 1468, 8308, 3981, 11063, 1226, 6771, 5518, 7550, 4739, 4251, 8038, 364, 11925, 2360, 9929, 5216, 7073, 3028, 9261, 9272, 3017, 1236, 11053, 7814, 4475, 7043, 5246, 3121, 9168, 4705, 7584, 11232, 1057, 2600, 9689, 239, 12050, 2900, 9389, 994, 11295, 4554, 7735, 11777, 512, 7619, 4670, 7383, 4906, 5464, 6825, 5189, 7100, 6094, 6195, 10886, 1403, 10485, 1804, 1687, 10602, 11883, 406, 5268, 7021, 12143, 146, 5672, 6617, 4499, 7790, 1737, 10552, 11667, 622, 9342, 2947, 8307, 3982, 11653, 636, 6680, 5609, 3393, 8896, 7954, 4335, 9998, 2291, 8914, 3375, 8054, 4235, 8464, 3825, 7376, 4913, 3528, 8761, 5002, 7287, 20, 12269, 7126, 5163, 4608, 7681, 1522, 10767, 10138, 2151, 4119, 8170, 3343, 8946, 10545, 1744, 10975, 1314, 8635, 3654, 9395, 2894, 5690, 6599, 2455, 9834, 8342, 3947, 338, 11951, 6565, 5724, 10964, 1325, 1029, 11260, 1945, 10344, 3624, 8665, 10397, 1892, 6691, 5598, 8945, 3344, 4939, 7350, 7174, 5115, 2442, 9847, 1248, 11041, 10141, 2148, 6330, 5959, 6492, 5797, 8330, 3959, 10077, 2212, 2674, 9615, 8951, 3338, 9013, 3276, 11783, 506, 11034, 1255, 1392, 10897, 5784, 6505, 2776, 9513, 11111, 1178, 5478, 6811, 8778, 3511, 11124, 1165, 2575, 9714, 1942, 10347, 3408, 8881, 11366, 923, 1038, 11251, 6085, 6204, 8122, 4167, 2800, 9489, 193, 12096, 6092, 6197, 10058, 2231, 425, 11864, 10453, 1836, 11897, 392, 2185, 10104, 375, 11914, 10669, 1620, 377, 11912, 7711, 4578, 7508, 4781, 4924, 7365, 11841, 448, 11275, 1014, 10962, 1327, 8682, 3607, 3942, 8347, 7057, 5232, 3200, 9089, 10754, 1535, 12229, 60, 2717, 9572, 12221, 68, 2260, 10029, 6453, 5836, 4566, 7723, 6444, 5845, 5588, 6701, 5102, 7187, 11877, 412, 4963, 7326, 8545, 3744, 3056, 9233, 2528, 9761, 9202, 3087, 6454, 5835, 3975, 8314, 7406, 4883, 4505, 7784, 10032, 2257, 5676, 6613, 10872, 1417, 3495, 8794, 4564, 7725, 6463, 5826, 2065, 10224, 8144, 4145, 10533, 1756, 3534, 8755, 8328, 3961, 10014, 2275, 9828, 2461, 4267, 8022, 5653, 6636, 8113, 4176, 7226, 5063, 3765, 8524, 10771, 1518, 11164, 1125, 4860, 7429, 11158, 1131, 1445, 10844, 1176, 11113, 5734, 6555, 5508, 6781, 1275, 11014, 6323, 5966, 212, 12077, 9175, 3114, 9520, 2769, 6302, 5987, 6693, 5596, 11710, 579, 8400, 3889, 7228, 5061, 1218, 11071, 8774, 3515, 438, 11851, 4209, 8080, 5412, 6877, 6296, 5993, 3278, 9011, 9307, 2982, 10916, 1373, 3589, 8700, 717, 11572, 2429, 9860, 8186, 4103, 1721, 10568, 10753, 1536, 416, 11873, 11475, 814, 2450, 9839, 1705, 10584, 6873, 5416, 10125, 2164, 716, 11573, 10179, 2110, 7078, 5211, 1866, 10423, 11081, 1208, 4727, 7562, 1908, 10381, 4538, 7751, 11946, 343, 3448, 8841, 2926, 9363, 10463, 1826, 3171, 9118, 4489, 7800, 1136, 11153, 3449, 8840, 8581, 3708, 3238, 9051, 1928, 10361, 11825, 464, 4265, 8024, 8611, 3678, 8930, 3359, 3205, 9084, 5209, 7080, 1092, 11197, 8921, 3368, 4227, 8062, 8051, 4238, 612, 11677, 10763, 1526, 8067, 4222, 12164, 125, 540, 11749, 7449, 4840, 6162, 6127, 3163, 9126, 4032, 8257, 4404, 7885, 11943, 346, 2068, 10221, 1389, 10900};

__device__ const  uint64_t KNTT2y[N/2] = {11580, 709, 4046, 8243, 1319, 10970, 3150, 9139, 8049, 4240, 3570, 8719, 6224, 6065, 11454, 835, 1112, 11177, 2078, 10211, 7967, 4322, 1958, 10331, 8210, 4079, 11231, 1058, 11367, 922, 11848, 441, 7032, 5257, 8455, 3834, 7856, 4433, 6370, 5919, 10542, 1747, 3123, 9166, 5486, 6803, 9235, 3054, 64, 12225, 3656, 8633, 9830, 2459, 11606, 683, 2948, 9341, 2503, 9786, 5782, 6507, 1566, 10723, 12121, 168, 2692, 9597, 7991, 4298, 3329, 8960, 10695, 1594, 10327, 1962, 6328, 5961, 5106, 7183, 6122, 6167, 2555, 9734, 7105, 5184, 11089, 1200, 3956, 8333, 10929, 1360, 6992, 5297, 6170, 6119, 11130, 1159, 5990, 6299, 8240, 4049, 3728, 8561, 1146, 11143, 948, 11341, 10885, 1404, 11964, 325, 6099, 6190, 11994, 295, 11637, 652, 5766, 6523, 8273, 4016, 4077, 8212, 3762, 8527, 2919, 9370, 7796, 4493, 9087, 3202, 6920, 5369, 2057, 10232, 11939, 350, 1512, 10777, 5383, 6906, 1815, 10474, 1483, 10806, 6374, 5915, 49, 12240, 1263, 11026, 10706, 1583, 6347, 5942, 1489, 10800, 9789, 2500, 11942, 347, 9364, 2925, 8532, 3757, 1975, 10314, 4754, 7535, 10431, 1858, 8974, 3315, 11863, 426, 9280, 3009, 1693, 10596, 12115, 174, 11566, 723, 9634, 2655, 6554, 5735, 2738, 9551, 5868, 6421, 218, 12071, 9381, 2908, 3529, 8760, 3434, 8855, 2361, 9928, 10446, 1843, 8174, 4115, 3030, 9259, 2882, 9407, 1805, 10484, 10238, 2051, 10335, 1954, 8326, 3963, 11713, 576, 6142, 6147, 9842, 2447, 3991, 8298, 8320, 3969, 2767, 9522, 12133, 156, 6413, 5876, 2281, 10008, 5333, 6956, 2031, 10258, 11836, 453, 6381, 5908, 3772, 8517, 418, 11871, 7552, 4737, 1293, 10996, 4774, 7515, 5429, 6860, 4749, 7540, 5537, 6752, 7822, 4467, 7500, 4789, 12142, 147, 8500, 3789, 5456, 6833, 4449, 7840, 3818, 8471, 6118, 6171, 9606, 2683, 11099, 1190, 8429, 3860, 6844, 5445, 7753, 4536, 11239, 1050, 7965, 4324, 4916, 7373, 4075, 8214, 6974, 5315, 522, 11767, 2169, 10120, 7210, 5079, 3262, 9027, 11271, 1018, 6364, 5925, 8775, 3514, 11248, 1041, 9945, 2344, 1278, 11011, 5574, 6715, 1973, 10316, 11889, 400, 1728, 10561, 6152, 6137, 7341, 4948, 6153, 6136, 5862, 6427, 6874, 5415, 8646, 3643, 1702, 10587, 1987, 10302, 8724, 3565, 654, 11635, 56, 12233, 3199, 9090, 5529, 6760, 7083, 5206, 1922, 10367, 8410, 3879, 10256, 2033, 8291, 3998, 973, 11316, 11035, 1254, 5435, 6854, 10930, 1359, 3988, 8301, 468, 11821, 11907, 382, 11973, 316, 8579, 3710, 6196, 6093, 5446, 6843, 6950, 5339, 421, 11868, 4080, 8209, 3602, 8687, 6068, 6221, 3263, 9026, 3600, 8689, 4624, 7665, 6077, 6212, 605, 11684, 2302, 9987, 4213, 8076, 11785, 504, 5594, 6695, 9260, 3029, 5886, 6403, 7507, 4782, 12048, 241, 58, 12231, 1003, 11286, 3532, 8757, 1956, 10333, 7280, 5009, 885, 11404, 6008, 6281, 12147, 142, 1105, 11184, 6608, 5681, 8812, 3477, 4212, 8077, 975, 11314, 9445, 2844, 3438, 8851, 3445, 8844, 4780, 7509, 7232, 5057, 7591, 4698, 7377, 4912, 2049, 10240, 1321, 10968, 192, 12097, 1010, 11279, 5468, 6821, 11502, 787, 8807, 3482, 8120, 4169, 9162, 3127, 2920, 9369, 7048, 5241, 8332, 3957, 2839, 9450, 151, 12138, 10162, 2127, 5906, 6383, 2505, 9784, 1579, 10710, 11858, 431, 677, 11612, 6415, 5874, 6055, 6234, 3336, 8953, 2766, 9523, 1323, 10966, 3174, 9115, 52, 12237, 11580, 709, 4046, 8243, 1319, 10970, 3150, 9139, 8049, 4240, 3570, 8719, 6224, 6065, 11454, 835, 1112, 11177, 2078, 10211, 7967, 4322, 1958, 10331, 8210, 4079, 11231, 1058, 11367, 922, 11848, 441, 7032, 5257, 8455, 3834, 7856, 4433, 6370, 5919, 10542, 1747, 3123, 9166, 5486, 6803, 9235, 3054, 64, 12225, 3656, 8633, 9830, 2459, 11606, 683, 2948, 9341, 2503, 9786, 5782, 6507, 1566, 10723, 12121, 168, 2692, 9597, 7991, 4298, 3329, 8960, 10695, 1594, 10327, 1962, 6328, 5961, 5106, 7183, 6122, 6167, 2555, 9734, 7105, 5184, 11089, 1200, 3956, 8333, 10929, 1360, 6992, 5297, 6170, 6119, 11130, 1159, 5990, 6299, 8240, 4049, 3728, 8561, 1146, 11143, 948, 11341, 10885, 1404, 11964, 325, 6099, 6190, 11994, 295, 11637, 652, 5766, 6523, 8273, 4016, 4077, 8212, 3762, 8527, 2919, 9370, 7796, 4493, 9087, 3202, 6920, 5369, 2057, 10232, 11939, 350, 1512, 10777, 5383, 6906, 1815, 10474, 1483, 10806, 6374, 5915, 49, 12240, 1263, 11026, 10706, 1583, 6347, 5942, 1489, 10800, 9789, 2500, 11942, 347, 9364, 2925, 8532, 3757, 1975, 10314, 4754, 7535, 10431, 1858, 8974, 3315, 11863, 426, 9280, 3009, 1693, 10596, 12115, 174, 11566, 723, 9634, 2655, 6554, 5735, 2738, 9551, 5868, 6421, 218, 12071, 9381, 2908, 3529, 8760, 3434, 8855, 2361, 9928, 10446, 1843, 8174, 4115, 3030, 9259, 2882, 9407, 1805, 10484, 10238, 2051, 10335, 1954, 8326, 3963, 11713, 576, 6142, 6147, 9842, 2447, 3991, 8298, 8320, 3969, 2767, 9522, 12133, 156, 6413, 5876, 2281, 10008, 5333, 6956, 2031, 10258, 11836, 453, 6381, 5908, 3772, 8517, 418, 11871, 7552, 4737, 1293, 10996, 4774, 7515, 5429, 6860, 4749, 7540, 5537, 6752, 7822, 4467, 7500, 4789, 12142, 147, 8500, 3789, 5456, 6833, 4449, 7840, 3818, 8471, 6118, 6171, 9606, 2683, 11099, 1190, 8429, 3860, 6844, 5445, 7753, 4536, 11239, 1050, 7965, 4324, 4916, 7373, 4075, 8214, 6974, 5315, 522, 11767, 2169, 10120, 7210, 5079, 3262, 9027, 11271, 1018, 6364, 5925, 8775, 3514, 11248, 1041, 9945, 2344, 1278, 11011, 5574, 6715, 1973, 10316, 11889, 400, 1728, 10561, 6152, 6137, 7341, 4948, 6153, 6136, 5862, 6427, 6874, 5415, 8646, 3643, 1702, 10587, 1987, 10302, 8724, 3565, 654, 11635, 56, 12233, 3199, 9090, 5529, 6760, 7083, 5206, 1922, 10367, 8410, 3879, 10256, 2033, 8291, 3998, 973, 11316, 11035, 1254, 5435, 6854, 10930, 1359, 3988, 8301, 468, 11821, 11907, 382, 11973, 316, 8579, 3710, 6196, 6093, 5446, 6843, 6950, 5339, 421, 11868, 4080, 8209, 3602, 8687, 6068, 6221, 3263, 9026, 3600, 8689, 4624, 7665, 6077, 6212, 605, 11684, 2302, 9987, 4213, 8076, 11785, 504, 5594, 6695, 9260, 3029, 5886, 6403, 7507, 4782, 12048, 241, 58, 12231, 1003, 11286, 3532, 8757, 1956, 10333, 7280, 5009, 885, 11404, 6008, 6281, 12147, 142, 1105, 11184, 6608, 5681, 8812, 3477, 4212, 8077, 975, 11314, 9445, 2844, 3438, 8851, 3445, 8844, 4780, 7509, 7232, 5057, 7591, 4698, 7377, 4912, 2049, 10240, 1321, 10968, 192, 12097, 1010, 11279, 5468, 6821, 11502, 787, 8807, 3482, 8120, 4169, 9162, 3127, 2920, 9369, 7048, 5241, 8332, 3957, 2839, 9450, 151, 12138, 10162, 2127, 5906, 6383, 2505, 9784, 1579, 10710, 11858, 431, 677, 11612, 6415, 5874, 6055, 6234, 3336, 8953, 2766, 9523, 1323, 10966, 3174, 9115, 52, 12237};

__device__ const  uint64_t KNTT3y[N/8] = {11121, 1168, 7012, 5277, 11082, 1207, 3248, 9041, 7644, 4645, 404, 11885, 11224, 1065, 2143, 10146, 10377, 1912, 1378, 10911, 4337, 7952, 435, 11854, 4096, 8193, 493, 11796, 2381, 9908, 5444, 6845, 3646, 8643, 2437, 9852, 9302, 2987, 6022, 6267, 9723, 2566, 10102, 2187, 6039, 6250, 2422, 9867, 3780, 8509, 875, 11414, 10682, 1607, 4976, 7313, 11287, 1002, 7278, 5011, 5088, 7201, 8005, 4284, 8511, 3778, 8456, 3833, 11899, 390, 11516, 773, 11847, 442, 2401, 9888, 11222, 1067, 5101, 7188, 9808, 2481, 7277, 5012, 1045, 11244, 2859, 9430, 9377, 2912, 5698, 6591, 7428, 4861, 354, 11935, 10657, 1632, 5084, 7205, 7404, 4885, 11272, 1017, 10849, 1440, 3763, 8526, 27, 12262, 9223, 3066, 1537, 10752, 242, 12047, 7575, 4714, 4143, 8146, 8585, 3704, 9611, 2678, 11744, 545, 7270, 5019, 2686, 9603, 9042, 3247, 9320, 2969, 3978, 8311, 2370, 9919, 9424, 2865, 5332, 6957, 3510, 8779, 5407, 6882, 3186, 9103, 2126, 10163, 1630, 10659, 4048, 8241, 10040, 2249, 1153, 11136, 2884, 9405, 243, 12046, 9273, 3016, 9289, 3000, 671, 11618, 8889, 3400, 2399, 9890, 3136, 9153, 7098, 5191, 7384, 4905, 3985, 8304, 476, 11813, 8758, 3531, 2178, 10111, 10745, 1544, 420, 11869, 5559, 6730, 5195, 7094, 9509, 2780, 4895, 7394, 10805, 1484, 9644, 2645, 4053, 8236, 5042, 7247, 2305, 9984, 8925, 3364, 10600, 1689, 4057, 8232, 9018, 3271, 7875, 4414, 2847, 9442, 7917, 4372, 2174, 10115, 9140, 3149, 12129, 160, 4437, 7852, 3, 12286, 113, 12176, 4919, 7370, 3915, 8374, 10123, 2166, 1663, 10626, 10512, 1777, 4654, 7635, 10863, 1426, 3636, 8653, 4938, 7351, 6998, 5291, 9585, 2704};
*/


//  以下是N=4096的参数，测试 NTT 1KNTT 2KNTT 3KNTT 的运行时间，可以使用Hpol_naivemul进行比对，测试正确性。
/*
#define N 4096
#define Q 40961
#define INV_N0  40951 // 4096的逆
#define INV_N1  40941 // 2048的逆
#define INV_N2  40921 // 1024的逆
#define INV_N3  40881 // 512的逆
#define N1 N/2
#define N2 N/4
#define N3 N/8

// 2n次本原根为12
// 12 ^（2 * N） = 1 mod Q
// phi[i] = 12^(bitrev[i]) mod Q
__device__ const uint64_t Dphi[N] = {1,14541,9282,3067,302,8555,17816,25092,24888,5973,31337,21153,20313,1562,1783,39251,36030,21040,24856,32193,26395,5125,10649,14529,37389,39057,23106,22224,27203,39407,14642,35005,26385,23559,40712,24820,21836,28565,6724,40738,24089,20638,28960,28280,24781,6604,21227,20672,28662,36928,39950,4048,13153,10864,22366,34627,4041,22107,29247,23525,32513,40632,25979,18297,26777,30052,33727,39215,17337,23323,27226,5201,31467,27277,24764,5173,82,4493,23826,5728,20877,10486,34784,7716,37821,12775,18752,36416,37452,13037,34418,10640,5268,4918,31103,18322,15817,39943,9170,12915,25258,20252,24953,9035,18286,18875,29229,7553,33598,6671,20543,28151,37078,22516,3674,10490,15203,306,3601,13983,27856,31728,13560,30667,15507,37943,39981,4248,7962,19656,9640,6698,28786,37728,3049,15707,29899,1305,11743,29515,18078,25461,23740,24993,20977,30951,20881,27689,27060,8094,39029,6034,27631,36883,14121,36929,29479,38235,4598,11166,29362,16339,24551,20976,19748,19058,461,26758,17216,25185,10051,2743,38146,28085,4288,9166,13113,2678,19735,34830,27870,30497,20625,32644,20057,6517,1329,32358,35947,2006,32709,23398,37430,20823,35019,25088,39585,21513,7800,39752,22778,4252,25675,21621,38469,14313,12221,16743,2936,11014,12887,34253,26491,8387,579,22234,37705,5420,7026,8332,40713,39361,32841,17643,20840,4962,19038,17120,26647,23928,14936,9154,17738,37802,21857,6238,31946,29046,6093,40631,9109,27056,6234,1901,6531,19673,39423,648,26618,11849,32485,2133,10280,14791,20791,29751,14079,40622,15688,7399,32875,20505,27261,22604,17758,934,2692,26617,37986,36302,34725,9978,5346,33169,17801,11782,17013,22554,10011,35518,9920,23039,38073,31578,5687,35369,28966,33604,40067,25944,16975,2489,16739,11537,6325,14380,32912,26029,2046,13200,26862,37207,3477,13183,25487,32300,20559,15041,37367,5882,23707,36672,39371,22775,28541,38790,11352,37563,17572,40695,29300,15939,22521,35627,1024,21141,1816,27572,30678,23508,33285,2009,7570,13163,16625,33264,32108,8950,35181,4992,29820,40435,15763,32988,36716,1682,2392,6183,28762,16432,26047,24021,23547,3928,36319,4406,24941,39348,31751,19860,8709,27118,20885,3931,8614,38397,40237,40254,14178,5585,33464,24305,21812,7269,29722,8091,24010,18807,32980,31753,923,27096,6437,4532,27702,4308,17767,8920,9960,31225,40704,31375,32785,22567,11101,33301,29469,15708,34661,21457,6373,16011,6502,7594,40440,1924,38437,40533,10232,13160,25826,5418,17989,1103,16862,38757,9186,40766,24611,33255,29785,23032,18581,7565,17827,21199,28735,33435,17863,12182,35199,20964,6700,19442,10602,27439,16311,14061,6846,12456,38330,203,32775,40,24658,20345,26449,12080,13705,9140,25905,7249,1849,15893,40720,18265,7793,19887,38461,20868,18709,25568,23259,35103,6295,28721,19804,14134,16884,30971,502,8524,35096,38798,39200,34885,31054,2150,671,8293,2717,21493,28179,17956,1314,19048,31131,15860,35046,8085,25671,4418,15954,24971,11013,23484,37681,25085,30024,16646,33465,38846,14867,29850,2633,28879,26750,6094,16907,37726,9183,38104,20736,8255,36774,25840,36200,35350,5317,21090,9929,31025,39689,18220,8405,30442,25466,13666,30401,9829,1753,12631,5838,19166,37874,5189,29457,5060,5199,25614,7477,12563,13580,34760,3283,18538,38783,33516,8402,27780,38581,4465,31070,30001,26300,16404,3071,7921,37127,38688,32083,14074,7936,10239,22270,31365,20934,20103,28931,16201,38187,9851,12469,18343,22433,25810,21517,18579,35919,4468,26296,40162,33834,38584,31943,26384,19208,31430,20951,21534,25315,29869,29624,16708,39736,5310,16950,7613,39660,6141,25073,33593,28145,15094,35222,27719,20863,11717,6585,26628,8158,2422,22542,13300,6056,35107,2519,9645,33588,25105,23440,4559,26209,3925,11438,18298,37565,17730,13552,37222,39394,29530,30955,37187,23856,32348,9302,7160,36337,20378,27202,24866,5360,31938,22804,13669,21241,19441,40929,26220,30664,24739,31297,12967,3342,16276,14213,22988,30646,8767,32382,19967,38867,26130,34909,23057,23828,34810,15541,40805,27881,26604,6128,17073,26228,34438,7411,35921,15383,37143,15861,24371,7968,24980,38546,28023,30598,7136,12050,28853,24570,10528,34532,29874,6199,25459,24919,6173,32352,34308,29675,21001,21586,38844,19452,15827,38337,20068,17081,28278,26772,39269,3317,21400,26683,14911,18670,31923,29910,38373,12850,28729,36229,6468,30366,33387,4571,28169,28273,33097,33820,39815,18558,810,14351,22557,40651,38961,30811,32294,29263,10415,6775,4070,26349,32576,34248,37291,10964,7312,20724,38568,13053,31360,36269,14654,9750,8729,16651,1720,1373,16786,5315,32969,5036,31169,7651,3115,13097,15788,35067,26719,23038,16500,22296,40782,31459,33832,32430,21598,38627,17975,4181,9797,14190,16233,21965,20148,25436,28007,38709,22468,35939,8561,40375,39823,39874,4879,27833,24973,17349,33971,15727,1044,37351,18992,39039,28561,12011,35208,31221,13798,22754,23917,7712,29935,19610,19489,30297,13122,23836,28255,15391,30588,3365,23031,21648,39244,33166,32953,24897,13959,31248,37756,40056,29837,15866,15154,13417,40315,14678,25988,4910,1287,8968,24825,8224,20025,11394,33870,38767,5665,264,29451,33749,31429,869,20141,37702,2758,16672,20354,39807,13696,15472,20540,1838,19786,2990,17969,22583,36027,33736,6240,31668,826,29944,274,19823,3686,17911,13813,30164,4336,2270,34465,16186,39681,31366,33232,29385,23094,10541,619,26694,11018,32569,35708,13278,26205,5198,11073,36739,8437,43,10848,30477,8998,12986,40177,28790,13970,10342,15191,22821,15100,10248,50,10494,13529,33733,3578,3822,32586,29038,15570,7336,10332,12246,11619,597,38206,11802,27253,16450,28171,28608,29973,30254,2274,37806,40426,2405,31372,32449,11150,5385,26814,9919,8498,28791,28511,3636,31386,38449,10220,33086,16581,19635,14365,40423,493,3526,29355,1368,26003,40827,17634,4503,22445,16626,6844,8193,19825,23810,18838,31374,26677,21719,6669,12957,28098,5378,6949,37530,327,21116,4100,28824,16832,28077,9370,18337,23168,11079,126,8039,33366,28017,38052,24755,38148,25661,22852,21108,10655,7993,19856,22141,39782,11425,34070,9939,12591,9626,7929,37836,26085,35099,499,39314,13158,31960,27815,144,4893,25856,32038,2527,3090,25922,8680,20265,40892,6818,14918,16841,20123,10986,40487,27234,39607,15657,7199,32468,702,17899,3165,18125,12551,9423,5298,25937,21990,19437,2517,31028,33694,5105,10473,31348,17260,26153,8849,28092,22680,33179,17181,4857,8873,25574,27576,31228,33663,18260,9458,9826,7898,25746,30007,8450,29411,33546,28798,12318,34546,13525,13264,5554,26583,23290,35303,38868,40671,29249,11646,25538,36593,2409,7614,11808,32577,31181,5612,16135,35388,11654,5157,39372,37316,37823,896,27197,34083,40872,16603,21294,11855,14083,16864,24793,17252,9728,16515,32584,8057,29625,31249,11680,14574,30954,22646,4714,18521,9000,39566,14302,6385,37524,35964,18299,3103,27012,6463,38047,22161,27473,33221,21114,15979,22724,38258,40581,4155,36447,22409,8123,25980,29446,8953,4551,24076,11591,31177,22689,20855,18797,35385,30535,33156,16711,13999,5345,18628,8519,8715,5647,27183,26335,33807,25993,17066,6736,10425,9145,18039,12698,30391,17403,40926,25423,2818,21444,22072,13709,26343,4250,30062,3057,9152,4066,16983,15531,18278,40063,8741,20808,31182,20938,37306,27532,30959,15282,2137,40542,10510,24029,8359,4533,8104,6661,25797,17253,30709,3152,38834,10710,388,9801,13022,39462,35254,13174,29498,12483,17112,5331,19859,1454,6738,22668,2221,28680,11939,5249,15366,18589,1010,10807,18191,38046,7620,27795,4908,20812,7424,14690,36636,34372,38091,12592,4602,17211,34402,944,4769,37515,27978,39322,6603,24294,11390,23619,26855,8286,20425,5724,40893,3751,24200,20287,33106,6217,470,23485,3528,34289,19057,17570,11613,18999,23475,22171,25441,3158,3197,32526,24860,23762,17207,33173,11857,7949,35428,35806,40736,34699,561,40669,13972,34043,5578,35108,8485,27701,30728,34678,22888,9658,22670,28813,20725,7897,16594,17794,32878,9156,14146,24599,22607,11304,35932,14957,27788,14045,37760,16806,2720,13804,15064,37209,2220,31747,2657,217,1400,7105,10163,24573,13190,15738,38112,34805,26350,603,2569,25094,11266,18262,38540,35920,19009,27861,22511,34136,6178,17017,39757,3135,37403,16760,30171,4667,31431,23317,18300,31966,33139,27889,20049,27897,13494,25473,33531,25266,13697,17287,33571,11586,40394,18627,21075,34543,25981,26379,18235,27892,22711,20024,18196,16716,4782,38605,25761,10029,10529,25786,38193,15871,5937,18866,14689,605,31651,3953,12290,10525,13729,1065,2907,24553,9097,34903,17733,16570,11768,35146,28550,6898,31290,5193,20290,39773,10834,32454,1933,9873,35949,11429,10312,12032,12881,21338,37244,29096,39728,13199,24374,27506,21542,779,22203,32690,33846,30453,28663,22697,14300,11131,18960,14007,17695,2760,32341,30746,29232,9085,5760,28106,21449,40244,19158,7392,5408,2869,19831,20490,35737,6257,8656,16245,37419,8649,14839,31631,36263,31455,16629,5338,39724,25467,28207,14597,36036,31327,39587,15621,16216,33143,26198,7027,22873,14702,6323,22599,22917,2637,5121,25372,39486,18115,30985,8421,17332,10134,21777,3560,32217,29354,22894,19212,7672,22551,21286,26523,23128,10876,38456,10503,21515,1666,17355,17909,25692,11600,39163,36792,851,11487,34470,10753,11236,28350,5846,37102,2851,21637,2176,22451,821,21575,1776,35878,22702,6666,16580,21452,15517,6043,9918,22825,32303,11358,1926,11702,6788,30353,8198,22181,7007,14056,33867,22019,27103,25929,28545,9331,19239,18788,27399,32614,34677,21358,376,32320,19567,36837,40781,11922,10850,24343,27562,29003,39128,10154,25870,34213,19888,35394,30150,26373,12911,11250,28977,18212,7827,38698,26361,12160,30884,21565,20210,26791,28821,40792,231,5912,30214,28405,27342,24101,31286,17461,24123,5944,3994,38702,2603,33765,18319,14119,7847,6137,25059,27844,21080,10129,30994,11883,17205,35048,37167,3274,10552,16558,1120,5684,32707,8632,13408,2508,13538,26321,35038,20118,33337,33732,29998,35501,29519,28736,7015,30481,26201,25793,17097,34542,11440,6896,2208,27590,14156,36353,7268,32789,39770,1058,24003,30677,8967,39583,33392,30197,33618,34415,7978,26152,35269,29654,2367,31469,15398,26010,18497,686,21603,22251,852,8420,2791,2198,11538,3258,23662,31129,27739,484,33513,20889,21134,23285,3559,14838,17771,15434,475,16327,951,32475,20567,24729,28731,30095,25032,13256,33991,36309,22840,15740,26233,31754,22522,2004,16893,4834,2118,27077,9525,32979,17212,26015,9280,6135,36938,7155,40876,14929,30250,30838,15291,2848,1197,16173,14492,36682,39781,9887,34718,18494,12289,37282,39688,12996,21743,35850,25164,33497,12626,25844,21390,16392,4013,22298,28903,35064,24057,36387,10130,20689,21165,11326,28146,22006,1914,33868,485,28062,37021,28847,23587,36758,38950,1762,20617,11445,38163,40592,262,15666,15185,24386,38410,366,38037,32553,7857,28610,18094,36271,2775,8963,34042,17255,18830,3400,40434,14130,3954,38499,40933,7316,6239,34735,32505,40596,17465,11833,27453,12653,31422,9959,16684,9222,31749,31075,20784,40657,3324,4581,9735,38492,21068,20902,5362,32621,13581,4410,21845,33989,39584,4276,39479,24428,34717,21561,3007,34963,30012,33524,36584,31849,11243,6881,29859,24621,14821,10703,21484,21601,11193,37348,16330,2296,2921,11752,37501,38016,21961,26458,20066,2253,33034,22236,28503,25030,22745,38629,6096,16074,8568,18906,22875,20950,6993,16033,26802,24586,38379,13521,37022,11031,39456,28203,39252,39602,22944,1750,9969,40153,6679,36968,20485,10994,33932,12457,7695,2347,7214,34563,30074,20382,21827,27826,5108,11214,37994,6447,27059,6192,5594,5861,25921,26739,9987,8699,4591,14652,16571,9344,3467,1116,7200,36540,23009,24154,23700,17875,22830,3450,30186,32359,13212,2101,34696,4046,12890,20087,33137,34023,1485,23452,15207,14710,40729,37212,4882,18632,11858,3102,8121,38142,10882,35662,35843,8843,9484,32052,13874,6921,38045,12908,11926,1131,20510,4450,30031,16212,8137,33148,16981,21665,40675,34017,37122,18406,2472,32884,28491,28877,9246,12146,32115,14500,18233,22563,31934,37134,17592,38429,6127,9590,16946,13595,7109,28910,38528,19024,18351,38858,18144,10708,12267,20270,31675,1113,4538,8694,13808,8438,18763,4084,32955,34307,35029,6760,31721,38542,10820,34431,35829,571,28789,16053,30895,8598,10546,14608,32143,12,10648,29462,36804,3624,20738,8987,14377,11929,30715,7395,8070,38951,18744,21396,20441,22750,6714,11545,17667,30013,20539,4905,10504,39058,18113,31506,20922,39709,22313,11860,10450,29893,36942,37973,11113,16266,15092,39727,38285,2341,1890,19832,11672,10645,38287,8958,2298,16256,33526,28829,7615,34953,7485,22626,5914,7531,19518,23276,36534,21507,37013,25021,14759,34597,32936,36075,20009,3239,34110,39985,21451,8955,40597,10441,21115,984,12955,40146,27775,4758,2949,7798,10670,3281,30417,20219,27382,39814,33561,3406,4797,22255,18055,4587,15059,25960,28745,28118,32097,16369,38219,12709,26498,14627,21695,23060,8714,34527,39091,750,10124,35326,24426,3127,2997,18592,3672,2251,3952,6584,12087,39837,40316,22240,4745,29201,10015,13622,31067,33758,39415,17744,2165,36588,24640,31100,15660,18033,26492,12131,18805,39114,13189,5958,2763,4806,4580,37993,15206,17777,31447,3884,32986,5608,33538,26060,8249,14215,11109,24656,32224,7885,5946,32171,23891,5532,34369,1787,15493,38690,32916,7181,9332,10495,28070,34473,32136,32015,8350,6752,38276,1734,23079,35879,37243,15948,19647,21754,24072,23859,35010,39550,4110,10618,14329,24449,12390,11678,26453,27570,10063,21373,13686,11057,7912,23769,37072,35232,9285,31761,1426,31165,18722,6948,21042,1889,24079,2390,18062,37985,21761,25443,6911,4314,18583,23651,635,33037,409,15388,27926,8051,3053,16518,33895,14703,20864,32155,37001,27386,37945,33847,22812,37411,31271,22505,7776,32689,19305,21171,25596,477,13648,3726,29324,5104,36893,24412,6866,25851,294,40405,25482,8291,11208,32304,32677,5261,26014,7090,37814,23191,29379,8807,18501,40312,24882,38210,16606,37118,30702,6305,10287,27283,14818,19904,34599,30233,24601,39856,29868,37024,15561,34939,8716,26295,25621,24552,35517,35617,36874,763,35313,19117,18951,942,16648,38794,29623,38718,30454,21881,27534,14804,14909,13341,185,6059,37769,23912,27424,24486,17914,12288,7926,21792,3176,40448,36330,30771,24108,8918,35073,35656,30519,16647,25478,12562,18943,30152,34649,25312,27207,30982,20184,28704,33235,17456,33340,25837,1525,36798,6175,26218,11911,12565,21605,12363,33515,22586,38689,4854,6211,21446,10193,32273,32477,6292,26059,32919,4933,15978,5306,28976,15170,1393,20879,27111,12387,11076,38425,36283,13423,4736,10735,8399,25118,37598,6051,37877,7851,24771,25038,10329,30963,25940,24652,6322,11718,35515,28288,37063,9206,34709,23088,10673,35825,40862,35037,23185,24055,11063,13236,38500,14513,28310,38621,8605,30411,29732,30618,18167,8858,9119,8622,17132,32571,9551,23301,12778,5802,39439,28499,4341,1580,31888,4888,230,26589,9389,2436,24651,480,9169,39335,30661,22077,616,27758,24133,5066,22188,26872,38069,14375,11594,33839,10961,4650,19703,20089,33342,11626,34579,16964,32843,5764,38764,3003,6024,20366,11542,15005,19829,9010,3999,25800,8052,17594,32604,12150,10460,10667,15768,23771,4923,26476,10942,15098,21325,12055,27604,12925,9273,36042,1601,14293,32600,35908,32931,15581,14560,30512,31596,18860,34273,32167,39040,2141,28274,6677,3066,17138,31678,23353,24790,14590,22843,7314,37226,3651,25697,13835,18938,37616,18865,148,37124,36026,21036,28689,29095,25187,3917,21307,25796,19759,21427,20641,7802,27873,40077,7510,39396,17651,14825,33543,18902,5672,12401,12619,4191,32324,28873,33004,36852,13130,35914,13685,16347,5044,13310,40946,21474,7731,5442,36431,19484,30568,7673,36290,26745,15311,23430,22993,12438,18143,21418,12655,28825,31373,37359,12437,14667,29881,25691,8511,5646,12642,17053,30740,27800,36652,26261,22759,39556,9434,25349,32731,14149,34467,10052,17284,13054,4940,4590,17721,38059,32809,15974,29064,24738,36717,31711,11674,30228,33818,34407,14533,35514,13747,27781,6139,14373,14771,209,7955,39741,37054,22157,26672,2811,36634,40506,19527,29702,3998,26434,39731,39697,11665,23359,14607,27882,184,9126,28487,40577,27913,40280,10141,6915,32721,40104,31468,6712,30090,40064,23282,19935,34799,15833,26833,9298,30918,40170,8110,22648,39089,6884,32521,32575,71,28009,3646,7010,21442,20752,36106,26488,5725,13694,13033,11981,8588,39488,3710,21717,18548,8113,3453,4774,30800,33427,18781,12301,33115,19575,2086,28412,6246,13266,15557,28619,26080,9473,36011,167,11648,34537,20657,39804,11034,33469,15088,19235,14427,31232,9905,31317,17060,25138,36655,36704,31995,13891,10340,11588,28515,37191,27209,17891,9720,8368,24918,37241,16961,1083,18879,23468,2097,40339,7879,29461,22263,1366,37882,8685,5822,2922,12245,33753,7671,25618,12004,35078,22826,35968,20640,16476,37588,22819,26979,19471,5379,9890,37380,34281,25612,11194,33901,30690,34156,21786,38813,8859,37335,20511,13410,12953,10895,9211,35642,6436,30952,17814,36971,18505,8396,13937,23850,21658,20810,33929,27305,27917,17587,6308,12949,3383,39003,24880,12528,38602,23099,17897,15044,21249,12886,6003,1732,27282,277,10622,31532,30515,29063,35876,34581,40266,11372,20848,39368,40380,30606,14010,20357,29343,26787,12037,3664,6327,2501,30101,30356,26548,18004,38121,33209,12292,25129,17959,15444,25694,11173,16766,35495,13845,37791,14633,27019,3168,25724,36339,8499,10428,36887,1853,33096,36220,39443,27113,508,21820,714,22056,32627,35880,10823,25230,22714,36183,33919,11367,9912,31640,3288,33071,3271,10127,1912,34280,11071,27240,3970,30388,25601,7743,30135,24932,31362,3609,7428,33601,9333,22179,18886,36453,27733,21415,9993,31258,19322,516,7293,38036,26054,32949,31553,17792,3796,1221,18448,28086,17356,93,600,3045,39465,36147,1975,4903,22383,20768,22996,6110,1101,24069,16545,7164,7901,18741,40309,33556,10364,15608,31988,35360,27288,3101,34541,28860,7815,20739,10917,23659,35041,37106,20054,17804,14444,2671,7983,10817,40718,28383,35128,30815,8536,34505,5916,1351,24572,16416,25309,39353,6803,13075,23574,35668,206,16394,33095,39954,21251,7839,33397,14862,39067,32601,9488,23575,1466,40750,3924,7626,8239,18200,38140,9236,30518,15239,32250,10065,1512,14546,31743,8516,6053,10333,7205,21205,28458,7530,4977,13994,33467,19926,26813,14217,40191,37346,28209,33590,13226,3461,26293,11578,5988,21197,35013,14871,6092,1728,17755,23545,15807,30324,37080,24337,22238,38375,40133,40855,15172,38248,36671,8949,35273,40081,24713,24040,4466,20967,8424,9983,37980,12695,27729,31154,22615,24517,18114,28439,30204,3687,35679,20299,2793,7527,2315,27109,24266,9416,26394,29499,1367,17323,24554,20161,3224,6087,35307,14315,31574,35990,12854,22225,32396,19478,25244,33903,17888,24933,4942,39417,36285,25687,32269,33714,14026,15845,37481,23300,16869,19729,29506,28908,9446,18813,22275,5523,26383,29776,15046,16965,20923,21893,38182,3305,10752,39637,40347,39893,35392,9762,19377,5152,38524,10789,2219,34814,34336,22359,14762,27812,6339,17277,11044,2799,25986,15607,17447,26078,24221,7780,35659,40678,21958,14783,37236,37417,36595,5993,20166,1988,30003,7602,27904,26922,8525,36401,8899,27754,23142,15554,25033,25664,25514,13651,2185,16209,5475,26502,4494,20759,15010,38732,29223,36688,4144,23179,18731,20306,22658,26803,39469,29293,37035,25189,40948,39871,2217,27818,11663,29493,37004,4031,40541,18349,33816,11562,19098,664,29389,10039,33056,36684,27902,7831,39952,22528,14531,30185,22970,3930,5535,5490,38062,2696,2859,19540,25644,35933,3237,1621,18386,13435,15326,38971,22837,2231,40820,37824,15437,5637,4656,35690,33381,22973,13438,35205,26288,26913,539,23011,33503,17448,39895,26250,26652,16472,20385,22027,20548,18263,12120,6801,13487,5981,9518,5852,17935,3978,7166,12436,30022,2854,6521,28221,14263,1727,3214,11328,16267,40570,8048,21293,38275,4801,13797,37662,35533,17510,40295,27727,40145,4051,3673,38639,28623,33643,5640,36054,1375,1858,23879,6035,16473,23183,35934,20286,18565,37896,38364,21663,11593,39378,1679,29427,19401,13466,15526,20062,38261,6778,6732,37457,3820,39867,25975,11686,19898,4724,87,6526,28890,33974,26274,18068,2934,12842,35284,8723,25887,27950,5908,8461,25518,12765,21574,15640,5768,4696,2549,37828,32640,1804,16924,36898,26640,12315,31884,2604,16800,3338,40034,8149,35397,25012,6773,8050,29473,7236,30828,14401,12309,14339,11909,21430,23303,6644,24366,22,33175,40360,26513,37620,39226,37276,34364,15043,8523,34038,14795,14943,29019,6980,35783,7076,39045,18949,33723,16465,520,2639,34203,16149,34157,18719,7134,4906,25045,29821,14015,7016,26766,35483,13547,36748,16423,12689,22405,38426,3465,22705,7745,26608,30283,21587,12424,7260,11163,6475,24597,3417,904,12780,34884,7909,27242,9226,7991,34996,18333,12142,14912,854,6831,21355,38675,26705,7125,20799,23196,36554,21778,14265,861,21501,31689,10290,37318,21464,26165,35505,5761,2384,12738,9348,20670,23631,37503,37748,16268,26598,7756,10689,22715,4240,7535,33120,19443,303,23096,27098,28159,9584,11622,32357,25091,6782,23935,34428,33167,114,19234,34123,21950,31096,39418,21866,14224,10923,25546,8811,35704,23095,26117,18877,10796,11320,22822,7275,24473,23608,30748,29067,27649,2402,28710,12580,34915,25422,29238,31644,20491,17737,23261,12575,3171,19130,3179,39686,15558,1759,17955,24560,28962,25739,10142,24846,9666,31549,31770,7629,10901,3153,12414,19992,3455,10103,21577,16317,19385,31894,10212,14961,4030,6153,11949,12512,29191,35614,34212,13878,26112,23646,9852,13134,21312,20926,26658,39031,35116,11658,22360,31555,37094,28134,18987,13413,23112,17541,40495,36548,16454,20406,2162,4828,37755,18462,38509,24421,14852,30050,26063,20651,1100,22719,6514,10530,4512,19191,29999,32434,38801,20181,7317,5389,3056,20348,18965,39926,23713,946,33851,15118,34112,29749,32049,12117,20036,13739,12002,13805,29605,23037,1959,13014,37715,34765,18164,38933,2772,29983,34880,13172,416,2485,6783,4727,2749,30367,6967,13853,31236,36531,15023,5584,12242,32683,13981,6440,7194,39626,3279,19713,1655,10966,36394,39288,3741,34852,13440,27247,23835,21662,38013,30096,39573,29125,10846,36611,31395,36135,32288,16402,26540,17144,2258,38084,27685,22789,359,4894,14397,830,26496,3392,6028,26626,5294,24819,26669,12696,1309,40436,25682,24425,32055,34676,34767,3370,13814,27097,13618,28160,28404,8979,20932,25393,17159,8232,13470,21246,10224,19118,33492,26376,15573,39096,38178,4899,5180,5808,33507,4902,7842,33654,1747,14212,8447,21364,5700,32080,11412,21051,1038,10021,17084,33452,13657,36189,39243,26098,28314,25036,28069,12399,24498,24048,38872,17047,25416,38197,32378,27099,1739,25453,29438,32659,33646,3938,39941,15304,35312,1407,19648,34176,14364,30232,10060,30574,26801,36722,7006,17123,24585,37774,25685,33069,15150,20590,15241,33315,28629,23401,10914,32860,7195,21810,19148,11158,1957,27034,39638,2502,8214,13029,10064,18306,22968,37767,5820,9056,34642,18476,37278,31486,16829,21144,1638,14457,7385,36533,3144,24148,18376,5905,10349,4392,5873,21987,12362,15632,12323,25642,33300,25634,39855,2255,21155,40800,34637,5716,6487,11417,40625,5870,33907,7210,21411,36581,4775,19113,1748,28953,8415,37586,36364,28742,12339,4251,3642,37313,39888,14011,34898,11333,7050,5058,23383,22803,40089,11959,16374,39219,24437,10351,23177,6409,6994,12966,36084,9946,32456,33639,29398,13539,12033,650,30620,8725,14008,5553,12042,13446,11433,38566,32116,27552,35052,18141,40402,5621,17766,30769,35987,27036,27759,21066,14348,13633,27174,12977,32191,29044,20894,22067,28734,5634,1994,28552,34897,8305,9977,39369,34654,9489,22901,10748,20453,24653,29562,21000,37706,31265,39187,34006,54,9045,38535,26601,10418,28164,4646,5146,33200,39779,16158,6224,20335,11685,5357,36403,37981,33343,26167,29371,24325,34141,37922,22466,14131,11980,35008,30206,643,13392,4478,28870,30342,3121,38634,9695,28194,439,34544,19659,35661,25212,6742,7591,31797,36239,28995,39627,17820,35658,18640,12676,38177,36934,17623,18779,19413,37224,15530,7133,7701,18334,20506,24194,31886,15975,2644,1130,5969,32013,20229,13572,354,12439,32684,30700,15722,29127,39928,14214,37529,39555,35854,16067,29664,25959,14204,18836,29030,22869,16731,10156,13991,24990,14559,35998,6299,10577,32563,33158,39508,40257,3386,19232,11765,23483,15407,15725,12923,5613,24321,38435,11451,13356,13495,22406,1852,19334,20351,8047,26811,2074,10738,40159,12003,11933,6957,3562,20338,6852,17780,28792,2091,21254,3669,11452,17067 };

// 12^(-1) = 23894 invphi[i]= 23894^(bitrev[i]) mod Q
__device__ const uint64_t Dinvphi[N] = {1,26420,37894,31679,15869,23145,32406,40659,1710,39178,39399,20648,19808,9624,34988,16073,5956,26319,1554,13758,18737,17855,1904,3572,26432,30312,35836,14566,8768,16105,19921,4931,22664,14982,329,8448,17436,11714,18854,36920,6334,18595,30097,27808,36913,1011,4033,12299,20289,19734,34357,16180,12681,12001,20323,16872,223,34237,12396,19125,16141,249,17402,14576,36713,980,3018,25454,10294,27401,9233,13105,26978,37360,40655,25758,30471,37287,18445,3883,12810,20418,34290,7363,33408,11732,22086,22675,31926,16008,20709,15703,28046,31791,1018,25144,22639,9858,36043,35693,30321,6543,27924,3509,4545,22209,28186,3140,33245,6177,30475,20084,35233,17135,36468,40879,35788,16197,13684,9494,35760,13735,17638,23624,1746,7234,10909,14184,11210,20170,26170,30681,38828,8476,29112,14343,40313,1538,21288,34430,39060,34727,13905,31852,330,34868,11915,9015,34723,19104,3159,23223,31807,26025,17033,14314,23841,21923,35999,20121,23318,8120,1600,248,32629,33935,35541,3256,18727,40382,32574,14470,6708,28074,29947,38025,24218,28740,26648,2492,19340,15286,36709,18183,1209,33161,19448,1376,15873,5942,20138,3531,17563,8252,38955,5014,8603,39632,34444,20904,8317,20336,10464,13091,6131,21226,38283,27848,31795,36673,12876,2815,38218,30910,15776,23745,14203,40500,21903,21213,19985,16410,24622,11599,29795,36363,2726,11482,4032,26840,4078,13330,34927,1932,32867,13901,13272,20080,10010,19984,15968,17221,15500,22883,11446,29218,39656,11062,25254,37912,3233,12175,34263,31321,21305,32999,2857,31778,3235,24054,34867,14211,12082,38328,11111,26094,2115,7496,24315,10937,15876,3280,17477,29948,15990,25007,36543,15290,32876,5915,25101,9830,21913,39647,23005,12782,19468,38244,32668,40290,38811,9907,6076,1761,2163,5865,32437,40459,9990,24077,26827,21157,12240,34666,5858,17702,15393,22252,20093,2500,21074,33168,22696,241,25068,39112,33712,15056,31821,27256,28881,14512,20616,16303,40921,8186,40758,2631,28505,34115,26900,24650,13522,30359,21519,34261,19997,5762,28779,23098,7526,12226,19762,23134,33396,22380,17929,11176,7706,16350,195,31775,2204,24099,39858,22972,35543,15135,27801,30729,428,2524,39037,521,33367,34459,24950,34588,19504,6300,25253,11492,7660,29860,18394,8176,9586,257,9736,31001,32041,23194,36653,13259,36429,34524,13865,40038,9208,7981,22154,16951,32870,11239,33692,19149,16656,7497,35376,26783,707,724,2564,32347,37030,20076,13843,32252,21101,9210,1613,16020,36555,4642,37033,17414,16940,14914,24529,12199,34778,38569,39279,4245,7973,25198,526,11141,35969,5780,32011,8853,7697,24336,27798,33391,38952,7676,17453,10283,13389,39145,19820,39937,5334,18440,25022,11661,266,23389,3398,29609,2171,12420,18186,1590,4289,17254,35079,3594,25920,20402,8661,15474,27778,37484,3754,14099,27761,38915,14932,8049,26581,34636,29424,24222,38472,23986,15017,894,7357,11995,5592,35274,9383,2888,17922,31041,5443,30950,18407,23948,29179,23160,7792,35615,30983,6236,4659,2975,14344,38269,40027,23203,18357,13700,20456,8086,33562,25273,339,26882,13146,9001,27803,1647,40462,5862,14876,3125,33032,31335,28370,31022,6891,29536,1179,18820,21105,32968,30306,19853,18109,15300,2813,16206,2909,12944,7595,32922,40835,29882,17793,22624,31591,12884,24129,12137,36861,19845,40634,3431,34012,35583,12863,28004,34292,19242,14284,9587,22123,17151,21136,32768,34117,24335,18516,36458,23327,134,14958,39593,11606,37435,40468,538,26596,21326,24380,7875,30741,2512,9575,37325,12450,12170,32463,31042,14147,35576,29811,8512,9589,38556,535,3155,38687,10707,10988,12353,12790,24511,13708,29159,2755,40364,29342,28715,30629,33625,25391,11923,8375,37139,37383,7228,27432,30467,40911,30713,25861,18140,25770,30619,26991,12171,784,27975,31963,10484,30113,40918,32524,4222,29888,35763,14756,27683,5253,8392,29943,14267,40342,30420,17867,11576,7729,9595,1280,24775,6496,38691,36625,10797,27148,23050,37275,21138,40687,11017,40135,9293,34721,7225,4934,18378,22992,37971,21175,39123,20421,25489,27265,1154,20607,24289,38203,3259,20820,40092,9532,7212,11510,40697,35296,2194,7091,29567,20936,32737,16136,31993,39674,36051,14973,26283,646,27544,25807,25095,11124,905,3205,9713,27002,16064,8008,7795,1717,19313,17930,37596,10373,25570,12706,17125,27839,10664,21472,21351,11026,33249,17044,18207,27163,9740,5753,28950,12400,1922,21969,3610,39917,25234,6990,23612,15988,13128,36082,1087,1138,586,32400,5022,18493,2252,12954,15525,20813,18996,24728,26771,31164,36780,22986,2334,19363,8531,7129,9502,179,18665,24461,17923,14242,5894,25173,27864,37846,33310,9792,35925,7992,35646,24175,39588,39241,24310,32232,31211,26307,4692,9601,27908,2393,20237,33649,29997,3670,6713,8385,14612,36891,34186,30546,11698,8667,10150,2000,310,18404,26610,40151,22403,1146,7141,7864,12688,12792,36390,7574,10595,34493,4732,12232,28111,2588,11051,9038,22291,26050,14278,19561,37644,1692,14189,12683,23880,20893,2624,25134,21509,2117,19375,19960,11286,6653,8609,34788,16042,15502,34762,11087,6429,30433,16391,12108,28911,33825,10363,12938,2415,15981,32993,16590,25100,3818,25578,5040,33550,6523,14733,23888,34833,14357,13080,156,25420,6151,17133,17904,6052,14831,2094,20994,8579,32194,10315,17973,26748,24685,37619,27994,9664,16222,10297,14741,32,21520,19720,27292,18157,9023,35601,16095,13759,20583,4624,33801,31659,8613,17105,3774,10006,11431,1567,3739,27409,23231,3396,22663,29523,37036,14752,36402,17521,15856,7373,31316,38442,5854,34905,27661,18419,38539,32803,14333,34376,29244,20098,13242,5739,25867,12816,7368,15888,34820,1301,33348,24011,35651,1225,24253,11337,11092,15646,19427,20010,9531,21753,14577,9018,2377,7127,799,14665,36493,5042,22382,19444,15151,18528,22618,28492,31110,2774,24760,12030,20858,20027,9596,18691,30722,33025,26887,8878,2273,3834,33040,37890,24557,14661,10960,9891,36496,2380,13181,32559,7445,2178,22423,37678,6201,27381,28398,33484,15347,35762,35901,11504,35772,3087,21795,35123,28330,39208,31132,10560,27295,15495,10519,32556,22741,1272,9936,31032,19871,35644,5611,4761,15121,4187,32706,20225,8818,26353,30415,32363,10066,24908,12172,40390,5132,6530,30141,2419,9240,34201,5932,6654,8006,36877,22198,32523,27153,32267,36423,39848,9286,20691,28694,30253,22817,2103,22610,21937,2433,12051,33852,27366,24015,31371,34834,2532,23369,3827,9027,18398,22728,26461,8846,28815,31715,12084,12470,8077,38489,22555,3839,6944,286,19296,23980,7813,32824,24749,10930,36511,20451,39830,29035,28053,2916,34040,27087,8909,31477,32118,5118,5299,30079,2819,32840,37859,29103,22329,36079,3749,232,26251,25754,17509,39476,6938,7824,20874,28071,36915,6265,38860,27749,8602,10775,37511,18131,23086,17261,16807,17952,4421,33761,39845,37494,31617,24390,26309,36370,32262,30974,14222,15040,35100,35367,34769,13902,34514,2967,29747,35853,13135,19134,20579,10887,6398,33747,38614,33266,28504,7029,29967,20476,3993,34282,808,30992,39211,18017,1359,1709,12758,1505,29930,3939,27440,2582,16375,14159,24928,33968,20011,18086,22055,32393,24887,34865,2332,18216,15931,12458,18725,7927,38708,20895,14503,19000,2945,3460,29209,38040,38665,24631,3613,29768,19360,19477,30258,26140,16340,11102,34080,29718,9112,4377,7437,10949,5998,37954,19400,6244,16533,1482,36685,1377,6972,19116,36551,27380,8340,35599,20059,19893,2469,31226,36380,37637,304,20177,9886,9212,31739,24277,31002,9539,28308,13508,29128,23496,365,8456,6226,34722,33645,28,2462,37007,26831,527,37561,22131,23706,6919,31998,38186,4690,22867,12351,33104,8408,2924,40595,2551,16575,25776,25295,40699,369,2798,29516,20344,39199,2011,4203,17374,12114,3940,12899,40476,7093,39047,18955,12815,29635,19796,20272,30831,4574,16904,5897,12058,18663,36948,24569,19571,15117,28335,7464,15797,5111,19218,27965,1273,3679,28672,22467,6243,31074,1180,4279,26469,24788,39764,38113,25670,10123,10711,26032,85,33806,4023,34826,31681,14946,23749,7982,31436,13884,38843,36127,24068,38957,18439,9207,14728,25221,18121,4652,6970,27705,15929,10866,12230,16232,20394,8486,40010,24634,40486,25527,23190,26123,37402,17676,19827,20072,7448,40477,13222,9832,17299,37703,29423,38763,38170,32541,40109,18710,19358,40275,22464,14951,25563,9492,38594,11307,5692,14809,32983,6546,7343,10764,7569,1378,31994,10284,16958,39903,1191,8172,33693,4608,26805,13371,38753,34065,29521,6419,23864,15168,14760,10480,33946,12225,11442,5460,10963,7229,7624,20843,5923,14640,27423,38453,27553,32329,8254,35277,39841,24403,30409,37687,3794,5913,23756,29078,9967,30832,19881,13117,15902,34824,33114,26842,22642,7196,38358,2259,36967,35017,16838,23500,9675,16860,13619,12556,10747,35049,40730,169,12140,14170,20751,19396,10077,28801,14600,2263,33134,22749,11984,29711,28050,14588,10811,5567,21073,6748,15091,30807,1833,11958,13399,16618,30111,29039,180,4124,21394,8641,40585,19603,6284,8347,13562,22173,21722,31630,12416,15032,13858,18942,7094,26905,33954,18780,32763,10608,34173,29259,39035,29603,8658,18136,31043,34918,25444,19509,24381,34295,18259,5083,39185,19386,40140,18510,38785,19324,38110,3859,35115,12611,29725,30208,6491,29474,40110,4169,1798,29361,15269,23052,23606,39295,19446,30458,2505,30085,17833,14438,19675,18410,33289,21749,18067,11607,8744,37401,19184,30827,23629,32540,9976,22846,1475,15589,35840,38324,18044,18362,34638,26259,18088,33934,14763,7818,24745,25340,1374,9634,4925,26364,12754,15494,1237,35623,24332,9506,4698,9330,26122,32312,3542,24716,32305,34704,5224,20471,21130,38092,35553,33569,21803,717,19512,12855,35201,31876,11729,10215,8620,38201,23266,26954,22001,29830,26661,18264,12298,10508,7115,8271,18758,40182,19419,13455,16587,27762,1233,11865,3717,19623,28080,28929,30649,29532,5012,31088,39028,8507,30127,1188,20671,35768,9671,34063,12411,5815,29193,24391,23228,6058,31864,16408,38054,39896,27232,30436,28671,37008,9310,40356,26272,22095,35024,25090,2768,15175,30432,30932,15200,2356,36179,24245,22765,20937,18250,13069,22726,14582,14980,6418,19886,22334,567,29375,7390,23674,27264,15695,7430,15488,27467,13064,20912,13072,7822,8995,22661,17644,9530,36294,10790,24201,3558,37826,1204,23944,34783,6825,18450,13100,21952,5041,2421,22699,29695,15867,38392,40358,14611,6156,2849,25223,27771,16388,30798,33856,39561,40744,38304,9214,38741,3752,25897,27157,38241,24155,3201,26916,13173,26004,5029,29657,18354,16362,26815,31805,8083,23167,24367,33064,20236,12148,18291,31303,18073,6283,10233,13260,32476,5853,35383,6918,26989,292,40400,6262,225,5155,5533,33012,29104,7788,23754,17199,16101,8435,37764,37803,15520,18790,17486,21962,29348,23391,21904,6672,37433,17476,40491,34744,7855,20674,16761,37210,68,35237,20536,32675,14106,17342,29571,16667,34358,1639,12983,3446,36192,40017,6559,23750,36359,28369,2870,6589,4325,26271,33537,20149,36053,13166,33341,2915,22770,30154,39951,22372,25595,35712,29022,12281,38740,18293,34223,39507,21102,35630,23849,28478,11463,27787,5707,1499,27939,31160,40573,30251,2127,37809,10252,23708,15164,34300,32857,36428,32602,16932,30451,419,38824,25679,10002,13429,3655,20023,9779,20153,32220,898,22683,25430,23978,36895,31809,37904,10899,36711,14618,27252,18889,19517,38143,15538,35,23558,10570,28263,22922,31816,30536,34225,23895,14968,7154,14626,13778,35314,32246,32442,22333,35616,26962,24250,7805,10426,5576,22164,20106,18272,9784,29370,16885,36410,32008,11515,14981,32838,18552,4514,36806,380,2703,18237,24982,19847,7740,13488,18800,2914,34498,13949,37858,22662,4997,3437,34576,26659,1395,31961,22440,36247,18315,10007,26387,29281,9712,11336,32904,8377,24446,31233,23709,16168,24097,26878,29106,19667,24358,89,6878,13764,40065,3138,3645,1589,35804,29307,5573,24826,35349,9780,8384,29153,33347,38552,4368,15423,29315,11712,290,2093,5658,17671,14378,35407,27697,27436,6415,28643,12163,7415,11550,32511,10954,15215,33063,31135,31503,22701,7298,9733,13385,15387,32088,36104,23780,7782,18281,12869,32112,14808,23701,9613,30488,35856,7267,9933,38444,21524,18971,15024,35663,31538,28410,22836,37796,23062,40259,8493,33762,25304,1354,13727,474,29975,20838,24120,26043,34143,69,20696,32281,15039,37871,38434,8923,15105,36068,40817,23894,29509,37292,19707,38870,12169,23181,34109,20623,37399,34004,29028,28958,802,30223,38887,14150,32914,20610,21627,39109,18555,27466,27605,29510,2526,16640,35348,28038,25236,25554,17478,29196,21729,37575,704,1453,7803,8398,30384,34662,4963,26402,15971,26970,30805,24230,18092,11931,22125,26757,15002,11297,24894,5107,1406,3432,26747,1033,11834,25239,10261,8277,28522,40607,27389,20732,8948,34992,39831,38317,24986,9075,16767,20455,22627,33260,33828,25431,3737,21548,22182,23338,4027,2784,28285,22321,5303,23141,1334,11966,4722,9164,33370,34219,15749,5300,21302,6417,40522,12767,31266,2327,37840,10619,12091,36483,27569,40318,10755,5953,28981,26830,18495,3039,6820,16636,11590,14794,7618,2980,4558,35604,29276,20626,34737,24803,1182,7761,35815,36315,12797,30543,14360,2426,31916,40907,6955,1774,9696,3255,19961,11399,16308,20508,30213,18060,31472,6307,1592,30984,32656,6064,12409,38967,35327,12227,18894,20067,11917,8770,27984,13787,27328,26613,19895,13202,13925,4974,10192,23195,35340,559,22820,5909,13409,8845,2395,29528,27515,28919,35408,26953,32236,10341,40311,28928,27422,11563,7322,8505,31015,4877,27995,33967,34552,17784,30610,16524,1742,24587,29002,872,18158,17578,35903,33911,29628,6063,26950,1073,3648,37319,36710,28622,12219,4597,3375,32546,12008,39213,21848,36186,4380,19550,33751,7054,35091,336,29544,34474,35245,6324,161,19806,38706,1106,15327,7661,15319,28638,25329,28599,18974,35088,36569,30612,35056,22585,16813,37817,4428,33576,26504,39323,19817,24132,9475,3683,22485,6319,31905,35141,3194,17993,22655,30897,27932,32747,38459,1323,13927,39004,29803,21813,19151,33766,8101,30047,17560,12332,7646,25720,20371,25811,7892,15276,3187,16376,23838,33955,4239,14160,10387,30901,10729,26597,6785,21313,39554,5649,25657,1020,37023,7315,8302,11523,15508,39222,13862,8583,2764,15545,23914,2089,16913,16463,28562,12892,15925,12647,14863,1718,4772,27304,7509,23877,30940,39923,19910,29549,8881,35261,19597,32514,26749,39214,7307,33119,36059,7454,35153,35781,36062,2783,1865,25388,14585,7469,21843,30737,19715,27491,32729,23802,15568,20029,31982,12557,12801,27343,13864,27147,37591,6194,6285,8906,16536,15279,525,39652,28265,14292,16142,35667,14335,34933,37569,14465,40131,26564,36067,40602,18172,13276,2877,38703,23817,14421,24559,8673,4826,9566,4350,30115,11836,1388,10865,2948,19299,17126,13714,27521,6109,37220,1673,4567,29995,39306,21248,37682,1335,33767,34521,26980,8278,28719,35377,25938,4430,9725,27108,33994,10594,38212,36234,34178,38476,40545,27789,6081,10978,38189,2028,22797,6196,3246,27947,39002,17924,11356,27156,28959,27222,20925,28844,8912,11212,6849,25843,7110,40015,17248,1035,21996,20613,37905,35572,33644,20780,2160,8527,10962,21770,36449,30431,34447,18242,39861,20310,14898,10911,26109,16540,2452,22499,3206,36133,38799,20555,24507,4413,466,23420,17849,27548,21974,12827,3867,9406,18601,29303,5845,1930,14303,20035,19649,27827,31109,17315,14849,27083,6749,5347,11770,28449,29012,34808,36931,26000,30749,9067,21576,24644,19384,30858,37506,20969,28547,37808,30060,33332,9191,9412,31295,16115,30819,15222,11999,16401,23006,39202,25403,1275,37782,21831,37790,28386,17700,23224,20470,9317,11723,15539,6046,28381,12251,38559,13312,11894,10213,17353,16488,33686,18139,29641,30165,22084,14844,17866,5257,32150,15415,30038,26737,19095,1543,9865,19011,6838,21727,40847,7794,6533,17026,34179,15870,8604,29339,31377,12802,13863,17865,40658,21518,7841,33426,36721,18246,30272,33205,14363,24693,3213,3458,17330,20291,31613,28223,38577,35200,5456,14796,19497,3643,30671,9272,19460,40100,26696,19183,4407,17765,20162,33836,14256,2286,19606,34130,40107,26049,28819,22628,5965,32970,31735,13719,33052,6077,28181,40057,37544,16364,34486,29798,33701,28537,19374,10678,14353,33216,18256,37496,2535,18556,28272,24538,4213,27414,5478,14195,33945,26946,11140,15916,36055,33827,22242,6804,24812,6758,38322,40441,24496,7238,22012,1916,33885,5178,33981,11942,26018,26166,6923,32438,25918,6597,3685,1735,3341,14448,601,7786,40939,16595,34317,17658,19531,29052,26622,28652,26560,10133,33725,11488,32911,34188,15949,5564,32812,927,37623,24161,38357,9077,28646,14321,4063,24037,39157,8321,3133,38412,36265,35193,25321,19387,28196,15443,32500,35053,13011,15074,32238,5677,28119,38027,22893,14687,6987,12071,34435,40874,36237,21063,29275,14986,1094,37141,3504,34229,34183,2700,20899,25435,27495,21560,11534,39282,1583,29368,19298,2597,3065,22396,20675,5027,17778,24488,34926,17082,39103,39586,4907,35321,7318,12338,2322,37288,36910,816,13234,666,23451,5428,3299,27164,36160,2686,19668,32913,391,24694,29633,37747,39234,26698,12740,34440,38107,10939,28525,33795,36983,23026,35109,31443,34980,27474,34160,28841,22698,20413,18934,20576,24489,14309,14711,1066,23513,7458,17950,40422,14048,14673,5756,27523,17988,7580,5271,36305,35324,25524,3137,141,38730,18124,1990,25635,27526,22575,39340,37724,5028,15317,21421,38102,38265,2899,35471,35426,37031,17991,10776,26430,18433,1009,33130,13059,4277,7905,30922,11572,40297,21863,29399,7145,22612,420,36930,3957,11468,29298,13143,38744,1090,13,15772,3926,11668,1492,14158,18303,20655,22230,17782,36817,4273,11738,2229,25951,20202,36467,14459,35486,24752,38776,27310,15447,15297,15928,25407,17819,13207,32062,4560,32436,14039,13057,33359,10958,38973,20795,34968,4366,3544,3725,26178,19003,283,5302,33181,16740,14883,23514,25354,14975,38162,29917,23684,34622,13149,26199,18602,6625,6147,38742,30172,2437,35809,21584,31199,5569,1068,614,1324,30209,37656,2779,19068,20038,23996,25915,11185,14578,35438,18686,22148,31515,12053,11455,21232,24092,17661,3480,25116,26935,7247,8692,15274,4676,1544,36019,16028,23073,7058,15717,21483,8565,18736,28107,4971,9387,26646,5654,34874,37737,20800,16407,23638,39594,11462,14567,31545,16695,13852,38646,33434,38168,20662,5282,37274,10757,12522,22847,16444,18346,9807,13232,28266,2981,30978,32537,19994,36495,16921,16248,880,5688,32012,4290,2713,25789,106,828,2586,18723,16624,3881,10637,25154,17416,23206,39233,34869,26090,5948,19764,34973,29383,14668,37500,27735,7371,12752,3615,770,26744,14148,21035,7494,26967,35984,33431,12503,19756,33756,30628,34908,32445,9218,26415,39449,30896,8711,25722,10443,31725,2821,22761,32722,33335,37037,211,39495,17386,31473,8360,1894,26099,7564,33122,19710,1007,7866,24567,40755,5293,17387,27886,34158,1608,15652,24545,16389,39610,35045,6456,32425,10146,5833,12578,243,30144,32978,38290,26517,23157,20907,3855,5920,17302,30044,20222,33146,12101,6420,37860,13673,5601,8973,25353,30597,7405,652,22220,33060,33797,24416,16892,39860,34851,17965,20193,18578,36058,38986,4814,1496,37916,40361,40868,23605,12875,22513,39740,37165,23169,9408,8012,14907,2925,33668,40445,21639,9703,30968,19546,13228,4508,22075,18782,31628,7360,33533,37352,9599,16029,10826,33218,15360,10573,36991,13721,29890,6681,39049,30834,37690,7890,37673,9321,31049,29594,7042,4778,18247,15731,30138,5081,8334,18905,40247,19141,40453,13848,1518,4741,7865,39108,4074,30533,32462,4622,15237,37793,13942,26328,3170,27116,5466,24195,29788,15267,25517,23002,15832,28669,7752,2840,22957,14413,10605,10860,38460,34634,37297,28924,14174,11618,20604,26951,10355,581,1593,20113,29589,695,6380,5085,11898,10446,9429,30339,40684,13679,39229,34958,28075,19712,25917,23064,17862,2359,28433,16081,1958,37578,28012,34653,23374,13044,13656,7032,20151,19303,17111,27024,32565,22456,3990,23147,10009,34525,5319,31750,30066,28008,27551,20450,3626,32102,2148,19175,6805,10271,7060,29767,15349,6680,3581,31071,35582,21490,13982,18142,3373,24485,20321,4993,18135,5883,28957,15343,33290,7208,28716,38039,35139,32276,3079,39595,18698,11500,33082,622,38864,17493,22082,39878,24000,3720,16043,32593,31241,23070,13752,3770,12446,29373,30621,27070,8966,4257,4306,15823,23901,9644,31056,9729,26534,21726,25873,7492,29927,1157,20304,6424,29313,40794,4950,31488,14881,12342,25404,27695,34715,12549,38875,21386,7846,28660,22180,7534,10161,36187,37508,32848,22413,19244,37251,1473,32373,28980,27928,27267,35236,14473,4855,20209,19519,33951,37315,12952,40890,8386,8440,34077,1872,18313,32851,791,10043,31663,14128,25128,6162,21026,17679,897,10871,34249,9493,857,8240,34046,30820,681,13048,384,12474,31835,40777,13079,26354,17602,29296,1264,1230,14527,36963,11259,21434,455,4327,38150,14289,18804,3907,1220,33006,40752,26190,26588,34822,13180,27214,5447,26428,6554,7143,10733,29287,9250,4244,16223,11897,24987,8152,2902,23240,36371,36021,27907,23677,30909,6494,26812,8230,15612,31527,1405,18202,14700,4309,13161,10221,23908,28319,35315,32450,15270,11080,26294,28524,3602,9588,12136,28306,19543,22818,28523,17968,17531,25650,14216,4671,33288,10393,21477,4530,35519,33230,19487,15,27651,35917,24614,27276,5047,27831,4109,7957,12088,8637,36770,28342,28560,35289,22059,7418,26136,23310,1565,33451,884,13088,33159,20320,19534,21202,15165,19654,37044,15774,11866,12272,19925,4935,3837,40813,22096,3345,22023,27126,15264,37310,3735,33647,18118,26371,16171,17608,9283,23823,37895,34284,12687,38820,1921,8794,6688,22101,9365,10449,26401,25380,8030,5053,8361,26668,39360,4919,31688,28036,13357,28906,19636,25863,30019,14485,36038,17190,25193,30294,30501,28811,8357,23367,32909,15161,36962,31951,21132,25956,29419,20595,34937,37958,2197,35197,8118,23997,6382,29335,7619,20872,21258,36311,30000,7122,29367,26586,2892,14089,18773,35895,16828,13203,40345,18884,10300,1626,31792,40481,16310,38525,31572,14372,40731,36073,9073,39381,36620,12462,1522,35159,28183,17660,31410,8390,23829,32339,31842,32103,22794,10343,11229,10550,32356,2340,12651,26448,2461,27725,29898,16906,17776,5924,99,5136,30288,17873,6252,31755,3898,12673,5446,29243,34639,16309,15021,9998,30632,15923,16190,33110,3084,34910,3363,15843,32562,30226,36225,27538,4678,2536,29885,28574,13850,20082,39568,25791,11985,35655,24983,36028,8042,14902,34669,8484,8688,30768,19515,34750,36107,2272,18375,7446,28598,19356,28396,29050,14743,34786,4163,39436,15124,7621,23505,7726,12257,20777,9979,13754,15649,6312,10809,22018,28399,15483,24314,10442,5305,5888,32043,16853,10190,4631,513,37785,19169,33035,28673,23047,16475,13537,17049,3192,34902,40776,27620,26052,26157,13427,19080,10507,2243,11338,2167,24313,40019,22010,21844,5648,40198,4087,5344,5444,16409,15340,14666,32245,6022,25400,3937,11093,1105,16360,10728,6362,21057,26143,13678,30674,34656,10259,3843,24355,2751,16079,649,22460,32154,11582,17770,3147,33871,14947,35700,8284,8657,29753,32670,15479,556,40667,15110,34095,16549,4068,35857,11637,37235,27313,40484,15365,19790,21656,8272,33185,18456,9690,3550,18149,7114,3016,13575,3960,8806,20097,26258,7066,24443,37908,32910,13035,25573,40552,7924,40326,17310,22378,36647,34050,15518,19200,2976,22899,38571,16882,39072,19919,34013,22239,9796,39535,9200,31676,5729,3889,17192,33049,29904,27275,19588,30898,13391,14508,29283,28571,16512,26632,30343,36851,1411,5951,17102,16889,19207,21314,25013,3718,5082,17882,39227,2685,34209,32611,8946,8825,6488,12891,30466,31629,33780,8045,2271,25468,39174,6592,35429,17070,8790,35015,33076,8737,16305,29852,26746,32712,14901,7423,35353,7975,37077,9514,23184,25755,2968,36381,36155,38198,35003,27772,1847,22156,28830,14469,22928,25301,9861,16321,4373,38796,23217,1546,7203,9894,27339,30946,11760,36216,18721,645,1124,28874,34377,37009,38710,37289,22369,37964,37834,16535,5635,30837,40211,1870,6434,32247,17901,19266,26334,14463,28252,2742,24592,8864,12843,12216,15001,25902,36374,22906,18706,36164,37555,7400,1147,13579,20742,10544,37680,30291,33163,38012,36203,13186,815,28006,39977,19846,30520,364,32006,19510,976,6851,37722,20952,4886,8025,6364,26202,15940,3948,19454,4427,17685,21443,33430,35047,18335,33476,6008,33346,12132,7435,24705,38663,32003,2674,30316,29289,21129,39071,38620,2676,1234,25869,24695,29848,2988,4019,11068,30511,29101,18648,1252,20039,9455,22848,1903,30457,36056,20422,10948,23294,29416,34247,18211,20520,19565,22217,2010,32891,33566,10246,29032,26584,31974,20223,37337,4157,11499,30313,40949 };

__device__ const  uint64_t KNTT1y[N/2] = {144, 40817, 4893, 36068, 25856, 15105, 32038, 8923, 2527, 38434, 3090, 37871, 25922, 15039, 8680, 32281, 20265, 20696, 40892, 69, 6818, 34143, 14918, 26043, 16841, 24120, 20123, 20838, 10986, 29975, 40487, 474, 27234, 13727, 39607, 1354, 15657, 25304, 7199, 33762, 32468, 8493, 702, 40259, 17899, 23062, 3165, 37796, 18125, 22836, 12551, 28410, 9423, 31538, 5298, 35663, 25937, 15024, 21990, 18971, 19437, 21524, 2517, 38444, 31028, 9933, 33694, 7267, 5105, 35856, 10473, 30488, 31348, 9613, 17260, 23701, 26153, 14808, 8849, 32112, 28092, 12869, 22680, 18281, 33179, 7782, 17181, 23780, 4857, 36104, 8873, 32088, 25574, 15387, 27576, 13385, 31228, 9733, 33663, 7298, 18260, 22701, 9458, 31503, 9826, 31135, 7898, 33063, 25746, 15215, 30007, 10954, 8450, 32511, 29411, 11550, 33546, 7415, 28798, 12163, 12318, 28643, 34546, 6415, 13525, 27436, 13264, 27697, 5554, 35407, 26583, 14378, 23290, 17671, 35303, 5658, 38868, 2093, 40671, 290, 29249, 11712, 11646, 29315, 25538, 15423, 36593, 4368, 2409, 38552, 7614, 33347, 11808, 29153, 32577, 8384, 31181, 9780, 5612, 35349, 16135, 24826, 35388, 5573, 11654, 29307, 5157, 35804, 39372, 1589, 37316, 3645, 37823, 3138, 896, 40065, 27197, 13764, 34083, 6878, 40872, 89, 16603, 24358, 21294, 19667, 11855, 29106, 14083, 26878, 16864, 24097, 24793, 16168, 17252, 23709, 9728, 31233, 16515, 24446, 32584, 8377, 8057, 32904, 29625, 11336, 31249, 9712, 11680, 29281, 14574, 26387, 30954, 10007, 22646, 18315, 4714, 36247, 18521, 22440, 9000, 31961, 39566, 1395, 14302, 26659, 6385, 34576, 37524, 3437, 35964, 4997, 18299, 22662, 3103, 37858, 27012, 13949, 6463, 34498, 38047, 2914, 22161, 18800, 27473, 13488, 33221, 7740, 21114, 19847, 15979, 24982, 22724, 18237, 38258, 2703, 40581, 380, 4155, 36806, 36447, 4514, 22409, 18552, 8123, 32838, 25980, 14981, 29446, 11515, 8953, 32008, 4551, 36410, 24076, 16885, 11591, 29370, 31177, 9784, 22689, 18272, 20855, 20106, 18797, 22164, 35385, 5576, 30535, 10426, 33156, 7805, 16711, 24250, 13999, 26962, 5345, 35616, 18628, 22333, 8519, 32442, 8715, 32246, 5647, 35314, 27183, 13778, 26335, 14626, 33807, 7154, 25993, 14968, 17066, 23895, 6736, 34225, 10425, 30536, 9145, 31816, 18039, 22922, 12698, 28263, 30391, 10570, 17403, 23558, 40926, 35, 25423, 15538, 2818, 38143, 21444, 19517, 22072, 18889, 13709, 27252, 26343, 14618, 4250, 36711, 30062, 10899, 3057, 37904, 9152, 31809, 4066, 36895, 16983, 23978, 15531, 25430, 18278, 22683, 40063, 898, 8741, 32220, 20808, 20153, 31182, 9779, 20938, 20023, 37306, 3655, 27532, 13429, 30959, 10002, 15282, 25679, 2137, 38824, 40542, 419, 10510, 30451, 24029, 16932, 8359, 32602, 4533, 36428, 8104, 32857, 6661, 34300, 25797, 15164, 17253, 23708, 30709, 10252, 3152, 37809, 38834, 2127, 10710, 30251, 388, 40573, 9801, 31160, 13022, 27939, 39462, 1499, 35254, 5707, 13174, 27787, 29498, 11463, 12483, 28478, 17112, 23849, 5331, 35630, 19859, 21102, 1454, 39507, 6738, 34223, 22668, 18293, 2221, 38740, 28680, 12281, 11939, 29022, 5249, 35712, 15366, 25595, 18589, 22372, 1010, 39951, 10807, 30154, 18191, 22770, 38046, 2915, 7620, 33341, 27795, 13166, 4908, 36053, 20812, 20149, 7424, 33537, 14690, 26271, 36636, 4325, 34372, 6589, 38091, 2870, 12592, 28369, 4602, 36359, 17211, 23750, 34402, 6559, 944, 40017, 4769, 36192, 37515, 3446, 27978, 12983, 39322, 1639, 6603, 34358, 24294, 16667, 11390, 29571, 23619, 17342, 26855, 14106, 8286, 32675, 20425, 20536, 5724, 35237, 40893, 68, 3751, 37210, 24200, 16761, 20287, 20674, 33106, 7855, 6217, 34744, 470, 40491, 23485, 17476, 3528, 37433, 34289, 6672, 19057, 21904, 17570, 23391, 11613, 29348, 18999, 21962, 23475, 17486, 22171, 18790, 25441, 15520, 3158, 37803, 3197, 37764, 32526, 8435, 24860, 16101, 23762, 17199, 17207, 23754, 33173, 7788, 11857, 29104, 7949, 33012, 35428, 5533, 35806, 5155, 40736, 225, 34699, 6262, 561, 40400, 40669, 292, 13972, 26989, 34043, 6918, 5578, 35383, 35108, 5853, 8485, 32476, 27701, 13260, 30728, 10233, 34678, 6283, 22888, 18073, 9658, 31303, 22670, 18291, 28813, 12148, 20725, 20236, 7897, 33064, 16594, 24367, 17794, 23167, 32878, 8083, 9156, 31805, 14146, 26815, 24599, 16362, 22607, 18354, 11304, 29657, 35932, 5029, 14957, 26004, 27788, 13173, 14045, 26916, 37760, 3201, 16806, 24155, 2720, 38241, 13804, 27157, 15064, 25897, 37209, 3752, 2220, 38741, 31747, 9214, 2657, 38304, 217, 40744, 1400, 39561, 7105, 33856, 10163, 30798, 24573, 16388, 13190, 27771, 15738, 25223, 38112, 2849, 34805, 6156, 26350, 14611, 603, 40358, 2569, 38392, 25094, 15867, 11266, 29695, 18262, 22699, 38540, 2421, 35920, 5041, 19009, 21952, 27861, 13100, 22511, 18450, 34136, 6825, 6178, 34783, 17017, 23944, 39757, 1204, 3135, 37826, 37403, 3558, 16760, 24201, 30171, 10790, 4667, 36294, 31431, 9530, 23317, 17644, 18300, 22661, 31966, 8995, 33139, 7822, 27889, 13072, 20049, 20912, 27897, 13064, 13494, 27467, 25473, 15488, 33531, 7430, 25266, 15695, 13697, 27264, 17287, 23674, 33571, 7390, 11586, 29375, 40394, 567, 18627, 22334, 21075, 19886, 34543, 6418, 25981, 14980, 26379, 14582, 18235, 22726, 27892, 13069, 22711, 18250, 20024, 20937, 18196, 22765, 16716, 24245, 4782, 36179, 38605, 2356, 25761, 15200, 10029, 30932, 10529, 30432, 25786, 15175, 38193, 2768, 15871, 25090, 5937, 35024, 18866, 22095, 14689, 26272, 605, 40356, 31651, 9310, 3953, 37008, 12290, 28671, 10525, 30436, 13729, 27232, 1065, 39896, 2907, 38054, 24553, 16408, 9097, 31864, 34903, 6058, 17733, 23228, 16570, 24391, 11768, 29193, 35146, 5815, 28550, 12411, 6898, 34063, 31290, 9671, 5193, 35768, 20290, 20671, 39773, 1188, 10834, 30127, 32454, 8507, 1933, 39028, 9873, 31088, 35949, 5012, 11429, 29532, 10312, 30649, 12032, 28929, 12881, 28080, 21338, 19623, 37244, 3717, 29096, 11865, 39728, 1233, 13199, 27762, 24374, 16587, 27506, 13455, 21542, 19419, 779, 40182, 22203, 18758, 32690, 8271, 33846, 7115, 30453, 10508, 28663, 12298, 22697, 18264, 14300, 26661, 11131, 29830, 18960, 22001, 14007, 26954, 17695, 23266, 2760, 38201, 32341, 8620, 30746, 10215, 29232, 11729, 9085, 31876, 5760, 35201, 28106, 12855, 21449, 19512, 40244, 717, 19158, 21803, 7392, 33569, 5408, 35553, 2869, 38092, 19831, 21130, 20490, 20471, 35737, 5224, 6257, 34704, 8656, 32305, 16245, 24716, 37419, 3542, 8649, 32312, 14839, 26122, 31631, 9330, 36263, 4698, 31455, 9506, 16629, 24332, 5338, 35623, 39724, 1237, 25467, 15494, 28207, 12754, 14597, 26364, 36036, 4925, 31327, 9634, 39587, 1374, 15621, 25340, 16216, 24745, 33143, 7818, 26198, 14763, 7027, 33934, 22873, 18088, 14702, 26259, 6323, 34638, 22599, 18362, 22917, 18044, 2637, 38324, 5121, 35840, 25372, 15589, 39486, 1475, 18115, 22846, 30985, 9976, 8421, 32540, 17332, 23629, 10134, 30827, 21777, 19184, 3560, 37401, 32217, 8744, 29354, 11607, 22894, 18067, 19212, 21749, 7672, 33289, 22551, 18410, 21286, 19675, 26523, 14438, 23128, 17833, 10876, 30085, 38456, 2505, 10503, 30458, 21515, 19446, 1666, 39295, 17355, 23606, 17909, 23052, 25692, 15269, 11600, 29361, 39163, 1798, 36792, 4169, 851, 40110, 11487, 29474, 34470, 6491, 10753, 30208, 11236, 29725, 28350, 12611, 5846, 35115, 37102, 3859, 2851, 38110, 21637, 19324, 2176, 38785, 22451, 18510, 821, 40140, 21575, 19386, 1776, 39185, 35878, 5083, 22702, 18259, 6666, 34295, 16580, 24381, 21452, 19509, 15517, 25444, 6043, 34918, 9918, 31043, 22825, 18136, 32303, 8658, 11358, 29603, 1926, 39035, 11702, 29259, 6788, 34173, 30353, 10608, 8198, 32763, 22181, 18780, 7007, 33954, 14056, 26905, 33867, 7094, 22019, 18942, 27103, 13858, 25929, 15032, 28545, 12416, 9331, 31630, 19239, 21722, 18788, 22173, 27399, 13562, 32614, 8347, 34677, 6284, 21358, 19603, 376, 40585, 32320, 8641, 19567, 21394, 36837, 4124, 40781, 180, 11922, 29039, 10850, 30111, 24343, 16618, 27562, 13399, 29003, 11958, 39128, 1833, 10154, 30807, 25870, 15091, 34213, 6748, 19888, 21073, 35394, 5567, 30150, 10811, 26373, 14588, 12911, 28050, 11250, 29711, 28977, 11984, 18212, 22749, 7827, 33134, 38698, 2263, 26361, 14600, 12160, 28801, 30884, 10077, 21565, 19396, 20210, 20751, 26791, 14170, 28821, 12140, 40792, 169, 231, 40730, 5912, 35049, 30214, 10747, 28405, 12556, 27342, 13619, 24101, 16860, 31286, 9675, 17461, 23500, 24123, 16838, 5944, 35017, 3994, 36967, 38702, 2259, 2603, 38358, 33765, 7196, 18319, 22642, 14119, 26842, 7847, 33114, 6137, 34824, 25059, 15902, 27844, 13117, 21080, 19881, 10129, 30832, 30994, 9967, 11883, 29078, 17205, 23756, 35048, 5913, 37167, 3794, 3274, 37687, 10552, 30409, 16558, 24403, 1120, 39841, 5684, 35277, 32707, 8254, 8632, 32329, 13408, 27553, 2508, 38453, 13538, 27423, 26321, 14640, 35038, 5923, 20118, 20843, 33337, 7624, 33732, 7229, 29998, 10963, 35501, 5460, 29519, 11442, 28736, 12225, 7015, 33946, 30481, 10480, 26201, 14760, 25793, 15168, 17097, 23864, 34542, 6419, 11440, 29521, 6896, 34065, 2208, 38753, 27590, 13371, 14156, 26805, 36353, 4608, 7268, 33693, 32789, 8172, 39770, 1191, 1058, 39903, 24003, 16958, 30677, 10284, 8967, 31994, 39583, 1378, 33392, 7569, 30197, 10764, 33618, 7343, 34415, 6546, 7978, 32983, 26152, 14809, 35269, 5692, 29654, 11307, 2367, 38594, 31469, 9492, 15398, 25563, 26010, 14951, 18497, 22464, 686, 40275, 21603, 19358, 22251, 18710, 852, 40109, 8420, 32541, 2791, 38170, 2198, 38763, 11538, 29423, 3258, 37703, 23662, 17299, 31129, 9832, 27739, 13222, 484, 40477, 33513, 7448, 20889, 20072, 21134, 19827, 23285, 17676, 3559, 37402, 14838, 26123, 17771, 23190, 15434, 25527, 475, 40486, 16327, 24634, 951, 40010, 32475, 8486, 20567, 20394, 24729, 16232, 28731, 12230, 30095, 10866, 25032, 15929, 13256, 27705, 33991, 6970, 36309, 4652, 22840, 18121, 15740, 25221, 26233, 14728, 31754, 9207, 22522, 18439, 2004, 38957, 16893, 24068, 4834, 36127, 2118, 38843, 27077, 13884, 9525, 31436, 32979, 7982, 17212, 23749, 26015, 14946, 9280, 31681, 6135, 34826, 36938, 4023, 7155, 33806, 40876, 85, 14929, 26032, 30250, 10711, 30838, 10123, 15291, 25670, 2848, 38113, 1197, 39764, 16173, 24788, 14492, 26469, 36682, 4279, 39781, 1180, 9887, 31074, 34718, 6243, 18494, 22467, 12289, 28672, 37282, 3679, 39688, 1273, 12996, 27965, 21743, 19218, 35850, 5111, 25164, 15797, 33497, 7464, 12626, 28335, 25844, 15117, 21390, 19571, 16392, 24569, 4013, 36948, 22298, 18663, 28903, 12058, 35064, 5897, 24057, 16904, 36387, 4574, 10130, 30831, 20689, 20272, 21165, 19796, 11326, 29635, 28146, 12815, 22006, 18955, 1914, 39047, 33868, 7093, 485, 40476, 28062, 12899, 37021, 3940, 28847, 12114, 23587, 17374, 36758, 4203, 38950, 2011, 1762, 39199, 20617, 20344, 11445, 29516, 38163, 2798, 40592, 369, 262, 40699, 15666, 25295, 15185, 25776, 24386, 16575, 38410, 2551, 366, 40595, 38037, 2924, 32553, 8408, 7857, 33104, 28610, 12351, 18094, 22867, 36271, 4690, 2775, 38186, 8963, 31998, 34042, 6919, 17255, 23706, 18830, 22131, 3400, 37561, 40434, 527, 14130, 26831, 3954, 37007, 38499, 2462, 40933, 28, 7316, 33645, 6239, 34722, 34735, 6226, 32505, 8456, 40596, 365, 17465, 23496, 11833, 29128, 27453, 13508, 12653, 28308, 31422, 9539, 9959, 31002, 16684, 24277, 9222, 31739, 31749, 9212, 31075, 9886, 20784, 20177, 40657, 304, 3324, 37637, 4581, 36380, 9735, 31226, 38492, 2469, 21068, 19893, 20902, 20059, 5362, 35599, 32621, 8340, 13581, 27380, 4410, 36551, 21845, 19116, 33989, 6972, 39584, 1377, 4276, 36685, 39479, 1482, 24428, 16533, 34717, 6244, 21561, 19400, 3007, 37954, 34963, 5998, 30012, 10949, 33524, 7437, 36584, 4377, 31849, 9112, 11243, 29718, 6881, 34080, 29859, 11102, 24621, 16340, 14821, 26140, 10703, 30258, 21484, 19477, 21601, 19360, 11193, 29768, 37348, 3613, 16330, 24631, 2296, 38665, 2921, 38040, 11752, 29209, 37501, 3460, 38016, 2945, 21961, 19000, 26458, 14503, 20066, 20895, 2253, 38708, 33034, 7927, 22236, 18725, 28503, 12458, 25030, 15931, 22745, 18216, 38629, 2332, 6096, 34865, 16074, 24887, 8568, 32393, 18906, 22055, 22875, 18086, 20950, 20011, 6993, 33968, 16033, 24928, 26802, 14159, 24586, 16375, 38379, 2582, 13521, 27440, 37022, 3939, 11031, 29930, 39456, 1505, 28203, 12758, 39252, 1709, 39602, 1359, 22944, 18017, 1750, 39211, 9969, 30992, 40153, 808, 6679, 34282, 36968, 3993, 20485, 20476, 10994, 29967, 33932, 7029, 12457, 28504, 7695, 33266, 2347, 38614, 7214, 33747, 34563, 6398, 30074, 10887, 20382, 20579, 21827, 19134, 27826, 13135, 5108, 35853, 11214, 29747, 37994, 2967, 6447, 34514, 27059, 13902, 6192, 34769, 5594, 35367, 5861, 35100, 25921, 15040, 26739, 14222, 9987, 30974, 8699, 32262, 4591, 36370, 14652, 26309, 16571, 24390, 9344, 31617, 3467, 37494, 1116, 39845, 7200, 33761, 36540, 4421, 23009, 17952, 24154, 16807, 23700, 17261, 17875, 23086, 22830, 18131, 3450, 37511, 30186, 10775, 32359, 8602, 13212, 27749, 2101, 38860, 34696, 6265, 4046, 36915, 12890, 28071, 20087, 20874, 33137, 7824, 34023, 6938, 1485, 39476, 23452, 17509, 15207, 25754, 14710, 26251, 40729, 232, 37212, 3749, 4882, 36079, 18632, 22329, 11858, 29103, 3102, 37859, 8121, 32840, 38142, 2819, 10882, 30079, 35662, 5299, 35843, 5118, 8843, 32118, 9484, 31477, 32052, 8909, 13874, 27087, 6921, 34040, 38045, 2916, 12908, 28053, 11926, 29035, 1131, 39830, 20510, 20451, 4450, 36511, 30031, 10930, 16212, 24749, 8137, 32824, 33148, 7813, 16981, 23980, 21665, 19296, 40675, 286, 34017, 6944, 37122, 3839, 18406, 22555, 2472, 38489, 32884, 8077, 28491, 12470, 28877, 12084, 9246, 31715, 12146, 28815, 32115, 8846, 14500, 26461, 18233, 22728, 22563, 18398, 31934, 9027, 37134, 3827, 17592, 23369, 38429, 2532, 6127, 34834, 9590, 31371, 16946, 24015, 13595, 27366, 7109, 33852, 28910, 12051, 38528, 2433, 19024, 21937, 18351, 22610, 38858, 2103, 18144, 22817, 10708, 30253, 12267, 28694, 20270, 20691, 31675, 9286, 1113, 39848, 4538, 36423, 8694, 32267, 13808, 27153, 8438, 32523, 18763, 22198, 4084, 36877, 32955, 8006, 34307, 6654, 35029, 5932, 6760, 34201, 31721, 9240, 38542, 2419, 10820, 30141, 34431, 6530, 35829, 5132, 571, 40390, 28789, 12172, 16053, 24908, 30895, 10066, 8598, 32363, 10546, 30415, 14608, 26353, 32143, 8818 };

__device__ const  uint64_t KNTT2y[N/2] = {20736, 20225, 8255, 32706, 36774, 4187, 25840, 15121, 36200, 4761, 35350, 5611, 5317, 35644, 21090, 19871, 9929, 31032, 31025, 9936, 39689, 1272, 18220, 22741, 8405, 32556, 30442, 10519, 25466, 15495, 13666, 27295, 30401, 10560, 9829, 31132, 1753, 39208, 12631, 28330, 5838, 35123, 19166, 21795, 37874, 3087, 5189, 35772, 29457, 11504, 5060, 35901, 5199, 35762, 25614, 15347, 7477, 33484, 12563, 28398, 13580, 27381, 34760, 6201, 3283, 37678, 18538, 22423, 38783, 2178, 33516, 7445, 8402, 32559, 27780, 13181, 38581, 2380, 4465, 36496, 31070, 9891, 30001, 10960, 26300, 14661, 16404, 24557, 3071, 37890, 7921, 33040, 37127, 3834, 38688, 2273, 32083, 8878, 14074, 26887, 7936, 33025, 10239, 30722, 22270, 18691, 31365, 9596, 20934, 20027, 20103, 20858, 28931, 12030, 16201, 24760, 38187, 2774, 9851, 31110, 12469, 28492, 18343, 22618, 22433, 18528, 25810, 15151, 21517, 19444, 18579, 22382, 35919, 5042, 4468, 36493, 26296, 14665, 40162, 799, 33834, 7127, 38584, 2377, 31943, 9018, 26384, 14577, 19208, 21753, 31430, 9531, 20951, 20010, 21534, 19427, 25315, 15646, 29869, 11092, 29624, 11337, 16708, 24253, 39736, 1225, 5310, 35651, 16950, 24011, 7613, 33348, 39660, 1301, 6141, 34820, 25073, 15888, 33593, 7368, 28145, 12816, 15094, 25867, 35222, 5739, 27719, 13242, 20863, 20098, 11717, 29244, 6585, 34376, 26628, 14333, 8158, 32803, 2422, 38539, 22542, 18419, 13300, 27661, 6056, 34905, 35107, 5854, 2519, 38442, 9645, 31316, 33588, 7373, 25105, 15856, 23440, 17521, 4559, 36402, 26209, 14752, 3925, 37036, 11438, 29523, 18298, 22663, 37565, 3396, 17730, 23231, 13552, 27409, 37222, 3739, 39394, 1567, 29530, 11431, 30955, 10006, 37187, 3774, 23856, 17105, 32348, 8613, 9302, 31659, 7160, 33801, 36337, 4624, 20378, 20583, 27202, 13759, 24866, 16095, 5360, 35601, 31938, 9023, 22804, 18157, 13669, 27292, 21241, 19720, 19441, 21520, 40929, 32, 26220, 14741, 30664, 10297, 24739, 16222, 31297, 9664, 12967, 27994, 3342, 37619, 16276, 24685, 14213, 26748, 22988, 17973, 30646, 10315, 8767, 32194, 32382, 8579, 19967, 20994, 38867, 2094, 26130, 14831, 34909, 6052, 23057, 17904, 23828, 17133, 34810, 6151, 15541, 25420, 40805, 156, 27881, 13080, 26604, 14357, 6128, 34833, 17073, 23888, 26228, 14733, 34438, 6523, 7411, 33550, 35921, 5040, 15383, 25578, 37143, 3818, 15861, 25100, 24371, 16590, 7968, 32993, 24980, 15981, 38546, 2415, 28023, 12938, 30598, 10363, 7136, 33825, 12050, 28911, 28853, 12108, 24570, 16391, 10528, 30433, 34532, 6429, 29874, 11087, 6199, 34762, 25459, 15502, 24919, 16042, 6173, 34788, 32352, 8609, 34308, 6653, 29675, 11286, 21001, 19960, 21586, 19375, 38844, 2117, 19452, 21509, 15827, 25134, 38337, 2624, 20068, 20893, 17081, 23880, 28278, 12683, 26772, 14189, 39269, 1692, 3317, 37644, 21400, 19561, 26683, 14278, 14911, 26050, 18670, 22291, 31923, 9038, 29910, 11051, 38373, 2588, 12850, 28111, 28729, 12232, 36229, 4732, 6468, 34493, 30366, 10595, 33387, 7574, 4571, 36390, 28169, 12792, 28273, 12688, 33097, 7864, 33820, 7141, 39815, 1146, 18558, 22403, 810, 40151, 14351, 26610, 22557, 18404, 40651, 310, 38961, 2000, 30811, 10150, 32294, 8667, 29263, 11698, 10415, 30546, 6775, 34186, 4070, 36891, 26349, 14612, 32576, 8385, 34248, 6713, 37291, 3670, 10964, 29997, 7312, 33649, 20724, 20237, 38568, 2393, 13053, 27908, 31360, 9601, 36269, 4692, 14654, 26307, 9750, 31211, 8729, 32232, 16651, 24310, 1720, 39241, 1373, 39588, 16786, 24175, 5315, 35646, 32969, 7992, 5036, 35925, 31169, 9792, 7651, 33310, 3115, 37846, 13097, 27864, 15788, 25173, 35067, 5894, 26719, 14242, 23038, 17923, 16500, 24461, 22296, 18665, 40782, 179, 31459, 9502, 33832, 7129, 32430, 8531, 21598, 19363, 38627, 2334, 17975, 22986, 4181, 36780, 9797, 31164, 14190, 26771, 16233, 24728, 21965, 18996, 20148, 20813, 25436, 15525, 28007, 12954, 38709, 2252, 22468, 18493, 35939, 5022, 8561, 32400, 40375, 586, 39823, 1138, 39874, 1087, 4879, 36082, 27833, 13128, 24973, 15988, 17349, 23612, 33971, 6990, 15727, 25234, 1044, 39917, 37351, 3610, 18992, 21969, 39039, 1922, 28561, 12400, 12011, 28950, 35208, 5753, 31221, 9740, 13798, 27163, 22754, 18207, 23917, 17044, 7712, 33249, 29935, 11026, 19610, 21351, 19489, 21472, 30297, 10664, 13122, 27839, 23836, 17125, 28255, 12706, 15391, 25570, 30588, 10373, 3365, 37596, 23031, 17930, 21648, 19313, 39244, 1717, 33166, 7795, 32953, 8008, 24897, 16064, 13959, 27002, 31248, 9713, 37756, 3205, 40056, 905, 29837, 11124, 15866, 25095, 15154, 25807, 13417, 27544, 40315, 646, 14678, 26283, 25988, 14973, 4910, 36051, 1287, 39674, 8968, 31993, 24825, 16136, 8224, 32737, 20025, 20936, 11394, 29567, 33870, 7091, 38767, 2194, 5665, 35296, 264, 40697, 29451, 11510, 33749, 7212, 31429, 9532, 869, 40092, 20141, 20820, 37702, 3259, 2758, 38203, 16672, 24289, 20354, 20607, 39807, 1154, 13696, 27265, 15472, 25489, 20540, 20421, 1838, 39123, 19786, 21175, 2990, 37971, 17969, 22992, 22583, 18378, 36027, 4934, 33736, 7225, 6240, 34721, 31668, 9293, 826, 40135, 29944, 11017, 274, 40687, 19823, 21138, 3686, 37275, 17911, 23050, 13813, 27148, 30164, 10797, 4336, 36625, 2270, 38691, 34465, 6496, 16186, 24775, 39681, 1280, 31366, 9595, 33232, 7729, 29385, 11576, 23094, 17867, 10541, 30420, 619, 40342, 26694, 14267, 11018, 29943, 32569, 8392, 35708, 5253, 13278, 27683, 26205, 14756, 5198, 35763, 11073, 29888, 36739, 4222, 8437, 32524, 43, 40918, 10848, 30113, 30477, 10484, 8998, 31963, 12986, 27975, 40177, 784, 28790, 12171, 13970, 26991, 10342, 30619, 15191, 25770, 22821, 18140, 15100, 25861, 10248, 30713, 50, 40911, 10494, 30467, 13529, 27432, 33733, 7228, 3578, 37383, 3822, 37139, 32586, 8375, 29038, 11923, 15570, 25391, 7336, 33625, 10332, 30629, 12246, 28715, 11619, 29342, 597, 40364, 38206, 2755, 11802, 29159, 27253, 13708, 16450, 24511, 28171, 12790, 28608, 12353, 29973, 10988, 30254, 10707, 2274, 38687, 37806, 3155, 40426, 535, 2405, 38556, 31372, 9589, 32449, 8512, 11150, 29811, 5385, 35576, 26814, 14147, 9919, 31042, 8498, 32463, 28791, 12170, 28511, 12450, 3636, 37325, 31386, 9575, 38449, 2512, 10220, 30741, 33086, 7875, 16581, 24380, 19635, 21326, 14365, 26596, 40423, 538, 493, 40468, 3526, 37435, 29355, 11606, 1368, 39593, 26003, 14958, 40827, 134, 17634, 23327, 4503, 36458, 22445, 18516, 16626, 24335, 6844, 34117, 8193, 32768, 19825, 21136, 23810, 17151, 18838, 22123, 31374, 9587, 26677, 14284, 21719, 19242, 6669, 34292, 12957, 28004, 28098, 12863, 5378, 35583, 6949, 34012, 37530, 3431, 327, 40634, 21116, 19845, 4100, 36861, 28824, 12137, 16832, 24129, 28077, 12884, 9370, 31591, 18337, 22624, 23168, 17793, 11079, 29882, 126, 40835, 8039, 32922, 33366, 7595, 28017, 12944, 38052, 2909, 24755, 16206, 38148, 2813, 25661, 15300, 22852, 18109, 21108, 19853, 10655, 30306, 7993, 32968, 19856, 21105, 22141, 18820, 39782, 1179, 11425, 29536, 34070, 6891, 9939, 31022, 12591, 28370, 9626, 31335, 7929, 33032, 37836, 3125, 26085, 14876, 35099, 5862, 499, 40462, 39314, 1647, 13158, 27803, 31960, 9001, 27815, 13146, 20736, 20225, 8255, 32706, 36774, 4187, 25840, 15121, 36200, 4761, 35350, 5611, 5317, 35644, 21090, 19871, 9929, 31032, 31025, 9936, 39689, 1272, 18220, 22741, 8405, 32556, 30442, 10519, 25466, 15495, 13666, 27295, 30401, 10560, 9829, 31132, 1753, 39208, 12631, 28330, 5838, 35123, 19166, 21795, 37874, 3087, 5189, 35772, 29457, 11504, 5060, 35901, 5199, 35762, 25614, 15347, 7477, 33484, 12563, 28398, 13580, 27381, 34760, 6201, 3283, 37678, 18538, 22423, 38783, 2178, 33516, 7445, 8402, 32559, 27780, 13181, 38581, 2380, 4465, 36496, 31070, 9891, 30001, 10960, 26300, 14661, 16404, 24557, 3071, 37890, 7921, 33040, 37127, 3834, 38688, 2273, 32083, 8878, 14074, 26887, 7936, 33025, 10239, 30722, 22270, 18691, 31365, 9596, 20934, 20027, 20103, 20858, 28931, 12030, 16201, 24760, 38187, 2774, 9851, 31110, 12469, 28492, 18343, 22618, 22433, 18528, 25810, 15151, 21517, 19444, 18579, 22382, 35919, 5042, 4468, 36493, 26296, 14665, 40162, 799, 33834, 7127, 38584, 2377, 31943, 9018, 26384, 14577, 19208, 21753, 31430, 9531, 20951, 20010, 21534, 19427, 25315, 15646, 29869, 11092, 29624, 11337, 16708, 24253, 39736, 1225, 5310, 35651, 16950, 24011, 7613, 33348, 39660, 1301, 6141, 34820, 25073, 15888, 33593, 7368, 28145, 12816, 15094, 25867, 35222, 5739, 27719, 13242, 20863, 20098, 11717, 29244, 6585, 34376, 26628, 14333, 8158, 32803, 2422, 38539, 22542, 18419, 13300, 27661, 6056, 34905, 35107, 5854, 2519, 38442, 9645, 31316, 33588, 7373, 25105, 15856, 23440, 17521, 4559, 36402, 26209, 14752, 3925, 37036, 11438, 29523, 18298, 22663, 37565, 3396, 17730, 23231, 13552, 27409, 37222, 3739, 39394, 1567, 29530, 11431, 30955, 10006, 37187, 3774, 23856, 17105, 32348, 8613, 9302, 31659, 7160, 33801, 36337, 4624, 20378, 20583, 27202, 13759, 24866, 16095, 5360, 35601, 31938, 9023, 22804, 18157, 13669, 27292, 21241, 19720, 19441, 21520, 40929, 32, 26220, 14741, 30664, 10297, 24739, 16222, 31297, 9664, 12967, 27994, 3342, 37619, 16276, 24685, 14213, 26748, 22988, 17973, 30646, 10315, 8767, 32194, 32382, 8579, 19967, 20994, 38867, 2094, 26130, 14831, 34909, 6052, 23057, 17904, 23828, 17133, 34810, 6151, 15541, 25420, 40805, 156, 27881, 13080, 26604, 14357, 6128, 34833, 17073, 23888, 26228, 14733, 34438, 6523, 7411, 33550, 35921, 5040, 15383, 25578, 37143, 3818, 15861, 25100, 24371, 16590, 7968, 32993, 24980, 15981, 38546, 2415, 28023, 12938, 30598, 10363, 7136, 33825, 12050, 28911, 28853, 12108, 24570, 16391, 10528, 30433, 34532, 6429, 29874, 11087, 6199, 34762, 25459, 15502, 24919, 16042, 6173, 34788, 32352, 8609, 34308, 6653, 29675, 11286, 21001, 19960, 21586, 19375, 38844, 2117, 19452, 21509, 15827, 25134, 38337, 2624, 20068, 20893, 17081, 23880, 28278, 12683, 26772, 14189, 39269, 1692, 3317, 37644, 21400, 19561, 26683, 14278, 14911, 26050, 18670, 22291, 31923, 9038, 29910, 11051, 38373, 2588, 12850, 28111, 28729, 12232, 36229, 4732, 6468, 34493, 30366, 10595, 33387, 7574, 4571, 36390, 28169, 12792, 28273, 12688, 33097, 7864, 33820, 7141, 39815, 1146, 18558, 22403, 810, 40151, 14351, 26610, 22557, 18404, 40651, 310, 38961, 2000, 30811, 10150, 32294, 8667, 29263, 11698, 10415, 30546, 6775, 34186, 4070, 36891, 26349, 14612, 32576, 8385, 34248, 6713, 37291, 3670, 10964, 29997, 7312, 33649, 20724, 20237, 38568, 2393, 13053, 27908, 31360, 9601, 36269, 4692, 14654, 26307, 9750, 31211, 8729, 32232, 16651, 24310, 1720, 39241, 1373, 39588, 16786, 24175, 5315, 35646, 32969, 7992, 5036, 35925, 31169, 9792, 7651, 33310, 3115, 37846, 13097, 27864, 15788, 25173, 35067, 5894, 26719, 14242, 23038, 17923, 16500, 24461, 22296, 18665, 40782, 179, 31459, 9502, 33832, 7129, 32430, 8531, 21598, 19363, 38627, 2334, 17975, 22986, 4181, 36780, 9797, 31164, 14190, 26771, 16233, 24728, 21965, 18996, 20148, 20813, 25436, 15525, 28007, 12954, 38709, 2252, 22468, 18493, 35939, 5022, 8561, 32400, 40375, 586, 39823, 1138, 39874, 1087, 4879, 36082, 27833, 13128, 24973, 15988, 17349, 23612, 33971, 6990, 15727, 25234, 1044, 39917, 37351, 3610, 18992, 21969, 39039, 1922, 28561, 12400, 12011, 28950, 35208, 5753, 31221, 9740, 13798, 27163, 22754, 18207, 23917, 17044, 7712, 33249, 29935, 11026, 19610, 21351, 19489, 21472, 30297, 10664, 13122, 27839, 23836, 17125, 28255, 12706, 15391, 25570, 30588, 10373, 3365, 37596, 23031, 17930, 21648, 19313, 39244, 1717, 33166, 7795, 32953, 8008, 24897, 16064, 13959, 27002, 31248, 9713, 37756, 3205, 40056, 905, 29837, 11124, 15866, 25095, 15154, 25807, 13417, 27544, 40315, 646, 14678, 26283, 25988, 14973, 4910, 36051, 1287, 39674, 8968, 31993, 24825, 16136, 8224, 32737, 20025, 20936, 11394, 29567, 33870, 7091, 38767, 2194, 5665, 35296, 264, 40697, 29451, 11510, 33749, 7212, 31429, 9532, 869, 40092, 20141, 20820, 37702, 3259, 2758, 38203, 16672, 24289, 20354, 20607, 39807, 1154, 13696, 27265, 15472, 25489, 20540, 20421, 1838, 39123, 19786, 21175, 2990, 37971, 17969, 22992, 22583, 18378, 36027, 4934, 33736, 7225, 6240, 34721, 31668, 9293, 826, 40135, 29944, 11017, 274, 40687, 19823, 21138, 3686, 37275, 17911, 23050, 13813, 27148, 30164, 10797, 4336, 36625, 2270, 38691, 34465, 6496, 16186, 24775, 39681, 1280, 31366, 9595, 33232, 7729, 29385, 11576, 23094, 17867, 10541, 30420, 619, 40342, 26694, 14267, 11018, 29943, 32569, 8392, 35708, 5253, 13278, 27683, 26205, 14756, 5198, 35763, 11073, 29888, 36739, 4222, 8437, 32524, 43, 40918, 10848, 30113, 30477, 10484, 8998, 31963, 12986, 27975, 40177, 784, 28790, 12171, 13970, 26991, 10342, 30619, 15191, 25770, 22821, 18140, 15100, 25861, 10248, 30713, 50, 40911, 10494, 30467, 13529, 27432, 33733, 7228, 3578, 37383, 3822, 37139, 32586, 8375, 29038, 11923, 15570, 25391, 7336, 33625, 10332, 30629, 12246, 28715, 11619, 29342, 597, 40364, 38206, 2755, 11802, 29159, 27253, 13708, 16450, 24511, 28171, 12790, 28608, 12353, 29973, 10988, 30254, 10707, 2274, 38687, 37806, 3155, 40426, 535, 2405, 38556, 31372, 9589, 32449, 8512, 11150, 29811, 5385, 35576, 26814, 14147, 9919, 31042, 8498, 32463, 28791, 12170, 28511, 12450, 3636, 37325, 31386, 9575, 38449, 2512, 10220, 30741, 33086, 7875, 16581, 24380, 19635, 21326, 14365, 26596, 40423, 538, 493, 40468, 3526, 37435, 29355, 11606, 1368, 39593, 26003, 14958, 40827, 134, 17634, 23327, 4503, 36458, 22445, 18516, 16626, 24335, 6844, 34117, 8193, 32768, 19825, 21136, 23810, 17151, 18838, 22123, 31374, 9587, 26677, 14284, 21719, 19242, 6669, 34292, 12957, 28004, 28098, 12863, 5378, 35583, 6949, 34012, 37530, 3431, 327, 40634, 21116, 19845, 4100, 36861, 28824, 12137, 16832, 24129, 28077, 12884, 9370, 31591, 18337, 22624, 23168, 17793, 11079, 29882, 126, 40835, 8039, 32922, 33366, 7595, 28017, 12944, 38052, 2909, 24755, 16206, 38148, 2813, 25661, 15300, 22852, 18109, 21108, 19853, 10655, 30306, 7993, 32968, 19856, 21105, 22141, 18820, 39782, 1179, 11425, 29536, 34070, 6891, 9939, 31022, 12591, 28370, 9626, 31335, 7929, 33032, 37836, 3125, 26085, 14876, 35099, 5862, 499, 40462, 39314, 1647, 13158, 27803, 31960, 9001, 27815, 13146};

__device__ const  uint64_t KNTT3y[N/8] = {14079, 26882, 40622, 339, 15688, 25273, 7399, 33562, 32875, 8086, 20505, 20456, 27261, 13700, 22604, 18357, 17758, 23203, 934, 40027, 2692, 38269, 26617, 14344, 37986, 2975, 36302, 4659, 34725, 6236, 9978, 30983, 5346, 35615, 33169, 7792, 17801, 23160, 11782, 29179, 17013, 23948, 22554, 18407, 10011, 30950, 35518, 5443, 9920, 31041, 23039, 17922, 38073, 2888, 31578, 9383, 5687, 35274, 35369, 5592, 28966, 11995, 33604, 7357, 40067, 894, 25944, 15017, 16975, 23986, 2489, 38472, 16739, 24222, 11537, 29424, 6325, 34636, 14380, 26581, 32912, 8049, 26029, 14932, 2046, 38915, 13200, 27761, 26862, 14099, 37207, 3754, 3477, 37484, 13183, 27778, 25487, 15474, 32300, 8661, 20559, 20402, 15041, 25920, 37367, 3594, 5882, 35079, 23707, 17254, 36672, 4289, 39371, 1590, 22775, 18186, 28541, 12420, 38790, 2171, 11352, 29609, 37563, 3398, 17572, 23389, 40695, 266, 29300, 11661, 15939, 25022, 22521, 18440, 35627, 5334, 1024, 39937, 21141, 19820, 1816, 39145, 27572, 13389, 30678, 10283, 23508, 17453, 33285, 7676, 2009, 38952, 7570, 33391, 13163, 27798, 16625, 24336, 33264, 7697, 32108, 8853, 8950, 32011, 35181, 5780, 4992, 35969, 29820, 11141, 40435, 526, 15763, 25198, 32988, 7973, 36716, 4245, 1682, 39279, 2392, 38569, 6183, 34778, 28762, 12199, 16432, 24529, 26047, 14914, 24021, 16940, 23547, 17414, 3928, 37033, 36319, 4642, 4406, 36555, 24941, 16020, 39348, 1613, 31751, 9210, 19860, 21101, 8709, 32252, 27118, 13843, 20885, 20076, 3931, 37030, 8614, 32347, 38397, 2564, 40237, 724, 40254, 707, 14178, 26783, 5585, 35376, 33464, 7497, 24305, 16656, 21812, 19149, 7269, 33692, 29722, 11239, 8091, 32870, 24010, 16951, 18807, 22154, 32980, 7981, 31753, 9208, 923, 40038, 27096, 13865, 6437, 34524, 4532, 36429, 27702, 13259, 4308, 36653, 17767, 23194, 8920, 32041, 9960, 31001, 31225, 9736, 40704, 257, 31375, 9586, 32785, 8176, 22567, 18394, 11101, 29860, 33301, 7660, 29469, 11492, 15708, 25253, 34661, 6300, 21457, 19504, 6373, 34588, 16011, 24950, 6502, 34459, 7594, 33367, 40440, 521, 1924, 39037, 38437, 2524, 40533, 428, 10232, 30729, 13160, 27801, 25826, 15135, 5418, 35543, 17989, 22972, 1103, 39858, 16862, 24099, 38757, 2204, 9186, 31775, 40766, 195, 24611, 16350, 33255, 7706, 29785, 11176, 23032, 17929, 18581, 22380, 7565, 33396, 17827, 23134, 21199, 19762, 28735, 12226, 33435, 7526, 17863, 23098, 12182, 28779, 35199, 5762, 20964, 19997, 6700, 34261, 19442, 21519, 10602, 30359, 27439, 13522, 16311, 24650, 14061, 26900, 6846, 34115, 12456, 28505, 38330, 2631, 203, 40758, 32775, 8186, 40, 40921, 24658, 16303, 20345, 20616, 26449, 14512, 12080, 28881, 13705, 27256, 9140, 31821, 25905, 15056, 7249, 33712, 1849, 39112, 15893, 25068, 40720, 241, 18265, 22696, 7793, 33168, 19887, 21074, 38461, 2500, 20868, 20093, 18709, 22252, 25568, 15393, 23259, 17702, 35103, 5858, 6295, 34666, 28721, 12240, 19804, 21157, 14134, 26827, 16884, 24077, 30971, 9990, 502, 40459, 8524, 32437, 35096, 5865, 38798, 2163, 39200, 1761, 34885, 6076, 31054, 9907, 2150, 38811, 671, 40290, 8293, 32668, 2717, 38244, 21493, 19468, 28179, 12782, 17956, 23005, 1314, 39647, 19048, 21913, 31131, 9830, 15860, 25101, 35046, 5915, 8085, 32876, 25671, 15290, 4418, 36543, 15954, 25007, 24971, 15990, 11013, 29948, 23484, 17477, 37681, 3280, 25085, 15876, 30024, 10937, 16646, 24315, 33465, 7496, 38846, 2115, 14867, 26094, 29850, 11111, 2633, 38328, 28879, 12082, 26750, 14211, 6094, 34867, 16907, 24054, 37726, 3235, 9183, 31778, 38104, 2857 };
*/

// 原始多项式乘法
static void Hpol_naivemul(uint64_t* c, uint64_t* a, uint64_t* b)
{
        int i, j;
        uint64_t r[2 * N];
        for (i = 0; i < 2 * N; i++)
                r[i] = 0;
        for (i = 0; i < N; i++)
                for (j = 0; j < N; j++)
                {
                        r[i + j] += a[i] * b[j] % Q;
                        r[i + j] %= Q;
                }
        for (i = N; i < 2 * N - 1; i++) {
                r[i - N] = r[i - N] + Q - r[i];
                r[i - N] %= Q;
        }
        for (i = 0; i < N; i++)
                c[i] = r[i];
}



/*---------------------------------------------------
 Input: polynomial a
 Output: polynomial a in dimTT domain
 ------------------------------------------------------*/
__global__ void Dpoly_pointwise(uint64_t* a, uint64_t* b, uint64_t* c, int length, int group)
{
    // 全局id
    int globaltid = blockIdx.x * blockDim.x * 2 + threadIdx.x;
    c[globaltid] = a[globaltid] * b[globaltid] % Q;
    c[globaltid + length/2] = a[globaltid + length/2] * b[globaltid + length/2] % Q;
}

__global__ void Dpoly_ntt(uint64_t* r, int length)
{
    // 全局id
    int globaltid = blockIdx.x * blockDim.x * 2 + threadIdx.x;
    // 块内id只需要lengt的一半
    int tid = threadIdx.x;
        uint64_t t = length/2;
    // 拆分group组需要处理的多项式 动态声明 调用的时候配置<<<dimGrid, dimBlock, len*sizeof(uint64_t)>>>
    extern __shared__ uint64_t shared_array[];
    // 因为每一轮只需要N/2个线程同时运行，所以赋值的时候一个线程赋值两个
    shared_array[tid] = r[globaltid];
    shared_array[tid + t] = r[globaltid + t];
    uint64_t m, j,i, V, U;
        for (m = 1; m < length; m = 2 * m){
        __syncthreads();
        i = tid / t;
        j = tid + i * t;
        U = shared_array[j] % Q;
        V = shared_array[j + t] * Dphi[m + i] % Q;
        shared_array[j] = (U + V) % Q;
        shared_array[j + t] = (U - V + 4 * Q) % Q;
        t = t / 2;
        }
    // 拷贝到全局内存中
    __syncthreads();
    r[globaltid] = shared_array[tid];
    r[globaltid + length/2] = shared_array[tid + length/2];
}



__global__ void Dpoly_invntt(uint64_t* r, int length, int inv_n)
{
    // 全局id
    int globaltid = blockIdx.x * blockDim.x * 2 + threadIdx.x;
    // 块内id只需要length的一半
    int tid = threadIdx.x;
    // 拆分group组需要处理的多项式 动态声明 调用的时候配置<<<dimGrid, dimBlock, len*sizeof(uint64_t)>>>
    extern __shared__ uint64_t shared_array[];
    // 因为每一轮只需要N/2个线程同时运行，所以赋值的时候一个线程赋值两个
    shared_array[tid] = r[globaltid];
    shared_array[tid + length/2] = r[globaltid + length/2];
    
        uint64_t t, m, i, j, len, S, U, V;
        t = 1;
        for (m = length; m > 1; m = m / 2){
        __syncthreads();
        len = m / 2;
        i = tid / t;
        j = tid + (tid / t) * t;
        S = Dinvphi[len + i];
                U = shared_array[j] % Q;
        V = shared_array[j + t] % Q;
        shared_array[j] = (U + V) % Q;
        shared_array[j + t] = ((U - V + 4 * Q) * S) % Q;
        t = 2 * t;
        }
    __syncthreads();
    r[globaltid] = (shared_array[tid] * inv_n) % Q;
    r[globaltid + length/2] = (shared_array[tid + length/2] * inv_n) % Q;
}






// 1KNTT
__global__ void D1KNTTMul(uint64_t* a, uint64_t* b, uint64_t* c, uint64_t* f11, uint64_t* o, int length)
{
    // 全局id
    int tid= blockIdx.x * blockDim.x + threadIdx.x;
    o[tid] = ((a[tid] + a[tid + length]) * (b[tid] + b[tid + length]) - c[tid] - c[tid + length]) % Q;
    o[tid + length] = (c[tid + length] + f11[tid]) % Q;
}
void Hpoly_1Iptntt_kara(uint64_t* f, uint64_t* g, uint64_t* fg, uint64_t* h, uint64_t* f11, int length, int inv_n){
    // 先f1后f0 先g1后g0
        Dpoly_ntt<<<2, length/2, length * sizeof(uint64_t)>>>(f, length);
        Dpoly_ntt<<<2, length/2, length * sizeof(uint64_t)>>>(g, length);
        Dpoly_pointwise<<<2,length/2>>>(f, g, fg, length, 2);
    Dpoly_pointwise<<<2,length/2>>>(f11, fg, f11, length, 1);
    D1KNTTMul<<<2,length/2>>>(f, g, fg, f11, h, length);
    Dpoly_invntt<<<2, length/2, length*sizeof(uint64_t)>>>(h, length, inv_n);
}




// 2KNTT
__global__ void D2KNTTMul(uint64_t* f, uint64_t* g, uint64_t* c, uint64_t* f11, uint64_t* o, int length)
{
    // 全局id
    int tid= blockIdx.x * blockDim.x + threadIdx.x;
    o[tid + 3 * length] = (c[tid + 3 * length] + KNTT2y[tid] * (((f[tid + 2 * length] + f[tid]) * (g[tid + 2 * length] + g[tid]) - c[tid + 2 * length] - c[tid]) % Q) + f11[tid + length]) % Q;
    
    o[tid + 2 * length] = ((f[tid + 2 * length] + f[tid + 3 * length]) * (g[tid + 2 * length] + g[tid + 3 * length]) - c[tid + 3 * length] - c[tid + 2 * length] + KNTT2y[tid] * (((f[tid + length] + f[tid]) * (g[tid + length] + g[tid]) - c[tid + length] - c[tid]) % Q)) % Q;
    
    o[tid + length] = (c[tid + 2 * length] + f11[tid] + ((f[tid + 3 * length] + f[tid + length]) * (g[tid + 3 * length] + g[tid + length]) - c[tid + 3 * length] - c[tid + length])) % Q;
    
    o[tid] = (((f[tid + 3 * length] + f[tid]) * (g[tid + 3 * length] + g[tid]) - c[tid + 3 * length] - c[tid]) + ((f[tid + 2 * length] + f[tid + length]) * (g[tid + 2 * length] + g[tid + length]) - c[tid + 2 * length] - c[tid + length])) % Q;
}


void  Hpoly_2Iptntt_kara(uint64_t* f, uint64_t* g, uint64_t* fg, uint64_t* h, uint64_t* f11, int length, int inv_n){
        // f3 f2 f1 f0
        Dpoly_ntt<<<4, length/2, length * sizeof(uint64_t)>>>(f, length);
        Dpoly_ntt<<<4, length/2, length * sizeof(uint64_t)>>>(g, length);
        Dpoly_pointwise<<<4,length/2>>>(f, g, fg, length, 4);
    Dpoly_pointwise<<<2,length/2>>>(f11, fg, f11, length, 2);
    D2KNTTMul<<<2,length/2>>>(f, g, fg, f11, h, length);
    Dpoly_invntt<<<4, length/2, length*sizeof(uint64_t)>>>(h, length, inv_n);
}


// 3KNTT
__global__ void D3KNTTMul(uint64_t* f, uint64_t* g, uint64_t* c, uint64_t* o, int length)
{
    // 全局id
    int tid= blockIdx.x * blockDim.x + threadIdx.x;
    o[tid + 7 * length] = (c[tid + 7 * length] + KNTT3y[tid] * c[tid + 3 * length] + KNTT3y[tid] * (((f[tid + 6 * length] + f[tid]) * (g[tid + 6 * length] + g[tid]) - c[tid + 6 * length] - c[tid]) % Q) + KNTT3y[tid] * (((f[tid + 5 * length] + f[tid + length]) * (g[tid + 5 * length] + g[tid + length]) - c[tid + 5 * length] - c[tid + length]) % Q) + KNTT3y[tid] * (((f[tid + 4 * length] + f[tid + 2 * length]) * (g[tid + 4 * length] + g[tid + 2 * length]) - c[tid + 4 * length] - c[tid + 2 * length]) % Q)) % Q;
    
    o[tid + 6 * length] = (((f[tid + 7 * length] + f[tid + 6 * length]) * (g[tid + 7 * length] + g[tid + 6 * length]) - c[tid + 7 * length] - c[tid + 6 * length]) + KNTT3y[tid] * (((f[tid + 5 * length] + f[tid]) * (g[tid + 5 * length] + g[tid]) - c[tid + 5 * length] - c[tid]) % Q) + KNTT3y[tid] * (((f[tid + 4 * length] + f[tid + length]) * (g[tid + 4 * length] + g[tid + length]) - c[tid + 4 * length] - c[tid + length]) % Q) + KNTT3y[tid] * (((f[tid + 3 * length] + f[tid + 2 * length]) * (g[tid + 3 * length] + g[tid + 2 * length]) - c[tid + 3 * length] - c[tid + 2 * length]) % Q)) % Q;
    
    o[tid + 5 * length] = (c[tid + 6 * length] + KNTT3y[tid] * c[tid + 2 * length] + ((f[tid + 7 * length] + f[tid + 5 * length]) * (g[tid + 7 * length] + g[tid + 5 * length]) - c[tid + 7 * length] - c[tid + 5 * length]) + KNTT3y[tid] * (((f[tid + 4 * length] + f[tid]) * (g[tid + 4 * length] + g[tid]) - c[tid + 4 * length] - c[tid]) % Q) + KNTT3y[tid] * (((f[tid + 3 * length] + f[tid + length]) * (g[tid + 3 * length] + g[tid + length]) - c[tid + 3 * length] - c[tid + length]) % Q)) % Q;
    
    o[tid + 4 * length] = (((f[tid + 7 * length] + f[tid + 4 * length]) * (g[tid + 7 * length] + g[tid + 4 * length]) - c[tid + 7 * length] - c[tid + 4 * length]) + ((f[tid + 6 * length] + f[tid + 5 * length]) * (g[tid + 6 * length] + g[tid + 5 * length]) - c[tid + 6 * length] - c[tid + 5 * length]) + KNTT3y[tid] * (((f[tid + 3 * length] + f[tid]) * (g[tid + 3 * length] + g[tid]) - c[tid + 3 * length] - c[tid]) % Q) + KNTT3y[tid] * (((f[tid + 2 * length] + f[tid + length]) * (g[tid + 2 * length] + g[tid + length]) - c[tid + 2 * length] - c[tid + length]) % Q)) % Q;
    
    o[tid + 3 * length] = (c[tid + 5 * length] + KNTT3y[tid] * c[tid + length] + ((f[tid + 7 * length] + f[tid + 3 * length]) * (g[tid + 7 * length] + g[tid + 3 * length]) - c[tid + 7 * length] - c[tid + 3 * length]) + ((f[tid + 6 * length] + f[tid + 4 * length]) * (g[tid + 6 * length] + g[tid + 4 * length]) - c[tid + 6 * length] - c[tid + 4 * length]) + KNTT3y[tid] * (((f[tid + 2 *length] + f[tid]) * (g[tid + 2 *length] + g[tid]) - c[tid + 2 *length] - c[tid]) % Q)) % Q;
    
    o[tid + 2 * length] = (((f[tid + 7 * length] + f[tid + 2 * length]) * (g[tid + 7 * length] + g[tid + 2 * length]) - c[tid + 7 * length] - c[tid + 2 * length]) + ((f[tid + 6 * length] + f[tid + 3 * length]) * (g[tid + 6 * length] + g[tid + 3 * length]) - c[tid + 6 * length] - c[tid + 3 * length]) + ((f[tid + 5 * length] + f[tid + 4 * length]) * (g[tid + 5 * length] + g[tid + 4 * length]) - c[tid + 5 * length] - c[tid + 4 * length]) + KNTT3y[tid] * (((f[tid + length] + f[tid]) * (g[tid + length] + g[tid]) - c[tid + length] - c[tid]) % Q)) % Q;
    
    o[tid + 1 * length] = (c[tid + 4 * length] + KNTT3y[tid] * c[tid] + ((f[tid + 7 * length] + f[tid + length]) * (g[tid + 7 * length] + g[tid + length]) - c[tid + 7 * length] - c[tid + length]) + ((f[tid + 6 * length] + f[tid + 2 * length]) * (g[tid + 6 * length] + g[tid + 2 * length]) - c[tid + 6 * length] - c[tid + 2 * length]) + ((f[tid + 5 * length] + f[tid + 3 * length]) * (g[tid + 5 * length] + g[tid + 3 * length]) - c[tid + 5 * length] - c[tid + 3 * length])) % Q;
    
    o[tid] = ((((f[tid + 7 * length] + f[tid]) * (g[tid + 7 * length] + g[tid]) - c[tid + 7 * length] - c[tid]) + ((f[tid + 6 * length] + f[tid + length]) * (g[tid + 6 * length] + g[tid + length]) - c[tid + 6 * length] - c[tid + length])) % Q + ((f[tid + 5 * length] + f[tid + 2 * length]) * (g[tid + 5 * length] + g[tid + 2 * length]) - c[tid + 5 * length] - c[tid + 2 * length] + (f[tid + 4 * length] + f[tid + 3 * length]) * (g[tid + 4 * length] + g[tid + 3 * length]) - c[tid + 4 * length] - c[tid + 3 * length]) % Q) % Q;
    
}

void  Hpoly_3Iptntt_kara(uint64_t* f, uint64_t* g, uint64_t* fg, uint64_t* h, int length, int inv_n){
    // f3 f2 f1 f0
        Dpoly_ntt<<<8, length/2, length * sizeof(uint64_t)>>>(f, length);
        Dpoly_ntt<<<8, length/2, length * sizeof(uint64_t)>>>(g, length);
        Dpoly_pointwise<<<8,length/2>>>(f, g, fg, length, 8);
    D3KNTTMul<<<2,length/2>>>(f, g, fg, h, length);
    Dpoly_invntt<<<8, length/2, length*sizeof(uint64_t)>>>(h, length, inv_n);
}


int main()
{
        uint64_t Oa[N], Ob[N], Oc[N];
        clock_t start, finish;
        double NTTt = 0;
    double KNTT1t = 0;
    double KNTT2t = 0;
    double KNTT3t = 0;
    
    // NTT
    uint64_t *HNTTa, *HNTTb, *HNTTc;
    uint64_t *DNTTa, *DNTTb, *DNTTc;
    // 主机上申请内存
    cudaHostAlloc((void**)&HNTTa, sizeof(uint64_t)*N , cudaHostAllocDefault);
    cudaHostAlloc((void**)&HNTTb, sizeof(uint64_t)*N , cudaHostAllocDefault);
    cudaHostAlloc((void**)&HNTTc, sizeof(uint64_t)*N , cudaHostAllocDefault);
    // 申请device内存
    cudaMalloc((void**)&DNTTa, sizeof(uint64_t)*N);
    cudaMalloc((void**)&DNTTb, sizeof(uint64_t)*N);
    cudaMalloc((void**)&DNTTc, sizeof(uint64_t)*N);
    
    
    // 1KNTT
    uint64_t *HKNTT1a, *HKNTT1b, *HKNTT1c, *HKNTT1re;
    uint64_t *DKNTT1a, *DKNTT1b, *DKNTT1ab, *DKNTT1c, *DKNTT1f11;
    // 主机上申请内存
    cudaHostAlloc((void**)&HKNTT1a, sizeof(uint64_t)*N , cudaHostAllocDefault);
    cudaHostAlloc((void**)&HKNTT1b, sizeof(uint64_t)*N , cudaHostAllocDefault);
    cudaHostAlloc((void**)&HKNTT1c, sizeof(uint64_t)*N , cudaHostAllocDefault);
    cudaHostAlloc((void**)&HKNTT1re, sizeof(uint64_t)*N , cudaHostAllocDefault);
    // 申请device内存
    cudaMalloc((void**)&DKNTT1a, sizeof(uint64_t)*N);
    cudaMalloc((void**)&DKNTT1b, sizeof(uint64_t)*N);
    cudaMalloc((void**)&DKNTT1ab, sizeof(uint64_t)*N);
    cudaMalloc((void**)&DKNTT1c, sizeof(uint64_t)*N);
    cudaMalloc((void**)&DKNTT1f11, sizeof(uint64_t)*(N/2));
    
    
    // 2KNTT
    uint64_t *HKNTT2a, *HKNTT2b, *HKNTT2c, *HKNTT2re;
    uint64_t *DKNTT2a, *DKNTT2b, *DKNTT2ab, *DKNTT2c, *DKNTT2f11;
    // 主机上申请内存
    cudaHostAlloc((void**)&HKNTT2a, sizeof(uint64_t)*N , cudaHostAllocDefault);
    cudaHostAlloc((void**)&HKNTT2b, sizeof(uint64_t)*N , cudaHostAllocDefault);
    cudaHostAlloc((void**)&HKNTT2c, sizeof(uint64_t)*N , cudaHostAllocDefault);
    cudaHostAlloc((void**)&HKNTT2re, sizeof(uint64_t)*N , cudaHostAllocDefault);
    // 申请device内存
    cudaMalloc((void**)&DKNTT2a, sizeof(uint64_t)*N);
    cudaMalloc((void**)&DKNTT2b, sizeof(uint64_t)*N);
    cudaMalloc((void**)&DKNTT2ab, sizeof(uint64_t)*N);
    cudaMalloc((void**)&DKNTT2c, sizeof(uint64_t)*N);
    cudaMalloc((void**)&DKNTT2f11, sizeof(uint64_t)*(N/2));
    
    
    // 3KNTT
    uint64_t *HKNTT3a, *HKNTT3b, *HKNTT3c, *HKNTT3re;
    uint64_t *DKNTT3a, *DKNTT3b, *DKNTT3ab, *DKNTT3c;
    // 主机上申请内存
    cudaHostAlloc((void**)&HKNTT3a, sizeof(uint64_t)*N , cudaHostAllocDefault);
    cudaHostAlloc((void**)&HKNTT3b, sizeof(uint64_t)*N , cudaHostAllocDefault);
    cudaHostAlloc((void**)&HKNTT3c, sizeof(uint64_t)*N , cudaHostAllocDefault);
    cudaHostAlloc((void**)&HKNTT3re, sizeof(uint64_t)*N , cudaHostAllocDefault);
    // 申请device内存
    cudaMalloc((void**)&DKNTT3a, sizeof(uint64_t)*N);
    cudaMalloc((void**)&DKNTT3b, sizeof(uint64_t)*N);
    cudaMalloc((void**)&DKNTT3ab, sizeof(uint64_t)*N);
    cudaMalloc((void**)&DKNTT3c, sizeof(uint64_t)*N);
    
        for (int k = 0; k < K; k++) {
        srand((unsigned int)time(NULL));
        // 源 和 NTT 赋值
        for (int i = 0; i < N; i++)
        {
            Oa[i] = rand() % Q;
            Ob[i] = rand() % Q;
            HNTTa[i] = Oa[i]; 
            HNTTb[i] = Ob[i]; 
        }
        // 拷贝数据
        cudaMemcpy(DNTTa, HNTTa, sizeof(uint64_t)*N, cudaMemcpyHostToDevice);
        cudaMemcpy(DNTTb, HNTTb, sizeof(uint64_t)*N, cudaMemcpyHostToDevice);  


                // 正确性测试 原始乘法
                Hpol_naivemul(Oc, Oa, Ob);
                //for (int i = 0; i < N; i++)
                        //printf("%d ",Oc[i]);
                //printf("\n\n");
        
        
        // NTT
        cudaDeviceSynchronize();
        start = clock();
                Dpoly_ntt<<<1, N/2, N*sizeof(uint64_t)>>>(DNTTa, N);
        Dpoly_ntt<<<1, N/2, N*sizeof(uint64_t)>>>(DNTTb, N);
        Dpoly_pointwise<<<1, N/2>>>(DNTTa, DNTTb, DNTTc, N, 1);
        Dpoly_invntt<<<1, N/2, N*sizeof(uint64_t)>>>(DNTTc, N, INV_N0);
        cudaDeviceSynchronize();
                finish = clock();
                NTTt = NTTt + (double)(finish - start) / CLOCKS_PER_SEC;
        // 拷贝数据
        cudaMemcpy(HNTTc, DNTTc, sizeof(uint64_t)*N, cudaMemcpyDeviceToHost);
        //for (int i = 0; i < N; i++)
                        //printf("%d ",HNTTc[i]);
                //printf("\n\n");
        
        
        // 1KNTT 赋值 先基数坐标 后基偶数坐标
        for (int i = 0; i < N/2; i++)
        {
            HKNTT1a[i + N / 2] = Oa[2 * i];
            HKNTT1a[i] = Oa[2 * i + 1];
            HKNTT1b[i + N / 2] = Ob[2 * i];
            HKNTT1b[i] = Ob[2 * i + 1];
        }
        // 拷贝数据
        cudaMemcpy(DKNTT1a, HKNTT1a, sizeof(uint64_t)*N, cudaMemcpyHostToDevice);
        cudaMemcpy(DKNTT1b, HKNTT1b, sizeof(uint64_t)*N, cudaMemcpyHostToDevice);
        cudaMemcpy(DKNTT1f11, KNTT1y, sizeof(uint64_t)*(N/2), cudaMemcpyHostToDevice);
        cudaDeviceSynchronize();
        start = clock();
        Hpoly_1Iptntt_kara(DKNTT1a, DKNTT1b, DKNTT1ab, DKNTT1c, DKNTT1f11, N/2, INV_N1);
        cudaDeviceSynchronize();
                finish = clock();
        KNTT1t = KNTT1t + (double)(finish - start) / CLOCKS_PER_SEC;
        // 拷贝数据
        cudaMemcpy(HKNTT1c, DKNTT1c, sizeof(uint64_t)*N, cudaMemcpyDeviceToHost);
        for (int i = 0; i < N/2; i++){
            // 先基数坐标 后基偶数坐标
            HKNTT1re[2 * i] = HKNTT1c[i + N / 2];
            HKNTT1re[2 * i + 1] = HKNTT1c[i];
        }
        //for (int i = 0; i < N; i++)
                        //printf("%d ",HKNTT1re[i]);
               // printf("\n\n");
        
        
        
        // 2KNTT
        // 2KNTT 赋值 按f3 f2 f1 f0排序
        for (int i = 0; i < N / 4; i++)
        {
            HKNTT2a[i + (3 * N) / 4] = Oa[4 * i];
            HKNTT2a[i + N / 2] = Oa[4 * i + 1];
            HKNTT2a[i + N / 4] = Oa[4 * i + 2];
            HKNTT2a[i] = Oa[4 * i + 3];
            HKNTT2b[i + (3 * N) / 4] = Ob[4 * i];
            HKNTT2b[i + N / 2] = Ob[4 * i + 1];
            HKNTT2b[i + N / 4] = Ob[4 * i + 2];
            HKNTT2b[i] = Ob[4 * i + 3];
        }
        // 拷贝数据
        cudaMemcpy(DKNTT2a, HKNTT2a, sizeof(uint64_t)*N, cudaMemcpyHostToDevice);
        cudaMemcpy(DKNTT2b, HKNTT2b, sizeof(uint64_t)*N, cudaMemcpyHostToDevice);
        cudaMemcpy(DKNTT2f11, KNTT2y, sizeof(uint64_t)*(N/2), cudaMemcpyHostToDevice);
        cudaDeviceSynchronize();
        start = clock();
        Hpoly_2Iptntt_kara(DKNTT2a, DKNTT2b, DKNTT2ab, DKNTT2c, DKNTT2f11, N / 4, INV_N2);
        cudaDeviceSynchronize();
                finish = clock();
        KNTT2t = KNTT2t + (double)(finish - start) / CLOCKS_PER_SEC;
        // 拷贝数据
        cudaMemcpy(HKNTT2c, DKNTT2c, sizeof(uint64_t) * N, cudaMemcpyDeviceToHost);
        for (int i = 0; i < N/4; i++){
            HKNTT2re[4 * i] = HKNTT2c[i + (3 * N) / 4];
            HKNTT2re[4 * i + 1] = HKNTT2c[i + N / 2];
            HKNTT2re[4 * i + 2] = HKNTT2c[i + N / 4];
            HKNTT2re[4 * i + 3] = HKNTT2c[i];
        }
        //for (int i = 0; i < N; i++)
                        //printf("%d ",HKNTT2re[i]);
                //printf("\n\n");
        
        
        
        // 3KNTT
        // 3KNTT 赋值 按f7 f6 f5 f4 f3 f2 f1 f0排序
        for (int i = 0; i < N / 8; i++)
        {
            HKNTT3a[i + (7 * N) / 8] = Oa[8 * i];
            HKNTT3a[i + (3 * N) / 4] = Oa[8 * i + 1];
            HKNTT3a[i + (5 * N) / 8] = Oa[8 * i + 2];
            HKNTT3a[i + N / 2] = Oa[8 * i + 3];
            HKNTT3a[i + (3 * N) / 8] = Oa[8 * i + 4];
            HKNTT3a[i + N / 4] = Oa[8 * i + 5];
            HKNTT3a[i + N / 8] = Oa[8 * i + 6];
            HKNTT3a[i] = Oa[8 * i + 7];
            
            HKNTT3b[i + (7 * N) / 8] = Ob[8 * i];
            HKNTT3b[i + (3 * N) / 4] = Ob[8 * i + 1];
            HKNTT3b[i + (5 * N) / 8] = Ob[8 * i + 2];
            HKNTT3b[i + N / 2] = Ob[8 * i + 3];
            HKNTT3b[i + (3 * N) / 8] = Ob[8 * i + 4];
            HKNTT3b[i + N / 4] = Ob[8 * i + 5];
            HKNTT3b[i + N / 8] = Ob[8 * i + 6];
            HKNTT3b[i] = Ob[8 * i + 7];
        }
        // 拷贝数据
        cudaMemcpy(DKNTT3a, HKNTT3a, sizeof(uint64_t)*N, cudaMemcpyHostToDevice);
        cudaMemcpy(DKNTT3b, HKNTT3b, sizeof(uint64_t)*N, cudaMemcpyHostToDevice);
        cudaDeviceSynchronize();
        start = clock();
        
        
        Hpoly_3Iptntt_kara(DKNTT3a, DKNTT3b, DKNTT3ab, DKNTT3c, N / 8, INV_N3);
        cudaDeviceSynchronize();
                finish = clock();
        KNTT3t = KNTT3t + (double)(finish - start) / CLOCKS_PER_SEC;
        // 拷贝数据
        cudaMemcpy(HKNTT3c, DKNTT3c, sizeof(uint64_t) * N, cudaMemcpyDeviceToHost);
        for (int i = 0; i < N/8; i++){
            HKNTT3re[8 * i] = HKNTT3c[i + (7 * N) / 8];
            HKNTT3re[8 * i + 1] = HKNTT3c[i + (3 * N) / 4];
            HKNTT3re[8 * i + 2] = HKNTT3c[i + (5 * N) / 8];
            HKNTT3re[8 * i + 3] = HKNTT3c[i + N / 2];
            HKNTT3re[8 * i + 4] = HKNTT3c[i + (3 * N) / 8];
            HKNTT3re[8 * i + 5] = HKNTT3c[i + N / 4];
            HKNTT3re[8 * i + 6] = HKNTT3c[i + N / 8];
            HKNTT3re[8 * i + 7] = HKNTT3c[i];
        }
        //for (int i = 0; i < N; i++)
                        //printf("%d ",HKNTT3re[i]);
                //printf("\n\n");
        printf(" %d\n", k);
        }
        printf("ntt time:%f ms\n", (NTTt * 1000 / K));
    printf("1KNTT time:%f ms\n", (KNTT1t * 1000 / K));
    printf("2KNTT time:%f ms\n", (KNTT2t * 1000 / K));
    printf("3KNTT time:%f ms\n", (KNTT3t * 1000 / K));
        return 0;
}